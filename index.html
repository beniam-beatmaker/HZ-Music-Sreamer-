<!DOCTYPE html>
<html lang="en">
<head>
<title>HZ Music Streamer - Ethical Artist-First Streaming</title>
<meta name="description" content="Listen to all Bangers here! HZ Music Streamer is a globally inclusive, artist-first platform offering fair pricing and ethical streaming. Visit hz-streams.com to learn more">
<meta name="keywords" content="HZ Music Streamer, hz-streams, ethical streaming, artist-first platform, global music">
  <!-- EmailJS SDK for sending emails from frontend -->
  <script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script type="text/javascript">
    (function(){
      emailjs.init('PXA4_rTjGjzYdHrtv'); // TODO: Replace with your EmailJS user ID
    })();
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HZ Music Streamer</title>
<link rel="icon" sizes="48x48" href="HZ.png" type="image/png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="48x48"  href="/android-icon-48x48.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

  <style>
  .card-display { background: linear-gradient(135deg, #232526 0%, #414345 100%); border-radius: 16px; box-shadow: 0 4px 24px rgba(0,0,0,0.18); padding: 22px 28px 18px 28px; margin: 0 auto 18px auto; min-width: 270px; max-width: 340px; color: #fff; font-family: 'Segoe UI', Arial, sans-serif; position: relative; display: flex; flex-direction: column; align-items: flex-start; gap: 10px; border: 1.5px solid #333; }
  .card-chip { width: 38px; height: 24px; background: linear-gradient(90deg, #e0e0e0 0%, #bdbdbd 100%); border-radius: 6px; margin-bottom: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.12); }
  .card-number { font-size: 1.25rem; letter-spacing: 2.5px; font-family: 'Roboto Mono', 'Courier New', monospace; margin-bottom: 6px; font-weight: 700; color: #fff; text-shadow: 0 1px 4px rgba(0,0,0,0.18); }
  .card-details-row { display: flex; align-items: center; gap: 12px; width: 100%; }
  .card-label { font-size: 0.85rem; color: #bdbdbd; font-weight: 600; margin-right: 6px; }
  .card-expiry { font-size: 1.05rem; font-family: 'Roboto Mono', 'Courier New', monospace; color: #fff; font-weight: 700; letter-spacing: 1.5px; }
  :root {
  /* Default (Dark) theme */
    --bg-main: #000;
    --bg-secondary: #181818;
    --bg-tertiary: #222;
    --text-primary: #fff;
    --accent-color: #ffb700;
  }
  [data-theme="light"] {
    --bg-main: #fff;
    --bg-secondary: #f3f3f3;
    --bg-tertiary: #eaeaea;
    --text-primary: #181818;
    --accent-color: #1db954;
  }
  [data-theme="green"] {
    --bg-main: #0d5c2a;
    --bg-secondary: #116b33;
    --bg-tertiary: #1a7a3d;
    --text-primary: #ffffff;
    --accent-color: #1db954;
  }
  [data-theme="ocean-blue"] {
    --bg-main: #0a2d4f;
    --bg-secondary: #1a4d66;
    --bg-tertiary: #051829;
    --text-primary: #ffffff;
    --accent-color: #3ec6ff;
  }
  [data-theme="purple-vibes"] {
    --bg-main: #2d1157;
    --bg-secondary: #4a1c73;
    --bg-tertiary: #1a0d33;
    --text-primary: #ffffff;
    --accent-color: #e040fb;
  }
  /* Add more custom themes as needed */
    /* Spotify-Authentic Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      font-size: 16px;
      overflow-x: hidden;
    }

  body {
    font-family: 'Spotify Circular', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    background: var(--bg-main);
    color: var(--text-primary);
    min-height: 100vh;
    overflow-x: hidden;
    line-height: 1.6;
    margin: 0;
    padding: 0;
  }

  .container {
    display: flex;
    min-height: 100vh;
    position: relative;
    background: var(--bg-main);
    overflow-x: hidden;
  }

    /* Spotify Main Content Layout */
  .main-content {
    flex: 1;
    padding: 0;
    background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-tertiary) 15%, var(--bg-main) 100%);
    min-height: 100vh;
    overflow-y: auto;
    border-radius: 0;
    margin: 0;
  }

    /* Spotify Header */
    .page-header {
      padding: 16px 32px 24px 32px;
      position: sticky;
      top: 0;
      background: linear-gradient(180deg, rgba(26, 26, 26, 0.8) 0%, rgba(18, 18, 18, 0.6) 50%, transparent 100%);
      backdrop-filter: blur(16px);
      z-index: 50;
      border-bottom: none;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      max-width: none;
      margin: 0;
      padding-bottom: 0;
    }

    .greeting-section {
      flex: 1;
    }

    .greeting-text {
      font-size: 2rem;
      font-weight: 900;
      margin: 0;
      color: #ffffff;
      letter-spacing: -0.04em;
      line-height: 1.2;
    }

    .time-based-message {
      font-size: 0.875rem;
      color: #a7a7a7;
      margin-top: 4px;
      font-weight: 400;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .upgrade-btn {
      background: transparent;
      color: #ffffff;
      border: 1px solid rgba(255, 255, 255, 0.3);
      padding: 4px 16px;
      border-radius: 500px;
      font-weight: 700;
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.1s ease;
      display: flex;
      align-items: center;
      gap: 4px;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      height: 32px;
    }

    .upgrade-btn:hover {
      transform: scale(1.04);
      border-color: #ffffff;
      background: rgba(255, 255, 255, 0.1);
    }

    .premium-icon {
      font-size: 0.875rem;
    }

    /* Spotify Content Sections */
    .content-section {
      margin-bottom: 40px;
      padding: 0 32px;
      max-width: none;
      margin-left: 0;
      margin-right: 0;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

  .section-title {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
    letter-spacing: -0.04em;
    line-height: 1.3;
  }

    .show-all-link {
      color: #a7a7a7;
      text-decoration: none;
      font-size: 0.75rem;
      font-weight: 700;
      transition: color 0.1s ease;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .show-all-link:hover {
      color: #ffffff;
      text-decoration: underline;
    }

    .content-row {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 24px;
      overflow-x: auto;
      padding-bottom: 8px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .content-row::-webkit-scrollbar {
      display: none;
    }

    /* Spotify Content Cards */
    .content-card {
      background: #181818;
      border-radius: 8px;
      padding: 16px;
      transition: all 0.3s cubic-bezier(0.3, 0, 0, 1);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      border: none;
      box-shadow: none;
    }

    .content-card:hover {
      background: #282828;
      transform: translateY(0);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
    }

    .card-image, .card-cover {
      width: 100%;
      aspect-ratio: 1;
      border-radius: 4px;
      object-fit: cover;
      margin-bottom: 16px;
      background: linear-gradient(135deg, #333333, #1a1a1a);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
      transition: box-shadow 0.3s ease;
    }

    .content-card:hover .card-image,
    .content-card:hover .card-cover {
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.7);
    }

    .card-title, .card-title-text {
      font-weight: 700;
      font-size: 1rem;
      color: #ffffff;
      margin-bottom: 4px;
      line-height: 1.3;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 1;
      line-clamp: 1;
      -webkit-box-orient: vertical;
      letter-spacing: -0.04em;
    }

    .card-subtitle, .card-description {
      font-size: 0.875rem;
      color: #a7a7a7;
      line-height: 1.3;
      overflow: hidden;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      font-weight: 400;
    }

    /* Artist Cards - Circular */
    .artist-card .card-cover,
    .artist-card .card-image {
      border-radius: 50%;
    }

    /* Content Cards Container - Horizontal Layout */
    .content-cards {
      display: flex;
      gap: 16px;
      overflow-x: auto;
      padding-bottom: 8px;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .content-cards::-webkit-scrollbar {
      display: none;
    }

    /* Small Content Cards */
    .content-card-small {
      padding: 12px;
      width: 140px;
      flex-shrink: 0;
    }

    .card-image-small {
      width: 100%;
      height: 100px;
      margin-bottom: 8px;
    }

    .card-title-small {
      font-size: 0.85rem;
      font-weight: 600;
      margin-bottom: 2px;
      line-height: 1.2;
    }

    .card-description-small {
      font-size: 0.7rem;
      line-height: 1.2;
      -webkit-line-clamp: 2;
      line-clamp: 2;
    }

    /* Spotify Play Button */
    .play-button, .play-overlay {
      position: absolute;
      bottom: 16px;
      right: 16px;
      width: 48px;
      height: 48px;
      background: #1db954;
      border: none;
      border-radius: 50%;
      color: #000000;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transform: translateY(8px);
      transition: all 0.3s cubic-bezier(0.3, 0, 0, 1);
      box-shadow: 0 8px 8px rgba(0, 0, 0, 0.3);
      z-index: 10;
    }

    .content-card:hover .play-button,
    .content-card:hover .play-overlay {
      opacity: 1;
      transform: translateY(0);
    }

    .play-button:hover,
    .play-overlay:hover {
      transform: scale(1.05);
      background: #1ed760;
    }

    /* Streaming Platform Track Display */
    .track-list-container {
      background: transparent;
      border-radius: 8px;
      margin: 32px 0;
      padding: 0 32px;
    }

    .track-list-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .track-list-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #ffffff;
      margin: 0;
      letter-spacing: -0.04em;
    }

    .track-list-controls {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .play-all-btn {
      background: #1db954;
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      color: #000000;
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.1s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .play-all-btn:hover {
      transform: scale(1.05);
      background: #1ed760;
    }

    .track-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }

    .track-table-header {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      height: 36px;
    }

    .track-table-header th {
      text-align: left;
      font-size: 0.75rem;
      font-weight: 400;
      color: #a7a7a7;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      padding: 0 16px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .track-table-header th:first-child {
      width: 40px;
      padding-left: 0;
      display: none;
    }

    .track-table-header th:nth-child(2) {
      width: 50%;
    }

    .track-table-header th:nth-child(3) {
      width: 25%;
    }

    .track-table-header th:nth-child(4) {
      width: 15%;
      display: none;
    }

    .track-table-header th:last-child {
      width: 60px;
      padding-right: 0;
    }

    .track-row {
      height: 56px;
      border-radius: 4px;
      transition: all 0.1s ease;
      cursor: pointer;
    }

    .track-row:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .track-row td {
      padding: 8px 16px;
      border: none;
      vertical-align: middle;
    }

    .track-row td:first-child {
      padding-left: 0;
      width: 40px;
    }

    .track-row td:last-child {
      padding-right: 0;
      width: 60px;
    }

    .track-number {
      font-size: 1rem;
      color: #a7a7a7;
      font-weight: 400;
      text-align: center;
      width: 40px;
      display: none;
    }

    .track-row:hover .track-number {
      opacity: 0;
    }

    .track-row:hover .track-play-btn {
      opacity: 1;
    }

    /* Hide first column (track numbers) and fourth column (date added) in all rows */
    .track-row td:first-child {
      display: none;
    }

    .track-row td:nth-child(4) {
      display: none;
    }

    .track-play-btn {
      background: transparent;
      border: none;
      color: #ffffff;
      font-size: 1rem;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.1s ease;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .track-info {
      display: flex;
      align-items: center;
      gap: 12px;
      min-width: 0;
    }

    .track-artwork {
      width: 40px;
      height: 40px;
      border-radius: 4px;
      object-fit: cover;
      background: linear-gradient(135deg, #333333, #1a1a1a);
    }

    .track-details {
      min-width: 0;
      flex: 1;
    }

    .track-name {
      font-size: 1rem;
      font-weight: 400;
      color: #ffffff;
      margin-bottom: 2px;
      line-height: 1.3;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .track-artist {
      font-size: 0.875rem;
      color: #a7a7a7;
      line-height: 1.3;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .track-album {
      font-size: 0.875rem;
      color: #a7a7a7;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .track-album:hover {
      color: #ffffff;
      text-decoration: underline;
    }

    .track-duration {
      font-size: 0.875rem;
      color: #a7a7a7;
      font-weight: 400;
      text-align: right;
    }

    .track-actions {
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.1s ease;
    }

    .track-row:hover .track-actions {
      opacity: 1;
    }

    .track-like-btn, .track-menu-btn {
      background: transparent;
      border: none;
      color: #a7a7a7;
      font-size: 1rem;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: all 0.1s ease;
    }

    .track-like-btn:hover, .track-menu-btn:hover {
      color: #ffffff;
      background: rgba(255, 255, 255, 0.1);
    }

    .track-like-btn.liked {
      color: #1db954;
    }

    /* Social Media Share Dropdown Styles */
    .social-share-dropdown {
      position: absolute;
      top: -120px;
      left: 0;
      background: #1a1a1a;
      border: 1px solid #3e3e3e;
      border-radius: 8px;
      padding: 10px;
      z-index: 10001;
      min-width: 180px;
      max-width: 200px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
      display: none;
    }

    .social-share-dropdown.show {
      display: block;
    }

    .social-share-title {
      color: #fff;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 12px;
      text-align: center;
    }

    .social-share-icons {
      display: flex;
      gap: 8px;
      justify-content: center;
      align-items: center;
    }

    .social-icon {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 14px;
      color: white;
    }

    .social-icon.facebook {
      background: #1877F2;
    }

    .social-icon.instagram {
      background: linear-gradient(45deg, #F58529, #DD2A7B, #8134AF, #515BD4);
    }

    .social-icon.twitter {
      background: #000000;
    }

    .social-icon.whatsapp {
      background: #25D366;
    }

    .social-icon:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
    }

    /* Recently Played Tracks Section */
    .recently-played-tracks {
      margin: 32px 0;
      padding: 0 32px;
    }

    .recently-played-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .recently-played-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .recent-track-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 12px;
      border-radius: 4px;
      transition: all 0.1s ease;
      cursor: pointer;
    }

    .recent-track-item:hover {
      background: rgba(255, 255, 255, 0.1);
    }

    .recent-track-artwork {
  width: 40px;
  height: 40px;
      border-radius: 4px;
      object-fit: cover;
      background: linear-gradient(135deg, #333333, #1a1a1a);
    }

    .recent-track-info {
      flex: 1;
      min-width: 0;
    }

    .recent-track-name {
      font-size: 0.875rem;
      font-weight: 400;
      color: #ffffff;
      margin-bottom: 2px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .recent-track-artist {
      font-size: 0.75rem;
      color: #a7a7a7;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .recent-track-time {
      font-size: 0.75rem;
      color: #a7a7a7;
      white-space: nowrap;
    }

    /* Spotify Quick Access Cards */
    .quick-access-card:hover {
      transform: scale(1.02);
      filter: brightness(1.1);
    }

    /* Navigation Buttons - Hide main nav since we use hamburger */
    .nav-buttons {
      display: none;
    }

    .nav-btn {
      background: linear-gradient(45deg, #0066ff, #4d94ff);
      color: #fff;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 25px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 102, 255, 0.3);
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 102, 255, 0.4);
    }

    .nav-btn.active {
      background: linear-gradient(45deg, #003366, #0066ff);
      box-shadow: 0 4px 15px rgba(0, 102, 255, 0.3);
    }

    .nav-btn.active:hover {
      box-shadow: 0 6px 20px rgba(0, 102, 255, 0.4);
    }

    h1 {
      text-align: center;
      margin-bottom: 2rem;
      color: var(--accent-color);
      font-size: 2.5rem;
      text-shadow: 0 0 20px rgba(29, 185, 84, 0.5);
      transition: color 0.3s ease;
    }

    /* Track Lists */
    .track-list {
      background: var(--bg-tertiary);
      border-radius: 15px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border: 1px solid var(--border-color);
      transition: background-color 0.3s ease, border-color 0.3s ease;
    }

    .section-title {
      color: var(--accent-color);
      font-size: 1.2rem;
      margin-bottom: 1rem;
      font-weight: 600;
      transition: color 0.3s ease;
    }

    .welcome {
      font-size: 2.2rem;
      font-weight: 700;
      margin-bottom: 1.2rem;
      color: var(--text-primary);
      text-align: center;
      transition: color 0.3s ease;
    }

    .desc {
      color: var(--text-secondary);
      font-size: 1.1rem;
      margin-bottom: 2rem;
      text-align: center;
      transition: color 0.3s ease;
    }

    .action-buttons {
      display: flex;
      gap: 1.5rem;
      margin-bottom: 2rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .action-buttons a, .action-buttons button {
      background: linear-gradient(45deg, #0066ff, #4d94ff);
      color: #fff;
      border: none;
      padding: 0.8rem 2.2rem;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1.1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(0, 102, 255, 0.3);
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }

    .action-buttons a:hover, .action-buttons button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 102, 255, 0.4);
    }

    .action-buttons a.secondary {
      background: transparent;
      color: #FFD700;
      border: 2px solid #FFD700;
    }

    .action-buttons a.secondary:hover {
      background: #FFD700;
      color: #000;
    }

    /* Search Box */
    .search-container {
      position: relative;
      margin-bottom: 2rem;
    }

        .search-box {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 25px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
            border: 1px solid var(--border-color);
        }

        .search-box:focus {
            background: var(--bg-quaternary);
            border-color: var(--accent-color);
            transform: scale(1.02);
        }

        .search-box::placeholder {
            color: var(--text-secondary);
        }

        /* Legacy compatibility styles */
        aside {
            width: 220px;
            background: linear-gradient(135deg, #ffb700 0%, #ff6a00 100%);
            color: #181818;
            box-shadow: 0 4px 24px rgba(255,186,0,0.10);
            padding: 2rem 1rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            border-right: 1px solid #333;
        }

        aside h2 {
            font-size: 1.1rem;
            color: #1db954;
            margin-bottom: 1rem;
            letter-spacing: 1px;
        }

        aside ul {
            list-style: none;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        aside ul li a {
            color: #b3b3b3;
            text-decoration: none;
            font-size: 1rem;
            transition: color 0.2s;
        }

        aside ul li a:hover {
            color: #1db954;
        }

        .upload-btn {
            background: linear-gradient(45deg, #0066ff, #4d94ff);
            color: #181818;
            font-weight: 900;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 102, 255, 0.3);
            margin: 0.25rem;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 102, 255, 0.4);
        }

        /* Track Items */
        .track-item {
            background: #181818;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border: 1px solid #333;
            transition: all 0.3s ease;
        }

        .track-item:hover {
            background: #282828;
            border-color: #1db954;
            transform: translateY(-2px);
        }

        .track-info {
            flex: 1;
        }

        .track-title {
            font-weight: 600;
            color: #fff;
            font-size: 0.95rem;
            margin-bottom: 0.2rem;
        }

        .track-artist {
            font-size: 0.85rem;
            color: #b3b3b3;
        }

        .play-btn {
            background: linear-gradient(45deg, #1db954, #1ed760);
            color: #fff;
            border: none;
            padding: 0.6rem 1.2rem;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(29, 185, 84, 0.3);
            min-width: 80px;
        }

        .play-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(29, 185, 84, 0.5);
        }

        /* Storage indicator styling */
        #storageIndicator {
            background: #2a2a2a;
            color: #1db954;
            border: 1px solid #404040;
            padding: 0.5rem 1rem;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        #storageIndicator:hover {
            background: #1db954;
            color: #fff;
            transform: scale(1.05);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            aside {
                display: none;
            }

            .main-content {
                padding: 1rem;
                padding-bottom: 120px; /* Extra space for bottom nav */
            }

            .nav-buttons {
                gap: 0.5rem;
                margin: 1.5rem 0;
            }

            .nav-btn {
                padding: 0.6rem 1rem;
                font-size: 0.8rem;
            }

            .action-buttons {
                flex-direction: column;
                gap: 1rem;
            }

            .bottom-nav {
                padding: 0.3rem 0.5rem 0.5rem 0.5rem;
            }

            .bottom-nav-item {
                min-width: 45px;
                padding: 0.1rem;
            }

            .bottom-nav-icon {
                font-size: 1.2rem;
            }

            .bottom-nav-label {
                font-size: 0.6rem;
            }

            .search-popup {
                width: 95%;
                padding: 1.5rem;
                margin: 1rem;
            }

            .page-content {
                padding: 1rem;
                padding-bottom: 120px;
            }

            .page-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .page-title {
                font-size: 1.5rem;
            }

        /* Ensure main content has bottom padding for the bottom nav */
        .main-content {
            padding-bottom: 100px;
        }

        /* Hide sticky player on very small screens when bottom nav is visible */
        @media (max-width: 480px) {
            .sticky-player {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 80px;
            z-index: 2000;
            background: linear-gradient(90deg, #232526 0%, #414345 100%);
            box-shadow: 0 0 32px 0 rgba(0,0,0,0.18), 0 2px 8px rgba(0,0,0,0.10);
            border-radius: 18px 18px 0 0;
            padding: 10px 10px 8px 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: box-shadow 0.2s, background 0.2s;
            font-family: 'Segoe UI', Arial, sans-serif;
            color: #fff;
            min-width: 220px;
            max-width: 100vw;
            margin: 0 auto;
            border: 2px solid #0a174e;
            animation: stickyPlayerFadeIn 0.4s;
        }

        @keyframes stickyPlayerFadeIn {
          from { opacity: 0; transform: translateY(40px); }
          to { opacity: 1; transform: translateY(0); }
        }

        .sticky-player .player-controls {
          display: flex;
          align-items: center;
          gap: 0.7rem;
          background: rgba(34,34,34,0.85);
          border-radius: 12px;
          padding: 4px 8px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.10);
        }

        .sticky-player .player-btn {
          background: linear-gradient(135deg, #FFD700 0%, #B8860B 100%);
          color: #FFD700;
          border: none;
          border-radius: 50%;
          width: 24px;
          height: 24px;
          font-size: 0.9rem;
          cursor: pointer;
          box-shadow: 0 2px 8px rgba(0,230,255,0.18);
          margin: 0 1px;
          transition: background 0.2s, transform 0.2s;
        }

        .sticky-player .player-btn:hover {
          background: linear-gradient(135deg, #FFD700 0%, #B8860B 100%);
          transform: scale(1.08);
        }

        .sticky-player .player-title {
          font-weight: 700;
          font-size: 1.1rem;
          margin: 0 8px;
          color: #FFD700;
          text-shadow: 0 1px 4px rgba(0,0,0,0.18);
          letter-spacing: 0.04em;
          flex: 1;
          text-align: center;
        }

        .sticky-player #progressBar {
          accent-color: #FFD700;
          height: 4px;
          border-radius: 4px;
          background: #232526;
        }

        .sticky-player #volumeRange {
          accent-color: #FFD700;
          height: 4px;
          border-radius: 4px;
          background: #232526;
        }

        .sticky-player #likeBtn {
          font-size: 1.2rem;
          color: rgba(255,255,255,0.4);
          transition: color 0.2s;
        }
        .sticky-player #likeBtn.liked {
          color: #ffd700 !important;
        }

        @media (max-width: 600px) {
          .sticky-player {
            padding: 6px 2px 4px 2px;
            min-width: 180px;
          }
          .sticky-player .player-btn {
            width: 20px;
            height: 20px;
            font-size: 0.8rem;
          }
          .sticky-player .player-title {
            font-size: 0.95rem;
          }
        }
        }

        @keyframes stickyPlayerFadeIn {
          from { opacity: 0; transform: translateY(40px); }
          to { opacity: 1; transform: translateY(0); }
        }

        .sticky-player .player-controls {
          display: flex;
          align-items: center;
          gap: 1.2rem;
          background: rgba(34,34,34,0.85);
          border-radius: 12px;
          padding: 8px 18px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.10);
        }

        .sticky-player .player-btn {
          background: linear-gradient(135deg, #1db954 0%, #1ed760 100%);
          color: #fff;
          border: none;
          border-radius: 50%;
          width: 38px;
          height: 38px;
          font-size: 1.3rem;
          cursor: pointer;
          box-shadow: 0 2px 8px rgba(29,185,84,0.18);
          margin: 0 2px;
          transition: background 0.2s, transform 0.2s;
        }

        .sticky-player .player-btn:hover {
          background: linear-gradient(135deg, #1ed760 0%, #1db954 100%);
          transform: scale(1.08);
        }

        .sticky-player .player-title {
          font-weight: 700;
          font-size: 1.1rem;
          margin: 0 18px;
          color: #ffb700;
          text-shadow: 0 1px 4px rgba(0,0,0,0.18);
          letter-spacing: 0.04em;
          flex: 1;
          text-align: center;
        }

        .sticky-player #progressBar {
          accent-color: #1db954;
          height: 6px;
          border-radius: 4px;
          background: #232526;
        }

        .sticky-player #volumeRange {
          accent-color: #ffb700;
          height: 6px;
          border-radius: 4px;
          background: #232526;
        }

        .sticky-player #likeBtn {
          font-size: 1.7rem;
          color: rgba(255,255,255,0.4);
          transition: color 0.2s;
        }
        .sticky-player #likeBtn.liked {
          color: #ffd700 !important;
        }

        .track-section {
            margin: 2.5rem 0;
        }

    .track-row-list {
      display: flex;
      overflow-x: auto;
      gap: 1.2rem;
      padding: 1rem 0;
      scrollbar-width: thin;
      scrollbar-color: #1db954 #181818;
    }

    .track-row-list::-webkit-scrollbar {
      height: 8px;
    }

    .track-row-list::-webkit-scrollbar-track {
      background: #181818;
      border-radius: 4px;
    }

    .track-row-list::-webkit-scrollbar-thumb {
      background: #1db954;
      border-radius: 4px;
    }

    .track-row-list::-webkit-scrollbar-thumb:hover {
      background: #17a74a;
    }

    .track-card button:hover {
      transform: scale(1.05);
    }

    .track-card input[type="file"] {
      display: none !important;
    }

    .track-card input[type="text"] {
      background: #181818;
      color: #fff;
      border: 1px solid #1db954;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .track-card input[type="text"]:focus {
      outline: none;
      border-color: #17a74a;
      box-shadow: 0 0 0 2px rgba(29, 185, 84, 0.2);
    }

    /* Track section styling */
    .section-header {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 1.5rem;
      margin-top: 3rem;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
      padding-bottom: 0.5rem;
    }

    .section-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, #1db954, #1ed760);
      border-radius: 2px;
    }

    .track-section {
      margin: 2.5rem 0;
    }

    /* Hamburger Menu Styles */
    .hamburger-menu {
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 2000;
        background: linear-gradient(45deg, #FFD700, #FFA500);
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 4px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
    }

    .hamburger-menu:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
    }

    .hamburger-line {
        width: 20px;
        height: 2px;
        background: #000;
        border-radius: 1px;
        transition: all 0.3s ease;
    }

    .hamburger-menu.active .hamburger-line:nth-child(1) {
        transform: rotate(45deg) translate(5px, 5px);
    }

    .hamburger-menu.active .hamburger-line:nth-child(2) {
        opacity: 0;
    }

    .hamburger-menu.active .hamburger-line:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -6px);
    }

    /* Navigation Dropdown */
  .nav-dropdown {
    position: fixed;
    top: 80px;
    left: 20px;
    z-index: 1900;
    background: linear-gradient(145deg, #1a1a1a 0%, #2a2a2a 100%);
    border-radius: 15px;
    padding: 1rem;
    min-width: 200px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
    border: 2px solid #404040;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-20px);
    transition: all 0.3s ease;
    overflow: hidden;
  }

    .nav-dropdown.show {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

  .nav-dropdown .nav-btn {
    display: block;
    width: 100%;
    box-sizing: border-box;
    margin-bottom: 0.5rem;
    text-align: left;
    padding: 0.8rem 1rem;
    border-radius: 8px;
    background: transparent;
    border: 1px solid transparent;
    transition: all 0.2s ease;
    overflow: hidden;
  }

    .nav-dropdown .nav-btn:last-child {
        margin-bottom: 0;
    }

    .nav-dropdown .nav-btn:hover {
        background: linear-gradient(45deg, #FFD700, #FFA500);
        color: #000;
        transform: translateX(5px);
        border-color: #FFD700;
    }

    .nav-dropdown .nav-btn.active {
        background: linear-gradient(45deg, #0066ff, #4d94ff);
        color: #fff;
        border-color: #0066ff;
    }

    .nav-dropdown .nav-btn.active:hover {
        background: linear-gradient(45deg, #FFD700, #FFA500);
        color: #000;
        border-color: #FFD700;
    }

    /* Hide the main navigation buttons since we're using hamburger menu */
    .nav-buttons {
        display: none;
    }

    /* Spotify-style Bottom Navigation */
    .bottom-nav {
        position: fixed;
        bottom: 22px; /* Positioned directly touching the copyright footer */
        left: 0;
        right: 0;
        background: rgba(18, 18, 18, 0.95);
        backdrop-filter: blur(10px);
        border-top: 1px solid var(--border-color);
        padding: 0.4rem 1rem 0.6rem 1rem;
        z-index: 1500;
        display: flex;
        justify-content: space-around;
        align-items: center;
        border-radius: 0;
    }

    .bottom-nav-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        cursor: pointer;
        padding: 0.2rem;
        border-radius: 0;
        transition: color 0.2s ease;
        background: transparent;
        border: none;
        color: #a7a7a7; /* Spotify/SoundCloud-like neutral gray */
        min-width: 50px;
        font-family: inherit;
    }

    .bottom-nav-item:hover {
        color: #ffffff; /* White on hover like Spotify */
    }

    .bottom-nav-item.active {
        color: #ffffff; /* Active state remains white */
    }

    .bottom-nav-icon {
        font-size: 1.4rem;
        margin-bottom: 0.1rem;
        transition: inherit;
        color: inherit; /* Inherit color from parent for consistency */
        display: flex;
        align-items: center;
        justify-content: center;
        width: 24px;
        height: 24px;
    }

    .bottom-nav-icon svg {
        width: 100%;
        height: 100%;
        fill: currentColor; /* Ensure SVG uses the current text color */
        transition: inherit;
    }

    .bottom-nav-label {
        font-size: 0.65rem;
        font-weight: 400;
        transition: inherit;
    }

    /* Search Popup Overlay - Spotify Style */
    .search-popup-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: #121212;
        z-index: 2000;
        display: none;
        align-items: flex-start;
        justify-content: center;
        backdrop-filter: none;
        padding-top: 0;
    }

    .search-popup {
        background: var(--bg-primary);
        border-radius: 0;
        padding: 0;
        width: 100%;
        max-width: 100%;
        height: 100vh;
        overflow-y: auto;
        border: none;
        box-shadow: none;
        position: relative;
    }

    .search-header {
        position: sticky;
        top: 0;
        background: var(--bg-primary);
        padding: 1rem 1.5rem;
        border-bottom: 1px solid var(--border-color);
        z-index: 10;
        transition: background-color 0.3s ease, border-color 0.3s ease;
    }

    .search-popup h3 {
        color: var(--text-primary);
        margin: 0;
        font-size: 1.5rem;
        font-weight: 700;
        transition: color 0.3s ease;
    }

    .search-popup .search-container {
        margin: 1.5rem 0;
        position: relative;
    }

    .search-popup .search-box {
        width: 100%;
        padding: 0.75rem 3rem 0.75rem 1rem;
        border: none;
        border-radius: 50px;
        background: var(--bg-secondary);
        color: var(--text-primary);
        font-size: 1rem;
        outline: none;
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        border: 2px solid transparent;
    }

    .search-popup .search-box:focus {
        background: var(--bg-tertiary);
        border-color: var(--accent-color);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        transform: none;
    }

    .search-popup .search-box::placeholder {
        color: var(--text-secondary);
        font-weight: 400;
    }

    .search-icon {
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: var(--text-secondary);
        font-size: 1.2rem;
        pointer-events: none;
        transition: color 0.3s ease;
    }

    .search-close-btn {
        position: absolute;
        top: 1rem;
        right: 1.5rem;
        background: none;
        border: none;
        color: var(--text-secondary);
        font-size: 1.8rem;
        cursor: pointer;
        padding: 0.5rem;
        border-radius: 50%;
        transition: all 0.3s ease;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .search-close-btn:hover {
        color: var(--text-primary);
        background: var(--bg-tertiary);
        transform: scale(1.1);
    }

    .search-content {
        padding: 0 1.5rem 2rem 1.5rem;
    }

    /* Search Suggestions Styling */
    .search-suggestions {
        scrollbar-width: thin;
        scrollbar-color: #666 #232526;
    }

    .search-suggestions::-webkit-scrollbar {
        width: 6px;
    }

    .search-suggestions::-webkit-scrollbar-track {
        background: #232526;
        border-radius: 0 0 12px 0;
    }

    .search-suggestions::-webkit-scrollbar-thumb {
        background: #666;
        border-radius: 3px;
    }

    .search-suggestions::-webkit-scrollbar-thumb:hover {
        background: #888;
    }

    .suggestion-item {
        transition: all 0.2s ease;
        border-left: 3px solid transparent;
    }

    .suggestion-item:hover {
        border-left-color: var(--accent-color) !important;
        background: #333 !important;
        transform: translateX(2px) !important;
    }

    .suggestion-item:last-child {
        border-bottom: none;
        border-radius: 0 0 12px 12px;
    }

    .search-categories {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
    }

    .search-category {
        background: var(--bg-secondary);
        border-radius: 12px;
        padding: 1rem;
        text-align: center;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        position: relative;
        overflow: hidden;
    }

    .search-category:hover {
        background: var(--bg-tertiary);
        border-color: var(--accent-color);
        transform: translateY(-2px);
    }

    .search-category-icon {
        font-size: 2rem;
        margin-bottom: 0.5rem;
        display: block;
    }

    .search-category-title {
        color: var(--text-primary);
        font-weight: 600;
        font-size: 0.9rem;
        transition: color 0.3s ease;
    }

    .search-results {
        margin-top: 2rem;
        display: none;
    }

    .search-results.active {
        display: block;
    }

    .search-results-header {
        color: var(--text-primary);
        font-size: 1.3rem;
        font-weight: 700;
        margin-bottom: 1rem;
        transition: color 0.3s ease;
    }

    .search-result-item {
        display: flex;
        align-items: center;
        padding: 0.75rem;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 0.5rem;
    }

    .search-result-item:hover {
        background: var(--bg-secondary);
    }

    .search-result-icon {
        width: 48px;
        height: 48px;
        background: var(--bg-tertiary);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 1rem;
        font-size: 1.2rem;
        color: var(--text-secondary);
        transition: all 0.3s ease;
    }

    .search-result-info {
        flex: 1;
    }

    .search-result-title {
        color: var(--text-primary);
        font-weight: 600;
        font-size: 0.95rem;
        margin-bottom: 0.2rem;
        transition: color 0.3s ease;
    }

    .search-result-subtitle {
        color: var(--text-secondary);
        font-size: 0.85rem;
        transition: color 0.3s ease;
    }

    .search-result-action {
        background: transparent;
        border: 1px solid var(--border-color);
        color: var(--text-secondary);
        padding: 0.5rem 1rem;
        border-radius: 20px;
        cursor: pointer;
        font-size: 0.85rem;
        font-weight: 600;
        transition: all 0.3s ease;
    }

    .search-result-action:hover {
        background: var(--accent-color);
        color: var(--bg-primary);
        border-color: var(--accent-color);
    }

    /* Recent searches */
    .recent-searches {
        margin-bottom: 2rem;
    }

    .recent-searches-header {
        color: var(--text-primary);
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        transition: color 0.3s ease;
    }

    .clear-recent-btn {
        color: var(--text-secondary);
        background: none;
        border: none;
        cursor: pointer;
        font-size: 0.85rem;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        transition: all 0.3s ease;
    }

    .clear-recent-btn:hover {
        color: var(--text-primary);
        background: var(--bg-secondary);
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
        .search-popup {
            padding-top: 0;
        }

        .search-header {
            padding: 1rem;
        }

        .search-content {
            padding: 0 1rem 2rem 1rem;
        }

        .search-categories {
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 0.75rem;
        }

        .search-category {
            padding: 0.75rem;
        }

        .search-close-btn {
            right: 1rem;
            width: 36px;
            height: 36px;
            font-size: 1.5rem;
        }
    }

    /* Page Overlay for liked, account, settings */
    .page-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(18, 18, 18, 0.98);
        z-index: 1800;
        display: none;
        backdrop-filter: blur(10px);
    }

    .page-content {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow-y: auto;
        padding: 2rem;
        padding-bottom: 100px; /* Space for bottom nav */
        background: var(--bg-primary);
        transition: background-color 0.3s ease;
    }

    .page-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 2rem;
        padding-bottom: 1rem;
        border-bottom: 2px solid var(--border-color);
        transition: border-color 0.3s ease;
    }

    .page-title {
        font-size: 2rem;
        font-weight: 700;
        color: var(--accent-color);
        transition: color 0.3s ease;
    }

    .page-close-btn {
        background: transparent;
            color: #333;
        border: 1px solid #a7a7a7;
        padding: 8px 16px;
        border-radius: 500px;
        cursor: pointer;
        font-weight: 700;
        font-size: 0.75rem;
        transition: all 0.1s ease;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        height: 32px;
    }

    .page-close-btn:hover {
        transform: scale(1.04);
        border-color: #ffffff;
        color: #ffffff;
    }

    /* Copyright Footer */
    .copyright-footer {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  width: 100%;
  background: rgba(18, 18, 18, 0.97);
  color: var(--text-secondary);
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  padding: 0.22rem 0.8rem 0.18rem 0.8rem;
  font-size: clamp(0.65rem, 1.5vw, 0.82rem);
  line-height: 1.2;
  z-index: 500;
  backdrop-filter: blur(10px);
  transition: background-color 0.3s ease, color 0.3s ease;
  pointer-events: auto;
  user-select: none;
  box-shadow: 0 -2px 12px rgba(0,0,0,0.12);
  gap: 0.7rem;
  flex-wrap: wrap;
    }

    .copyright-footer:hover {
        background: rgba(18, 18, 18, 0.98);
        color: var(--text-primary);
        pointer-events: auto; /* Re-enable interaction on hover if needed */
    }

    /* Adjust main content to account for copyright footer */
    .main-content {
        padding-bottom: 140px; /* Increased for bottom nav + copyright */
        max-height: calc(100vh - 40px); /* Allow scrolling with some top margin */
        overflow-y: auto; /* Enable vertical scrolling */
    }

    .page-content {
        padding-bottom: 140px; /* Increased for bottom nav + copyright */
    }

    /* Hide copyright on very small screens to avoid overlap */
    @media (max-width: 480px) {
    .copyright-footer {
      font-size: 0.66rem;
      padding: 0.22rem 0.2rem 0.18rem 0.2rem;
      flex-direction: row;
      gap: 0.4rem;
    }
    .copyright-footer span {
      text-align: center;
    }
    .main-content {
      padding-bottom: 100px;
    }
    .page-content {
      padding-bottom: 120px;
    }
    }

    /* Terms and Conditions Modal Styles */
    .terms-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.95);
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(8px);
    }

    .terms-modal {
      background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
      border-radius: 16px;
      max-width: 90vw;
      max-height: 90vh;
      width: 800px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      border: 1px solid #333;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .terms-header {
      background: linear-gradient(135deg, #FFD700 0%, #B8860B 100%);
      color: #000;
      padding: 20px 30px;
      font-size: 1.5rem;
      font-weight: 700;
      text-align: center;
      border-bottom: 2px solid #333;
    }

    .terms-content {
      flex: 1;
      overflow-y: auto;
      padding: 30px;
      color: #fff;
      line-height: 1.6;
      font-size: 0.95rem;
    }

    .terms-content::-webkit-scrollbar {
      width: 8px;
    }

    .terms-content::-webkit-scrollbar-track {
      background: #2d2d2d;
      border-radius: 4px;
    }

    .terms-content::-webkit-scrollbar-thumb {
      background: #FFD700;
      border-radius: 4px;
    }

    .terms-content h3 {
      color: #FFD700;
      font-size: 1.2rem;
      margin: 25px 0 15px 0;
      font-weight: 600;
    }

    .terms-content p {
      margin-bottom: 15px;
      text-align: justify;
    }

    .terms-content strong {
      color: #FFD700;
      font-weight: 600;
    }

    .terms-footer {
      background: #2d2d2d;
      padding: 25px 30px;
      border-top: 1px solid #333;
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .terms-agreement {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      padding: 15px;
      background: rgba(255, 215, 0, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(255, 215, 0, 0.3);
    }

    .terms-checkbox {
      width: 20px;
      height: 20px;
      min-width: 20px;
      margin-top: 2px;
      accent-color: #FFD700;
      cursor: pointer;
    }

    .terms-agreement-text {
      color: #fff;
      font-size: 0.95rem;
      line-height: 1.5;
      cursor: pointer;
      user-select: none;
    }

    .terms-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .terms-btn {
      padding: 12px 30px;
      border: none;
      border-radius: 25px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      min-width: 140px;
    }

    .terms-btn.accept {
      background: linear-gradient(135deg, #FFD700 0%, #B8860B 100%);
      color: #000;
    }

    .terms-btn.accept:hover:not(:disabled) {
      background: linear-gradient(135deg, #FFA500 0%, #FF8C00 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
    }

    .terms-btn.accept:disabled {
      background: #666;
      color: #999;
      cursor: not-allowed;
      opacity: 0.5;
    }

    .terms-btn.decline {
      background: transparent;
      color: #fff;
      border: 2px solid #666;
    }

    .terms-btn.decline:hover {
      background: #ff4444;
      border-color: #ff4444;
      transform: translateY(-2px);
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .terms-modal {
        max-width: 95vw;
        max-height: 95vh;
      }

      .terms-header {
        padding: 15px 20px;
        font-size: 1.3rem;
      }

      .terms-content {
        padding: 20px;
        font-size: 0.9rem;
      }

      .terms-footer {
        padding: 20px;
      }

      .terms-buttons {
        flex-direction: column;
      }

      .terms-btn {
        width: 100%;
      }
    }

    /* App blocking overlay when terms not accepted */
    .app-blocked {
      pointer-events: none;
      filter: blur(3px);
      opacity: 0.3;
    }
  </style>
</head>
<body>

  <!-- Terms and Conditions Modal for Users Without Accounts -->
  <div id="termsOverlay" class="terms-overlay" style="display: flex;">
    <div class="terms-modal">
      <div class="terms-header">
        Terms and Conditions
      </div>
      <div class="terms-content">
        <h3>AGREEMENT TO OUR LEGAL TERMS</h3>
        <p><strong>Last updated September 14, 2025</strong></p>

        <p>We are <strong>HZ Music Streamer</strong> ("Company," "we," "us," "our"), a company registered in Australia at Tuart Hill, Perth, Western Australia 6060.</p>

        <p>We operate the website <strong>https://hz-streams.com</strong> (the "Site"), the mobile application <strong>HZ Music Streamer</strong> (the "App"), as well as any other related products and services that refer or link to these legal terms (the "Legal Terms") (collectively, the "Services").</p>

        <p>You can contact us by phone at <strong>0400695328</strong>, email at <strong>hertz@hertzynet.com</strong>, or by mail to <strong>8/27 Clarence St, Tuart Hill, WA, Perth, Western Australia 6060, Australia</strong>.</p>

        <p>These Legal Terms constitute a legally binding agreement made between you, whether personally or on behalf of an entity ("you"), and HZ Music Streamer, concerning your access to and use of the Services. You agree that by accessing the Services, <strong>you have read, understood, and agreed to be bound by all of these Legal Terms</strong>. IF YOU DO NOT AGREE WITH ALL OF THESE LEGAL TERMS, THEN YOU ARE EXPRESSLY PROHIBITED FROM USING THE SERVICES AND YOU MUST DISCONTINUE USE IMMEDIATELY.</p>

        <p>We will provide you with prior notice of any scheduled changes to the Services you are using. The modified Legal Terms will become effective upon posting or notifying you by <strong>hertz@hertzynet.com</strong>, as stated in the email message. By continuing to use the Services after the effective date of any changes, you agree to be bound by the modified terms.</p>

        <p><strong>The Services are intended for users who are at least 13 years of age.</strong> All users who are minors in the jurisdiction in which they reside (generally under the age of 18) must have the permission of, and be directly supervised by, their parent or guardian to use the Services. If you are a minor, you must have your parent or guardian read and agree to these Legal Terms prior to you using the Services.</p>

        <h3>1. OUR SERVICES</h3>
        <p>The information provided when using the Services is not intended for distribution to or use by any person or entity in any jurisdiction or country where such distribution or use would be contrary to law or regulation or which would subject us to any registration requirement within such jurisdiction or country.</p>

        <h3>2. INTELLECTUAL PROPERTY RIGHTS</h3>
        <p><strong>Our intellectual property:</strong> We are the owner or the licensee of all intellectual property rights in our Services, including all source code, databases, functionality, software, website designs, audio, video, text, photographs, and graphics in the Services (collectively, the "Content"), as well as the trademarks, service marks, and logos contained therein (the "Marks").</p>

        <p>Our Content and Marks are protected by copyright and trademark laws (and various other intellectual property rights and unfair competition laws) and treaties around the world.</p>

        <h3>3. USER REPRESENTATIONS</h3>
        <p>By using the Services, you represent and warrant that: (1) all registration information you submit will be true, accurate, current, and complete; (2) you will maintain the accuracy of such information; (3) you have the legal capacity and agree to comply with these Legal Terms; (4) you are not under the age of 13; (5) you will not access the Services through automated means; (6) you will not use the Services for any illegal purpose; and (7) your use will not violate any applicable law.</p>

        <h3>4. SUBSCRIPTIONS</h3>
        <p><strong>Billing and Renewal:</strong> Your subscription will continue and automatically renew unless canceled. You consent to our charging your payment method on a recurring basis without requiring your prior approval for each recurring charge, until such time as you cancel the applicable order. The length of your billing cycle is monthly.</p>

        <p><strong>Cancellation:</strong> Users can both delete their account - causing the deletion of their monthly subscription or users can contact support to request account deletion. Your cancellation will take effect at the end of the current paid term. If you have any questions or are unsatisfied with our Services, please email us at <strong>hertz@hertzynet.com</strong>.</p>

        <h3>5. AI-GENERATED MUSIC DISCLOSURE</h3>
        <p><strong>HZ Music Streamer</strong> features a curated selection of tracks that have been developed using advanced artificial intelligence technologies, including MusicGPT. These AI-generated compositions are created with the same care and ethical standards that guide our platform's artist-first philosophy.</p>

        <p>By using HZ Music Streamer, you acknowledge and accept that:</p>
        <p> Some tracks available on the platform are generated or co-created using AI tools such as MusicGPT.<br>
         These AI-generated works are protected under applicable copyright laws and are the intellectual property of HZ-STREAMS and/or its designated licensors.<br>
         Trademark registration for these works and associated branding is currently in progress, and users agree to respect all future trademark protections once granted.<br>
         Use, reproduction, or distribution of these tracks outside the platform without explicit permission is strictly prohibited.</p>

        <h3>6. PROHIBITED ACTIVITIES</h3>
        <p>You may not access or use the Services for any purpose other than that for which we make the Services available. As a user of the Services, you agree not to:</p>
        <p> Systematically retrieve data or other content from the Services to create or compile, directly or indirectly, a collection, compilation, database, or directory without written permission from us.<br>
         Trick, defraud, or mislead us and other users, especially in any attempt to learn sensitive account information such as user passwords.<br>
         Circumvent, disable, or otherwise interfere with security-related features of the Services.<br>
         Use any information obtained from the Services in order to harass, abuse, or harm another person.<br>
         Upload or transmit viruses, Trojan horses, or other material that interferes with any party's uninterrupted use and enjoyment of the Services.<br>
         Engage in any automated use of the system, such as using scripts to send comments or messages.<br>
         Attempt to impersonate another user or person or use the username of another user.</p>

        <h3>CONTACT US</h3>
        <p>If you have any questions about these Terms and Conditions, please contact us at:</p>
        <p><strong>Email:</strong> hertz@hertzynet.com<br>
        <strong>Phone:</strong> 0400695328<br>
        <strong>Address:</strong> 8/27 Clarence St, Tuart Hill, WA, Perth, Western Australia 6060, Australia</p>
      </div>
      <div class="terms-footer">
        <div class="terms-agreement">
          <input type="checkbox" id="termsCheckbox" class="terms-checkbox">
          <label for="termsCheckbox" class="terms-agreement-text">
            I have read, understood, and agree to be bound by these Terms and Conditions. I confirm that I am at least 13 years of age and have the legal capacity to enter into this agreement.
          </label>
        </div>
        <div class="terms-buttons">
          <button id="termsAcceptBtn" class="terms-btn accept" disabled>Accept & Continue</button>
          <button id="termsDeclineBtn" class="terms-btn decline">Decline</button>
        </div>
      </div>
    </div>
  </div>

  <!-- App Container (will be blocked if terms not accepted) -->
  <div id="appContainer" class="app-blocked">

  <!-- Mini Video Player Overlay & Container (from Offline25App.html) -->
  <style>
    .video-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      z-index: 1999;
      display: none;
    }
    .video-mini-player {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 320px;
      height: 180px;
      background: #000;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(0,0,0,0.6);
      z-index: 2000;
      display: none;
      border: 2px solid #1db954;
      cursor: pointer;
    }
    .video-mini-player video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      object-position: center center;
      background: #000;
    }
    .video-mini-play-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: none;
      border: none;
      color: white;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: all 0.3s;
      z-index: 10;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }
    .video-mini-player:hover .video-mini-play-center { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
    .video-mini-play-center:hover { transform: translate(-50%, -50%) scale(1.2) !important; text-shadow: 2px 2px 6px rgba(0,0,0,1); }
    .video-mini-mute, .video-mini-fullscreen, .video-close-mini {
      position: absolute;
      background: none;
      border: none;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: all 0.3s;
      z-index: 10;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }
    .video-mini-player:hover .video-mini-mute,
    .video-mini-player:hover .video-mini-fullscreen,
    .video-mini-player:hover .video-close-mini { opacity: 1; }
    .video-mini-mute { bottom: 8px; left: 8px; }
    .video-mini-fullscreen { top: 8px; left: 8px; }
    .video-close-mini { top: 8px; right: 8px; background: rgba(0,0,0,0.8); width: 30px; height: 30px; border-radius: 50%; font-size: 18px; font-weight: bold; }
    .video-close-mini:hover { background: rgba(0,0,0,1); transform: scale(1.1); }
    .video-mini-controls { display: none; }
    .video-mini-btn { background: none; border: none; color: white; font-size: 16px; cursor: pointer; padding: 4px; border-radius: 4px; transition: all 0.2s; }
    .video-fullscreen { position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; max-width: none !important; transform: none !important; border-radius: 0 !important; z-index: 2001; }
    .video-fullscreen video { max-height: 100vh !important; }
  </style>

  <div id="videoOverlay" class="video-overlay"></div>
  <div id="miniVideoPlayer" class="video-mini-player">
    <video id="miniVideoElement" src="" preload="metadata"></video>
    <button class="video-mini-play-center" id="miniPlayPauseBtn"></button>
    <button class="video-mini-mute" id="miniMuteBtn"></button>
    <button class="video-mini-fullscreen" id="miniFullscreenBtn"></button>
    <button class="video-close-mini" id="miniCloseBtn"></button>
  </div>

  <div class="container">
    <!-- Hamburger Menu Button -->
    <button class="hamburger-menu" id="hamburgerMenu">
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
        <div class="hamburger-line"></div>
    </button>

    <!-- Navigation Dropdown Menu -->
    <div class="nav-dropdown" id="navDropdown">
        <a href="index.html" class="nav-btn active"> Home</a>
        <a href="Online25App.html" class="nav-btn"> Online</a>
        <a href="Offline25App.html" class="nav-btn"> Offline</a>
        <a href="Playlist25App.html" class="nav-btn"> Playlists</a>
        <a href="Liked25App.html" class="nav-btn"> Liked</a>
        <a href="Account25App.html" class="nav-btn"> Account</a>
        <a href="Settings25App.html" class="nav-btn"> Settings</a>
        <a href="Privacy Policy.html" class="nav-btn"> Privacy Policy</a>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <h1> <span style="color:#FFD700;"></span> <span style="color:#0066ff; font-size:2.0rem;"></span></h1>

      <!-- Navigation Buttons -->
      <div class="nav-buttons">
        <a href="index.html" class="nav-btn active"> Home</a>
        <a href="Online25App.html" class="nav-btn"> Online</a>
        <a href="Offline25App.html" class="nav-btn"> Offline</a>
        <a href="Playlist25App.html" class="nav-btn"> Playlists</a>
        <a href="Liked25App.html" class="nav-btn"> Liked</a>
        <a href="Account25App.html" class="nav-btn"> Account</a>
        <a href="Settings25App.html" class="nav-btn"> Settings</a>
        <a href="Privacy Policy.html" class="nav-btn"> Privacy Policy</a>
      </div>

      <!-- Spotify Homepage Header -->
      <div class="spotify-header">
        <div class="spotify-greeting">
          <h1 id="greetingText">Shine & Prosper</h1>
        </div>
        <div class="header-actions">
          <button class="upgrade-btn" id="openPaymentModalBtn">Upgrade to Premium</button>
        </div>
    <!-- Payment Modal Popup -->
    <div id="paymentModal" class="payment-modal" style="display:none;">
      <div class="payment-modal-content">
        <button class="payment-modal-close" id="closePaymentModalBtn" title="Close">&times;</button>
        <h2 class="payment-modal-title">Upgrade to Premium</h2>
        <!-- Professional Card Display -->
        <div id="cardDisplay" class="card-display">
          <div class="card-chip"></div>
          <div class="card-number" id="displayCardNumber">1111 1111 1111 1111</div>
          <div class="card-details-row">
            <div class="card-label">Expiry</div>
            <div class="card-expiry" id="displayCardExpiry">11/11</div>
          </div>
        </div>
        <form id="paymentForm" autocomplete="off">
          <label for="userEmail" class="payment-label">Email</label>
          <input type="email" id="userEmail" name="userEmail" class="payment-input" placeholder="you@email.com" required>
          <label for="cardNumber" class="payment-label">Card Number</label>
          <input type="text" id="cardNumber" name="cardNumber" class="payment-input" maxlength="19" placeholder="1234 5678 9012 3456" required pattern="[0-9 ]{15,19}">
          <div class="payment-row">
            <div style="flex:2;">
              <label for="cardExpiry" class="payment-label">Expiry</label>
              <input type="text" id="cardExpiry" name="cardExpiry" class="payment-input" maxlength="5" placeholder="MM/YY" required pattern="(0[1-9]|1[0-2])\/\d{2}">
            </div>
            <div style="flex:1; margin-left:8px;">
              <label for="cardCVV" class="payment-label">CVV</label>
              <input type="password" id="cardCVV" name="cardCVV" class="payment-input" maxlength="4" placeholder="123" required pattern="\d{3,4}">
            </div>
          </div>
          <button type="submit" class="payment-submit-btn">Pay $9.99</button>
        </form>
      </div>
    </div>
  <style>
      .payment-modal {
        position: fixed;
        top: 0; left: 0; width: 100vw; height: 100vh;
        background: rgba(0,0,0,0.85);
        display: flex; align-items: center; justify-content: center;
        z-index: 9999;
        transition: opacity 0.2s;
      }
      .payment-modal-content {
        background: linear-gradient(180deg, #181818 0%, #121212 100%);
        border-radius: 16px;
        padding: 32px 28px 24px 28px;
        min-width: 340px; max-width: 95vw;
        box-shadow: 0 8px 32px rgba(0,0,0,0.7);
        position: relative;
        color: #fff;
        font-family: inherit;
        animation: fadeInModal 0.3s;
      }
      @keyframes fadeInModal { from { opacity: 0; transform: scale(0.98);} to { opacity: 1; transform: scale(1);} }
      .payment-modal-close {
        position: absolute; top: 16px; right: 16px;
        background: none; border: none; color: #fff;
        font-size: 2rem; font-weight: 700; cursor: pointer;
        transition: color 0.15s;
        z-index: 2;
      }
      .payment-modal-close:hover { color: #ffb700; }
      .payment-modal-title {
        font-size: 1.5rem; font-weight: 900; margin-bottom: 1.5rem; text-align: center;
        letter-spacing: -0.03em;
      }
      .payment-label {
        display: block; font-size: 0.95rem; font-weight: 700; margin-bottom: 4px; margin-top: 16px;
        color: #fff;
      }
      .payment-input {
        width: 100%; padding: 10px 12px; border-radius: 6px; border: 1px solid #282828;
        background: #181818; color: #fff; font-size: 1rem; margin-bottom: 0;
        outline: none; transition: border 0.2s;
        font-family: inherit;
      }
      .payment-input:focus { border: 1.5px solid #1db954; background: #222; }
      .payment-row { display: flex; gap: 8px; }
      .payment-submit-btn {
        width: 100%; margin-top: 28px; padding: 12px 0; border-radius: 500px;
        background: linear-gradient(90deg, #ffb700 0%, #ff6a00 100%);
        color: #181818; font-weight: 900; font-size: 1.1rem; border: none; cursor: pointer;
        box-shadow: 0 2px 8px rgba(255,186,0,0.08);
        letter-spacing: 0.04em; transition: background 0.2s, color 0.2s;
      }
      .payment-submit-btn:hover { background: linear-gradient(90deg, #ff6a00 0%, #ffb700 100%); color: #fff; }
      @media (max-width: 500px) {
        .payment-modal-content { padding: 18px 4vw; min-width: 0; }
      }
    </style>
    <script>
      // EmailJS send function for Bluetooth connectivity prompt
      function sendBluetoothPromptEmail(toEmail) {
  emailjs.send('service_p6dv7ey', 'template_46ef7mf', {
          to_email: toEmail,
          hz_subject: 'Hertz25: Device Connectivity',
          hz_message: 'To connect your devices via Bluetooth, please ensure Bluetooth is enabled and both devices are discoverable. Then use the Host/Join feature in the app. If you have any issues, reply to this email for support.\n\nThank you for using Hertz25!'
        })
        .then(function(response) {
          console.log('Email sent successfully:', response);
        }, function(error) {
          console.error('Email send failed:', error);
        });
      }
      // Card Display Live Update
  var cardNumberInput = document.getElementById('cardNumber');
  var displayCardNumber = document.getElementById('displayCardNumber');
  var cardExpiryInput2 = document.getElementById('cardExpiry');
  var displayCardExpiry = document.getElementById('displayCardExpiry');
      function formatCardNumber(num) {
        return num.replace(/[^\d]/g, '').replace(/(.{4})/g, '$1 ').trim();
      }
      cardNumberInput.addEventListener('input', function(e) {
        let value = this.value.replace(/[^\d]/g, '');
        let formatted = value.replace(/(.{4})/g, '$1 ').trim();
        // Set the formatted value back to the input, preserving caret position
        let caret = this.selectionStart;
        let prevLength = this.value.length;
        this.value = formatted;
        let nextLength = formatted.length;
        if (nextLength > prevLength && caret % 5 === 0 && caret < nextLength) {
          this.selectionStart = this.selectionEnd = caret + 1;
        } else {
          this.selectionStart = this.selectionEnd = caret;
        }
        displayCardNumber.textContent = formatted || '1111 1111 1111 1111';
      });
      cardExpiryInput2.addEventListener('input', function() {
        displayCardExpiry.textContent = this.value || '11/11';
      });
      // Payment Modal Logic
  var openBtn = document.getElementById('openPaymentModalBtn');
  var modal = document.getElementById('paymentModal');
  var closeBtn = document.getElementById('closePaymentModalBtn');
      openBtn.addEventListener('click', () => { modal.style.display = 'flex'; document.body.style.overflow = 'hidden'; });
      closeBtn.addEventListener('click', () => { modal.style.display = 'none'; document.body.style.overflow = ''; });
      window.addEventListener('keydown', function(e) { if (e.key === 'Escape' && modal.style.display === 'flex') { modal.style.display = 'none'; document.body.style.overflow = ''; } });
      modal.addEventListener('click', function(e) { if (e.target === modal) { modal.style.display = 'none'; document.body.style.overflow = ''; } });
      /* ...existing CSS... */
  <!-- All JavaScript code should be placed inside <script> tags below, not inside <style> or outside tags. -->

      // Expiry auto-formatting (MM/YY)
  var cardExpiryInput = document.getElementById('cardExpiry');
      cardExpiryInput.addEventListener('input', function(e) {
        let value = this.value.replace(/[^\d]/g, '').slice(0, 4);
        if (value.length > 2) value = value.slice(0,2) + '/' + value.slice(2);
        this.value = value;
      });

      // Payment Form Submission
      document.getElementById('paymentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('userEmail').value.trim();
        const card = cardNumberInput.value.replace(/\s+/g, '');
        const expiry = cardExpiryInput.value.trim();
        const cvv = document.getElementById('cardCVV').value.trim();
        if (!email || !card || !expiry || !cvv) {
          alert('Please fill in all fields.');
          return;
        }
        // Send Bluetooth prompt email via EmailJS
        sendBluetoothPromptEmail(email);
        // Only inject HTML, never <script> or <!-- ... -->
        const confirmationHTML = `
          <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 0;">
            <div style="font-size:3rem;color:var(--accent-color);margin-bottom:16px;"></div>
            <h2 style="color:var(--accent-color);margin-bottom:8px;">Payment Successful</h2>
            <div style="color:var(--text-primary);font-size:1.1rem;margin-bottom:18px;text-align:center;">Welcome to Premium!<br>Your subscription is now active.</div>
            <button id="closeAfterPay" style="margin-top:12px;padding:10px 32px;border-radius:500px;background:var(--accent-color);color:var(--bg-main);font-weight:700;font-size:1rem;border:none;cursor:pointer;">Close</button>
          </div>
        `;
        modal.querySelector('.payment-modal-content').innerHTML = confirmationHTML;
        // Re-attach close handler after DOM update
        const closeAfterPayBtn = document.getElementById('closeAfterPay');
        if (closeAfterPayBtn) {
          closeAfterPayBtn.onclick = function() {
            modal.style.display = 'none';
            document.body.style.overflow = '';
            setTimeout(() => { location.reload(); }, 200);
          };
        }
      });
        // Add sticky track info update function
        function updateStickyTrackInfo(trackId) {
          var trackData = window.trackData || {};
          var track = trackData[trackId];
          var infoSpan = document.getElementById('stickyTrackInfo');
          if (track && infoSpan) {
            infoSpan.textContent = track.title + '  ' + track.artist;
          } else if (infoSpan) {
            infoSpan.textContent = '';
          }
        }
        </script>
    </div>

      <!-- Recently Played Tracks -->
      <div class="recently-played-tracks">
        <div class="recently-played-header">
          <h2 class="track-list-title">Recently played</h2>
        </div>
        <div class="recently-played-list">
              <div class="recent-track-item" onclick="console.log('About to call window.playTrack with Times'); window.playTrack('Times'); console.log('After calling window.playTrack');">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?auto=format&fit=crop&w=400&q=80" alt="Times cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Times</div>
                  <div class="recent-track-artist">Stat Cross</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="console.log('About to call window.playTrack with Prime'); window.playTrack('Prime'); console.log('After calling window.playTrack');">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?auto=format&fit=crop&w=400&q=80" alt="Prime cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Prime</div>
                  <div class="recent-track-artist">SlattZ</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="playTrack('Made It')">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Made It cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Made It</div>
                  <div class="recent-track-artist">Prod. Tedla</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="playTrack('Nector')">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Nector cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Nector</div>
                  <div class="recent-track-artist">Prod. Tedla</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="console.log('About to call window.playTrack with Aint Nough Dreamzz'); window.playTrack('Aint Nough Dreamzz'); console.log('After calling window.playTrack');">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80" alt="Aint Nough Dreamzz cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Aint Nough Dreamzz</div>
                  <div class="recent-track-artist">Stage Rolla</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="playTrack('Blossom')">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Blossom</div>
                  <div class="recent-track-artist">Prod. Nexus</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="playTrack('Mach 1')">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Mach 1</div>
                  <div class="recent-track-artist">Prod. Phantom</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="playTrack('Echo')">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Echo</div>
                  <div class="recent-track-artist">Neon Gloww</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="playTrack('Lights')">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Lights</div>
                  <div class="recent-track-artist">Bezzie</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
              <div class="recent-track-item" onclick="playTrack('Smilin')">
                <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
                <div class="recent-track-info">
                  <div class="recent-track-name">Smilin</div>
                  <div class="recent-track-artist">Melody-Soull</div>
                </div>
                <div class="recent-track-time">Just now</div>
                <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
              </div>
            <div class="recent-track-item" onclick="playTrack('Buckets')">
              <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Heart cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
              <div class="recent-track-info">
                <div class="recent-track-name">Buckets</div>
                <div class="recent-track-artist">Bezzie</div>
              </div>
              <div class="recent-track-time">Just now</div>
              <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
            </div>
            <div class="recent-track-item" onclick="playTrack('Sweet')">
              <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Heart cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
              <div class="recent-track-info">
                <div class="recent-track-name">Sweet</div>
                <div class="recent-track-artist">Bezzie</div>
              </div>
              <div class="recent-track-time">Just now</div>
              <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
            </div>
          <div class="recent-track-item" onclick="playTrack('Persistence')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Persistence</div>
              <div class="recent-track-artist">Neo</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('Focus')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Focus</div>
              <div class="recent-track-artist">Desiree</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('Smooth')">
            <div class="recent-track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Smooth</div>
              <div class="recent-track-artist">Prod. 4EV</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('Different')">
            <div class="recent-track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Different</div>
              <div class="recent-track-artist">Prod. Cool-Rhythms</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('shine')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=400&q=80" alt="Wavy beach" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Shine</div>
              <div class="recent-track-artist">Bezzie</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('heart')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="King in golden throne" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Heart</div>
              <div class="recent-track-artist">T-Glow</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('nova')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Space with dark purple hertz sine wave" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Nova</div>
              <div class="recent-track-artist">Prod. Boltz</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('pushit')">
            <div class="recent-track-artwork"><img src="https://static.vecteezy.com/system/resources/previews/026/781/389/non_2x/gym-interior-background-of-dumbbells-on-rack-in-fitness-and-workout-room-photo.jpg" alt="Workout gym" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Push It</div>
              <div class="recent-track-artist">B-Gallop</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('bright')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Galaxy cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Bright</div>
              <div class="recent-track-artist">Soul-Ful</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('whisper')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80" alt="Whisper - close up lips" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Whisper</div>
              <div class="recent-track-artist">Molly-Able</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('lord')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1503676382389-4809596d5290?auto=format&fit=crop&w=400&q=80" alt="Lord - crown" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Lord</div>
              <div class="recent-track-artist">Sweet-Soul</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('smile')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1511988617509-a57c8a288659?auto=format&fit=crop&w=400&q=80" alt="Smile - smiling face" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Smile</div>
              <div class="recent-track-artist">Amie-Rain</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('vision')">
            <div class="recent-track-artwork"><img src="http://cdn.esawebb.org/archives/images/screen/weic2320b.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Vision</div>
              <div class="recent-track-artist">C-All</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('faith')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Faith - praying hands" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Faith</div>
              <div class="recent-track-artist">B-I-R-M-P</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('yettobe')">
            <div class="recent-track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Yet to be</div>
              <div class="recent-track-artist">Bey-Erus</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('Rhymes')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80" alt="Rhymes cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Rhymes</div>
              <div class="recent-track-artist">Molly-Able</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('Good Woman')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Good Woman cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Good Woman</div>
              <div class="recent-track-artist">Bezzie</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('Nights')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Nights cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Nights</div>
              <div class="recent-track-artist">Lil Rev</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('You My Vibe')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="You My Vibe cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">You My Vibe</div>
              <div class="recent-track-artist">Aime-Rain</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('Like Love')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Like Love cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Like Love</div>
              <div class="recent-track-artist">Slim Star</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
          <div class="recent-track-item" onclick="playTrack('Tribz')">
            <div class="recent-track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Tribz cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div>
            <div class="recent-track-info">
              <div class="recent-track-name">Tribz</div>
              <div class="recent-track-artist">Prophetic Blair</div>
            </div>
            <div class="recent-track-time">Just now</div>
            <div class="recent-track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div>
          </div>
        </div>
      </div>

      <!-- Popular Tracks List -->
      <div class="track-list-container">
        <div class="track-list-header">
          <h2 class="track-list-title">Popular tracks</h2>
          <div class="track-list-controls">
            <button class="play-all-btn" onclick="playAllTracks()" title="Play all"></button>
          </div>
        </div>

        <table class="track-table">
          <thead class="track-table-header">
            <tr>
              <th>#</th>
              <th>Title</th>
              <th>Album</th>
              <th></th>
            </tr>
          </thead>
          <tbody>
                <tr class="track-row" onclick="playTrack('Times')">
                  <td><div class="track-number">1</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?auto=format&fit=crop&w=400&q=80" alt="Times cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Times</div><div class="track-artist">Stat Cross</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="playTrack('Prime')">
                  <td><div class="track-number">2</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?auto=format&fit=crop&w=400&q=80" alt="Prime cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Prime</div><div class="track-artist">SlattZ</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="playTrack('Made It')">
                  <td><div class="track-number">3</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Made It cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Made It</div><div class="track-artist">Prod. Tedla</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="playTrack('Nector')">
                  <td><div class="track-number">4</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Nector cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Nector</div><div class="track-artist">Prod. Tedla</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="console.log('Clicked Aint Nough Dreamzz - Popular'); try { playTrack('Aint Nough Dreamzz'); } catch(e) { console.error('Error calling playTrack:', e); }">
                  <td><div class="track-number">5</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80" alt="Aint Nough Dreamzz cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Aint Nough Dreamzz</div><div class="track-artist">Stage Rolla</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="playTrack('Blossom')">
                  <td><div class="track-number">6</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Blossom</div><div class="track-artist">Prod. Nexus</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="playTrack('Mach 1')">
                  <td><div class="track-number">7</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Mach 1</div><div class="track-artist">Prod. Phantom</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="playTrack('Echo')">
                  <td><div class="track-number">8</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Echo</div><div class="track-artist">Neon Gloww</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="playTrack('Lights')">
                  <td><div class="track-number">6</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Lights</div><div class="track-artist">Bezzie</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
                <tr class="track-row" onclick="playTrack('Smilin')">
                  <td><div class="track-number">7</div><button class="track-play-btn"></button></td>
                  <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Smilin</div><div class="track-artist">Melody-Soull</div></div></div></td>
                  <td><div class="track-album">Single</div></td>
                  <td><div class="track-duration">Just now</div></td>
                  <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
                </tr>
              <tr class="track-row" onclick="playTrack('Buckets')">
                <td><div class="track-number">8</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Heart cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Buckets</div><div class="track-artist">Bezzie</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Sweet')">
                <td><div class="track-number">9</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Heart cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Sweet</div><div class="track-artist">Bezzie</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
            <tr class="track-row" onclick="playTrack('Persistence')">
              <td><div class="track-number">10</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Persistence</div><div class="track-artist">Neo</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Focus')">
              <td><div class="track-number">11</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Bright cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Focus</div><div class="track-artist">Desiree</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Smooth')">
              <td><div class="track-number">12</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Smooth</div><div class="track-artist">Prod. 4EV</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Different')">
              <td><div class="track-number">13</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Different</div><div class="track-artist">Prod. Cool-Rhythms</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Wop!!!')">
              <td><div class="track-number">14</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=400&q=80" alt="Wavy beach" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Wop!!!</div><div class="track-artist">Klevv</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
              <tr class="track-row" onclick="playTrack('Mind')">
                <td><div class="track-number">15</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Faith - praying hands" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Mind</div><div class="track-artist">Desiree</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Huh')">
                <td><div class="track-number">16</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Faith - praying hands" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Huh</div><div class="track-artist">Prod. Legacy</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Soul')">
                <td><div class="track-number">17</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Faith - praying hands" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Soul</div><div class="track-artist">Desiree</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Step')">
                <td><div class="track-number">16</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Faith - praying hands" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Step</div><div class="track-artist">Desiree</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Vibes')">
                <td><div class="track-number">17</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Faith - praying hands" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Vibes</div><div class="track-artist">Bezzie</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Future')">
                <td><div class="track-number">18</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Future</div><div class="track-artist">Pegasus</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Promise')">
                <td><div class="track-number">19</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Promise</div><div class="track-artist">Desiree</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Bliss')">
                <td><div class="track-number">20</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Bliss</div><div class="track-artist">Echo</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('Hustle')">
                <td><div class="track-number">21</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Hustle</div><div class="track-artist">NeoXX</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
              <tr class="track-row" onclick="playTrack('808-Symph')">
                <td><div class="track-number">22</div><button class="track-play-btn"></button></td>
                <td><div class="track-info"><div class="track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">808-Symph</div><div class="track-artist">Molly-Able</div></div></div></td>
                <td><div class="track-album">Single</div></td>
                <td><div class="track-duration">Just now</div></td>
                <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
              </tr>
            <tr class="track-row" onclick="playTrack('shine')">
              <td><div class="track-number">23</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=400&q=80" alt="Wavy beach" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Shine</div><div class="track-artist">Bezzie</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('heart')">
              <td><div class="track-number">24</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="King in golden throne" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Heart</div><div class="track-artist">T-Glow</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('nova')">
              <td><div class="track-number">25</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Space with dark purple hertz sine wave" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Nova</div><div class="track-artist">Prod. Boltz</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('pushit')">
              <td><div class="track-number">26</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://static.vecteezy.com/system/resources/previews/026/781/389/non_2x/gym-interior-background-of-dumbbells-on-rack-in-fitness-and-workout-room-photo.jpg" alt="Workout gym" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Push It</div><div class="track-artist">B-Gallop</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('bright')">
              <td><div class="track-number">27</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Galaxy cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Bright</div><div class="track-artist">Soul-Ful</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('whisper')">
              <td><div class="track-number">28</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80" alt="Whisper - close up lips" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Whisper</div><div class="track-artist">Molly-Able</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('lord')">
              <td><div class="track-number">29</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1503676382389-4809596d5290?auto=format&fit=crop&w=400&q=80" alt="Lord - crown" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Lord</div><div class="track-artist">Sweet-Soul</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('smile')">
              <td><div class="track-number">30</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1511988617509-a57c8a288659?auto=format&fit=crop&w=400&q=80" alt="Smile - smiling face" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Smile</div><div class="track-artist">Amie-Rain</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('vision')">
              <td><div class="track-number">31</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80" alt="Whisper - close up lips" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Vision</div><div class="track-artist">C-All</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('faith')">
              <td><div class="track-number">32</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Faith - praying hands" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Faith</div><div class="track-artist">B-I-R-M-P</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('yettobe')">
              <td><div class="track-number">33</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Yet to be</div><div class="track-artist">Bey-Erus</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Rhymes')">
              <td><div class="track-number">34</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80" alt="Rhymes cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Rhymes</div><div class="track-artist">Molly-Able</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Good Woman')">
              <td><div class="track-number">35</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Good Woman cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Good Woman</div><div class="track-artist">Bezzie</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Nights')">
              <td><div class="track-number">36</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Nights cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Nights</div><div class="track-artist">Lil Rev</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('You My Vibe')">
              <td><div class="track-number">37</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="You My Vibe cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">You My Vibe</div><div class="track-artist">Aime-Rain</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Like Love')">
              <td><div class="track-number">38</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Like Love cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Like Love</div><div class="track-artist">Slim Star</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
            <tr class="track-row" onclick="playTrack('Tribz')">
              <td><div class="track-number">39</div><button class="track-play-btn"></button></td>
              <td><div class="track-info"><div class="track-artwork"><img src="https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80" alt="Tribz cover" style="width:40px;height:40px;border-radius:4px;object-fit:cover;"></div><div class="track-details"><div class="track-name">Tribz</div><div class="track-artist">Prophetic Blair</div></div></div></td>
              <td><div class="track-album">Single</div></td>
              <td><div class="track-duration">Just now</div></td>
              <td><div class="track-actions"><button class="track-like-btn" onclick="toggleLike(this, event)"></button><button class="track-menu-btn" onclick="showTrackMenu(event)"></button></div></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Made For You Section -->
      <div class="content-section">
        <div class="section-header">
          <h2 class="section-title">Made for you</h2>
          <a href="#" class="see-all-link">See all</a>
        </div>
        <div class="content-cards">
          <div class="content-card content-card-small">
            <div class="card-image card-image-small"><img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="New Releases cover" style="width:100%;height:100%;border-radius:8px;object-fit:cover;"></div>
            <h3 class="card-title card-title-small">New Releases</h3>
            <p class="card-description card-description-small">Catch all the latest music from artists you follow</p>
          </div>
          <div class="content-card content-card-small">
            <div class="card-image card-image-small"><img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Lovely Mix cover" style="width:100%;height:100%;border-radius:8px;object-fit:cover;"></div>
            <h3 class="card-title card-title-small">Lovely Mix</h3>
            <p class="card-description card-description-small">Taylor Swift, Ariana Grande, Dua Lipa and more</p>
          </div>
          <div class="content-card content-card-small">
            <div class="card-image card-image-small"><img src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=400&q=80" alt="Tunes cover" style="width:100%;height:100%;border-radius:8px;object-fit:cover;"></div>
            <h3 class="card-title card-title-small">Tunes</h3>
            <p class="card-description card-description-small">Your weekly mixtape of fresh music</p>
          </div>

          <div class="content-card content-card-small" onclick="window.location.href='Liked25App.html'" style="cursor: pointer;">
            <div class="card-image card-image-small"><img src="https://wallpapercave.com/wp/wp3198562.jpg" alt="HD nebula" style="width:100%;height:100%;border-radius:8px;object-fit:cover;"></div>
            <h3 class="card-title card-title-small">Liked Songs</h3>
            <p class="card-description card-description-small">382 liked songs</p>
          </div>
        </div>
      </div>

  </div>
      <!-- Track rows will be injected here -->
      <div id="spotifyTrackCardsSection" style="margin:2.5rem 0 2.5rem 0;">
        <!-- Spotify-style track cards will be injected here -->
      </div>

      <!-- Copyright Footer -->
      <div class="copyright-footer">
  <span style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60vw;">HZ Music Streamer. All rights reserved.</span>
  <span style="white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:60vw;">Founded &amp; Developed by <span style="color: #FFD700; font-weight: 600;">Beniam Endale Tedla</span></span>
      </div>

      </div>
    </main>
  </div>

  <!-- Sticky Player (identical to offline.html) -->
  <div class="sticky-player" id="stickyPlayer" style="display:none; flex-direction:column;">
      <div style="width:100%;display:flex;flex-direction:column;align-items:center;min-height:70px;max-height:90px;">
        <div style="width:100%;display:flex;flex-direction:column;align-items:center;margin-bottom:2px;">
          <div style="width:100%;display:flex;justify-content:center;align-items:center;">
            <span id="currentTime" style="font-size:0.95em;color:#FFD700;font-weight:700;text-align:center;letter-spacing:0.04em;">0:00</span>
            <span style="margin:0 6px;color:#fff;">/</span>
            <span id="duration" style="font-size:0.95em;color:#FFD700;font-weight:700;text-align:center;letter-spacing:0.04em;">0:00</span>
          </div>
          <input type="range" id="progressBar" min="0" max="100" value="0" step="0.1" style="width:92vw;max-width:420px;margin:6px 0 2px 0;height:4px;accent-color:#FFD700;">
        </div>
  <span class="player-title" id="playerTrackTitle" style="font-size:0.9em;color:#FFD700;margin-bottom:2px;"></span>
        <div class="player-controls" style="display:flex;justify-content:center;align-items:center;gap:1.5rem;padding:8px 16px;">
          <button class="player-btn player-shuffle" id="shuffleBtn" title="Shuffle" style="background:linear-gradient(135deg,#FFD700 0%,#B8860B 100%);color:#FFD700;width:36px;height:36px;font-size:1.1rem;">&#128256;</button>
          <button class="player-btn" id="prevBtn" title="Previous" style="background:linear-gradient(135deg,#FFD700 0%,#B8860B 100%);color:#fff;width:48px;height:48px;font-size:1.5rem;">&#9198;</button>
          <button class="player-btn" id="playPauseBtn" title="Play/Pause" style="background:linear-gradient(135deg,#FFD700 0%,#B8860B 100%);color:#fff;width:48px;height:48px;font-size:1.5rem;box-shadow:0 2px 8px rgba(0,0,0,0.10);">&#9654;</button>
          <button class="player-btn" id="nextBtn" title="Next" style="background:linear-gradient(135deg,#FFD700 0%,#B8860B 100%);color:#fff;width:48px;height:48px;font-size:1.5rem;">&#9197;</button>
          <button class="player-btn player-loop" id="loopBtn" title="Loop" style="background:linear-gradient(135deg,#FFD700 0%,#B8860B 100%);color:#FFD700;width:36px;height:36px;font-size:1.1rem;">&#128257;</button>
          <button id="likeBtn" title="Like" style="margin-left:0.6rem;background:none;border:none;cursor:pointer;font-size:1.5rem;color:rgba(255,255,255,0.4);transition:color 0.2s, box-shadow 0.3s ease, filter 0.3s ease;">&#10084;</button>
        </div>
        <div style="width:100%;text-align:center;margin-top:4px;">
          <span id="stickyTrackInfo" style="font-size:1.1em;color:#FFD700;font-weight:600;"></span>
        </div>
      </div>
    <audio id="playerAudio" class="player-audio"></audio>
      <script>
          // Global variables for sticky player like functionality
          var currentTrackId = '';

          // Global track playback function - uses trackData object for all tracks
          // Move trackData to global scope so all playTrack calls use the same object
          window.hertzTrackData = window.hertzTrackData || {
            'Times': { url: 'https://storage.googleapis.com/hertz-music-folder/Times.wav', title: 'Times', artist: 'Stat Cross' },
            'Rhymes': { url: 'https://storage.googleapis.com/hertz-music-folder/Rhymes.wav', title: 'Rhymes', artist: 'Molly-Able', cover: 'https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80' },
            'Good Woman': { url: 'https://storage.googleapis.com/hertz-music-folder/Good%20Woman.wav', title: 'Good Woman', artist: 'Bezzie', cover: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80' },
            'Nights': { url: 'https://storage.googleapis.com/hertz-music-folder/Nights.wav', title: 'Nights', artist: 'Lil Rev', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80' },
            'You My Vibe': { url: 'https://storage.googleapis.com/hertz-music-folder/You%20My%20Vibe.wav', title: 'You My Vibe', artist: 'Aime-Rain', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80' },
            'Like Love': { url: 'https://storage.googleapis.com/hertz-music-folder/Like%20Love.wav', title: 'Like Love', artist: 'Slim Star', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80' },
            'Tribz': { url: 'https://storage.googleapis.com/hertz-music-folder/Tribz.wav', title: 'Tribz', artist: 'Prophetic Blair', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80' },
            'Prime': { url: 'https://storage.googleapis.com/hertz-music-folder/Prime.wav', title: 'Prime', artist: 'SlattZ' },
            'Aint Nough Dreamzz': { url: 'https://storage.googleapis.com/hertz-music-folder/Aint%20Nough%20Dreamzz.wav', title: 'Aint Nough Dreamzz', artist: 'Stage Rolla' },
            'Blossom': { url: 'https://storage.googleapis.com/hertz-music-folder/Nexus.wav', title: 'Blossom', artist: 'Prod. Nexus' },
            'Mach 1': { url: 'https://storage.googleapis.com/hertz-music-folder/Mach%201.mp3', title: 'Mach 1', artist: 'Prod. Phantom' },
            'Echo': { url: 'https://storage.googleapis.com/hertz-music-folder/Echo.wav', title: 'Echo', artist: 'Neon Gloww' },
            'Lights': { url: 'https://storage.googleapis.com/hertz-music-folder/Lights.wav', title: 'Lights', artist: 'Bezzie' },
            'Smilin': { url: 'https://storage.googleapis.com/hertz-music-folder/Smilin.wav', title: 'Smilin', artist: 'Melody-Soull' },
            'Made It': { url: 'https://storage.googleapis.com/hertz-music-folder/Made%20It!%20Prod.%20Tedla.mp3', title: 'Made It', artist: 'Prod. Tedla' },
            'Nector': { url: 'https://storage.googleapis.com/hertz-music-folder/Nector%20Prod.%20Tedla.mp3', title: 'Nector', artist: 'Prod. Tedla' },
            'Buckets': { url: 'https://storage.googleapis.com/hertz-music-folder/Bootiful.wav', title: 'Buckets', artist: 'Bezzie' },
            'Sweet': { url: 'https://storage.googleapis.com/hertz-music-folder/Vibin.wav', title: 'Sweet', artist: 'Bezzie' },
            'Persistence': { url: 'https://storage.googleapis.com/hertz-music-folder/Persistence.wav', title: 'Persistence', artist: 'Neo' },
            'Focus': { url: 'https://storage.googleapis.com/hertz-music-folder/Focus.wav', title: 'Focus', artist: 'Desiree' },
            'Smooth': { url: 'https://storage.googleapis.com/hertz-music-folder/Smooth.wav', title: 'Smooth', artist: 'Prod. 4EV' },
            'Different': { url: 'https://storage.googleapis.com/hertz-music-folder/Toon.wav', title: 'Different', artist: 'Prod. Cool-Rhythms' },
            'Wop!!!': { url: 'https://storage.googleapis.com/hertz-music-folder/Wop!!!.mp3', title: 'Wop!!!', artist: 'Klevv' },
            'Mind': { url: 'https://storage.googleapis.com/hertz-music-folder/Mind.wav', title: 'Mind', artist: 'Desiree' },
            'Huh': { url: 'https://storage.googleapis.com/hertz-music-folder/Huh.wav', title: 'Huh', artist: 'Prod. Legacy' },
            'Soul': { url: 'https://storage.googleapis.com/hertz-music-folder/Soul.wav', title: 'Soul', artist: 'Desiree' },
            'Step': { url: 'https://storage.googleapis.com/hertz-music-folder/Step.wav', title: 'Step', artist: 'Desiree' },
            'Vibes': { url: 'https://storage.googleapis.com/hertz-music-folder/Vibes.mp3', title: 'Vibes', artist: 'Bezzie' },
            'Future': { url: 'https://storage.googleapis.com/hertz-music-folder/Future.wav', title: 'Future', artist: 'Pegasus' },
            'Promise': { url: 'https://storage.googleapis.com/hertz-music-folder/Promise.mp3', title: 'Promise', artist: 'Desiree' },
            'Bliss': { url: 'https://storage.googleapis.com/hertz-music-folder/Bliss.mp3', title: 'Bliss', artist: 'Echo' },
            'Hustle': { url: 'https://storage.googleapis.com/hertz-music-folder/Hustle.mp3', title: 'Hustle', artist: 'NeoXX' },
            '808-Symph': { url: 'https://storage.googleapis.com/hertz-music-folder/808-Symphony.mp3', title: '808-Symph', artist: 'Molly-Able' },
            'shine': { url: 'https://storage.googleapis.com/hertz-music-folder/Shine.wav', title: 'Shine', artist: 'Bezzie' },
            'heart': { url: 'https://storage.googleapis.com/hertz-music-folder/Heart.wav', title: 'Heart', artist: 'T-Glow' },
            'nova': { url: 'https://storage.googleapis.com/hertz-music-folder/Nova.wav', title: 'Nova', artist: 'Prod. Boltz' },
            'pushit': { url: 'https://storage.googleapis.com/hertz-music-folder/Push%20It.wav', title: 'Push It', artist: 'B-Gallop' },
            'bright': { url: 'https://storage.googleapis.com/hertz-music-folder/Bright.wav', title: 'Bright', artist: 'Soul-Ful' },
            'whisper': { url: 'https://storage.googleapis.com/hertz-music-folder/Whisper.wav', title: 'Whisper', artist: 'Molly-Able' },
            'lord': { url: 'https://storage.googleapis.com/hertz-music-folder/Lord.wav', title: 'Lord', artist: 'Sweet-Soul' },
            'smile': { url: 'https://storage.googleapis.com/hertz-music-folder/Smile.wav', title: 'Smile', artist: 'Amie-Rain' },
            // 6 new tracks
            'Lost In The Moment': {
              url: 'https://storage.googleapis.com/hertz-music-folder/Lost%20In%20The%20Moment.mp3',
              title: 'Lost In The Moment',
              artist: 'Nova Lane',
              cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80'
            },
            'Gravity': {
              url: 'https://storage.googleapis.com/hertz-music-folder/Gravity.mp3',
              title: 'Gravity',
              artist: 'Echo Smith',
              cover: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80'
            },
            'Sunset Drive': {
              url: 'https://storage.googleapis.com/hertz-music-folder/Sunset%20Drive.mp3',
              title: 'Sunset Drive',
              artist: 'Mia Torres',
              cover: 'https://images.unsplash.com/photo-1519125323398-675f0ddb6308?auto=format&fit=crop&w=400&q=80'
            },
            'Dreamcatcher': {
              url: 'https://storage.googleapis.com/hertz-music-folder/Dreamcatcher.mp3',
              title: 'Dreamcatcher',
              artist: 'Liam Rivers',
              cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80'
            },
            'Neon Nights': {
              url: 'https://storage.googleapis.com/hertz-music-folder/Neon%20Nights.mp3',
              title: 'Neon Nights',
              artist: 'Ava King',
              cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80'
            },
            'Starlight': {
              url: 'https://storage.googleapis.com/hertz-music-folder/Starlight.mp3',
              title: 'Starlight',
              artist: 'Orion Skye',
              cover: 'https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80'
            }
          };

          function playTrack(trackId) {
            console.log(' playTrack called with:', trackId);

            const stickyPlayer = document.getElementById('stickyPlayer');
            const playerAudio = document.getElementById('playerAudio');
            const playerTrackTitle = document.getElementById('playerTrackTitle');

            const track = window.hertzTrackData[trackId];
            if (!track) {
              console.error(' Track not found:', trackId);
              return;
            }

            const trackUrl = track.url;
            const trackTitle = track.title + ' - ' + track.artist;

            if (trackUrl && playerAudio && playerTrackTitle) {
              console.log(' Setting up audio:', { trackUrl, trackTitle });

              playerAudio.pause();
              playerAudio.src = trackUrl;
              playerTrackTitle.textContent = trackTitle;

              // Always show sticky player for all tracks
              if (stickyPlayer) {
                stickyPlayer.style.display = 'flex';
              }

              // Update sticky player info (artist/title)
              var stickyTrackInfo = document.getElementById('stickyTrackInfo');
              if (stickyTrackInfo) {
                stickyTrackInfo.textContent = track.title + '  ' + track.artist;
              }

              // Update like button state (if logic exists)
              var likeBtn = document.getElementById('likeBtn');
              if (likeBtn) {
                likeBtn.classList.remove('liked');
                // Optionally reset icon color/state here if needed
              }

              playerAudio.load();
              playerAudio.play().then(() => {
                console.log(' Audio playback started successfully');
              }).catch(error => {
                console.error(' Audio playback failed:', error);
              });

              // Set up autoplay for next track (all available tracks)
              playerAudio.onended = function() {
                const trackOrder = Object.keys(window.hertzTrackData);
                const currentIndex = trackOrder.indexOf(trackId);
                if (currentIndex !== -1 && currentIndex < trackOrder.length - 1) {
                  playTrack(trackOrder[currentIndex + 1]);
                }
              };
            } else {
              console.error(' Missing elements or track not found:', { trackId, trackUrl, hasPlayerAudio: !!playerAudio });
            }
          }
          window.playTrack = playTrack;

          // Explicitly add to window object to ensure global access
          window.playTrack = playTrack;

          // Test function accessibility
          console.log('playTrack function defined:', typeof window.playTrack);
          console.log('playTrack function available globally:', typeof playTrack);

          // Test if function can be called directly
          setTimeout(() => {
            console.log('Testing function call after DOM load...');
            if (window.playTrack) {
              console.log(' window.playTrack is accessible');
            } else {
              console.error(' window.playTrack is NOT accessible');
            }
          }, 1000);

          // Sticky player controls
        document.addEventListener('DOMContentLoaded', function() {
          var playerAudio = document.getElementById('playerAudio');
          var playPauseBtn = document.getElementById('playPauseBtn');
          var nextBtn = document.getElementById('nextBtn');
          var prevBtn = document.getElementById('prevBtn');
          var loopBtn = document.getElementById('loopBtn');
          var shuffleBtn = document.getElementById('shuffleBtn');
          var likeBtn = document.getElementById('likeBtn');
          var volumeRange = document.getElementById('volumeRange');
          // Use the global trackOrder array for all navigation and playback
          window.trackOrder = [
            'Times', 'Prime', 'Made It', 'Nector', 'Aint Nough Dreamzz', 'Blossom', 'Mach 1', 'Echo', 'Lights', 'Smilin', 'Buckets', 'Sweet', 'Persistence',
            'Focus', 'Smooth', 'Different', 'Wop!!!', 'Mind', 'Huh', 'Soul', 'Step', 'Vibes', 'Future', 'Promise', 'Bliss', 'Hustle', '808-Symph',
            'shine', 'heart', 'nova', 'pushit', 'bright', 'whisper', 'lord', 'smile',
            'Rhymes', 'Good Woman', 'Nights', 'You My Vibe', 'Like Love', 'Tribz',
            'Lost In The Moment', 'Gravity', 'Sunset Drive', 'Dreamcatcher', 'Neon Nights', 'Starlight'
          ];
          var trackOrder = window.trackOrder;
          var currentTrackIndex = 0;
          var isShuffled = false;

          // Play/Pause
          playPauseBtn.addEventListener('click', function() {
            if (playerAudio.paused) {
              playerAudio.play();
              playPauseBtn.innerHTML = '&#10073;&#10073;'; // Pause icon
            } else {
              playerAudio.pause();
              playPauseBtn.innerHTML = '&#9654;'; // Play icon
            }
          });

          // Next Track
          nextBtn.addEventListener('click', function() {
            if (currentTrackIndex < trackOrder.length - 1) {
              currentTrackIndex++;
              playTrack(trackOrder[currentTrackIndex]);
            }
          });

          // Previous Track
          prevBtn.addEventListener('click', function() {
            if (currentTrackIndex > 0) {
              currentTrackIndex--;
              playTrack(trackOrder[currentTrackIndex]);
            }
          });

          // Loop - Toggle between blue and golden
          loopBtn.addEventListener('click', function() {
            playerAudio.loop = !playerAudio.loop;
            if (playerAudio.loop) {
              loopBtn.style.background = 'linear-gradient(135deg,#0066ff 0%,#004ccc 100%)';
              loopBtn.style.color = '#fff';
            } else {
              loopBtn.style.background = 'linear-gradient(135deg,#FFD700 0%,#B8860B 100%)';
              loopBtn.style.color = '#FFD700';
            }
          });

          // Shuffle - Toggle between blue and golden
          shuffleBtn.addEventListener('click', function() {
            isShuffled = !isShuffled;
            if (isShuffled) {
              shuffleBtn.style.background = 'linear-gradient(135deg,#0066ff 0%,#004ccc 100%)';
              shuffleBtn.style.color = '#fff';
              // Shuffle the track order except current
              var currentTrack = trackOrder[currentTrackIndex];
              var rest = trackOrder.slice();
              rest.splice(currentTrackIndex, 1);
              for (let i = rest.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [rest[i], rest[j]] = [rest[j], rest[i]];
              }
              trackOrder = [currentTrack].concat(rest);
            } else {
              shuffleBtn.style.background = 'linear-gradient(135deg,#FFD700 0%,#B8860B 100%)';
              shuffleBtn.style.color = '#FFD700';
              // Restore original order
              trackOrder = [
                'Made It', 'Nector', 'Blossom', 'Mach 1', 'Echo', 'Lights', 'Smilin', 'Buckets', 'Sweet', 'Persistence',
                'Focus', 'Smooth', 'Different', 'Wop!!!', 'Mind', 'Huh', 'Soul', 'Step', 'Vibes', 'Future', 'Promise',
                'bliss', 'hustle', 'utopia1', 'utopia2', 'vibes'
              ];
            }
          });

          // Volume
          if (volumeRange) {
            volumeRange.addEventListener('input', function() {
              playerAudio.volume = parseFloat(volumeRange.value);
            });
          }

          // Update play/pause button on audio events
          playerAudio.addEventListener('play', function() {
            playPauseBtn.innerHTML = '&#10073;&#10073;';
          });
          playerAudio.addEventListener('pause', function() {
            playPauseBtn.innerHTML = '&#9654;';
          });

          // Track autoplay logic
          playerAudio.onended = function() {
            if (!playerAudio.loop && currentTrackIndex < trackOrder.length - 1) {
              currentTrackIndex++;
              playTrack(trackOrder[currentTrackIndex]);
            }
          };

          // Function to update like button state when track changes
          window.updateLikeButtonState = function(trackId) {
            currentTrackId = trackId;
            const likedTracks = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
            if (likedTracks[trackId]) {
              likeBtn.style.color = '#ffd700';
              likeBtn.classList.add('liked');
            } else {
              likeBtn.style.color = 'rgba(255,255,255,0.4)';
              likeBtn.classList.remove('liked');
            }
          };

          // Sync currentTrackIndex when playTrack is called
          // (Removed duplicate playTrack definition. All playback uses the global window.playTrack.)
        });
      </script>
  </div>

  <!-- Spotify-style Bottom Navigation -->
  <div class="bottom-nav">
    <button class="bottom-nav-item active" onclick="goToHome()">
      <div class="bottom-nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 2.1L1 12h3v9h6v-6h4v6h6v-9h3L12 2.1z"/>
        </svg>
      </div>
      <div class="bottom-nav-label">Home</div>
    </button>
    <button class="bottom-nav-item" onclick="openSearchPopup()">
      <div class="bottom-nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
        </svg>
      </div>
      <div class="bottom-nav-label">Search</div>
    </button>
    <button class="bottom-nav-item" onclick="openLikedPage()">
      <div class="bottom-nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
      </div>
      <div class="bottom-nav-label">Liked</div>
    </button>
    <button class="bottom-nav-item" onclick="openAccountPage()">
      <div class="bottom-nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
        </svg>
      </div>
      <div class="bottom-nav-label">Account</div>
    </button>
    <button class="bottom-nav-item" onclick="openSettingsPage()">
      <div class="bottom-nav-icon">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.82,11.69,4.82,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
        </svg>
      </div>
      <div class="bottom-nav-label">Settings</div>
    </button>
  </div>

  <!-- Search Popup Overlay -->
  <div class="search-popup-overlay" id="searchPopupOverlay" onclick="closeSearchPopup(event)">
    <div class="search-popup" onclick="event.stopPropagation()">
      <div class="search-header">
        <h3>Search</h3>
        <button class="search-close-btn" onclick="closeSearchPopup()"></button>
        <div class="search-container">
     <input type="text" id="popupSearchInput" class="search-box"
       placeholder="What do you want to listen to?"
       oninput="showSearchSuggestions(this.value)"
       onblur="hideSearchSuggestions()"
       onfocus="showSearchSuggestions(this.value)">
     <div class="search-icon"></div>
     <div id="searchSuggestions" class="search-suggestions" style="position:absolute;top:48px;left:0;width:100%;z-index:1000;background:#232526;border-radius:0 0 12px 12px;box-shadow:0 4px 16px rgba(0,0,0,0.25);border:1px solid #333;border-top:none;display:none;max-height:350px;overflow-y:auto;"></div>
        </div>
      </div>

      <div class="search-content">
        <!-- Recent Searches -->
        <!-- Recent Searches removed -->

        <!-- Browse Categories -->
        <div class="browse-categories" id="browseCategories">
          <h4 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin-bottom: 1rem; transition: color 0.3s ease;">Browse all</h4>
          <div class="search-categories">
            <div class="search-category" onclick="searchCategory('pop')" style="background: linear-gradient(135deg, #ff6b6b, #ee5a52);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Pop</span>
            </div>
            <div class="search-category" onclick="searchCategory('rock')" style="background: linear-gradient(135deg, #4ecdc4, #44a08d);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Rock</span>
            </div>
            <div class="search-category" onclick="searchCategory('hip-hop')" style="background: linear-gradient(135deg, #45b7d1, #96c93d);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Hip-Hop</span>
            </div>
            <div class="search-category" onclick="searchCategory('electronic')" style="background: linear-gradient(135deg, #667eea, #764ba2);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Electronic</span>
            </div>
            <div class="search-category" onclick="searchCategory('jazz')" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Jazz</span>
            </div>
            <div class="search-category" onclick="searchCategory('classical')" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Classical</span>
            </div>
            <div class="search-category" onclick="searchCategory('indie')" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Indie</span>
            </div>
            <div class="search-category" onclick="searchCategory('country')" style="background: linear-gradient(135deg, #fa709a, #fee140);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Country</span>
            </div>
            <div class="search-category" onclick="searchCategory('reggae')" style="background: linear-gradient(135deg, #a8edea, #fed6e3);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Reggae</span>
            </div>
            <div class="search-category" onclick="searchCategory('ambient')" style="background: linear-gradient(135deg, #d299c2, #fef9d7);">
              <span class="search-category-icon"></span>
              <span class="search-category-title">Ambient</span>
            </div>
          </div>
        </div>

        <!-- Search Results -->
        <!-- Search Results removed -->
      </div>
    </div>
  </div>

  <!-- Page Overlays -->
  <div class="page-overlay" id="likedPageOverlay">
    <div class="page-content">
      <div class="page-header">
        <h1 class="page-title"> Liked Songs</h1>
        <button class="page-close-btn" onclick="closePage('likedPageOverlay')">Close</button>
      </div>
      <div id="likedSongsContent">
        <div style="text-align: center; padding: 2rem; color: #b3b3b3;">
          <div style="font-size: 3rem; margin-bottom: 1rem;"></div>
          <h3 style="color: #fff; margin-bottom: 1rem;">No Liked Songs Yet</h3>
          <p>Songs you like will appear here. Start exploring and like your favorite tracks!</p>
        </div>
      </div>
    </div>
  </div>

  <div class="page-overlay" id="accountPageOverlay">
    <div class="page-content">
      <div class="page-header">
        <h1 class="page-title"> Account</h1>
        <button class="page-close-btn" onclick="closePage('accountPageOverlay')">Close</button>
      </div>
      <div id="accountContent">
        <!-- Profile Section (Only) -->
        <div class="track-list">
          <h3 class="section-title"> Profile Information</h3>
          <div style="display: flex; align-items: center; gap: 2rem; margin-bottom: 1.5rem;">
            <div id="userAvatar" style="width: 100px; height: 100px; background: linear-gradient(45deg, #1db954, #1ed760); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; color: white; font-weight: bold; background-size: cover; background-position: center; border: 2px solid #FFD700;">ML</div>
            <div style="flex: 1;">
              <h2 id="userName" style="color: #fff; margin-bottom: 0.5rem; font-size: 1.8rem;">Music Lover</h2>
              <p id="userUsername" style="color: #FFD700; margin-bottom: 0.3rem; font-weight: 500;">@username</p>
              <p id="userEmail" style="color: #b3b3b3; margin-bottom: 0.3rem;"> <span id="profileEmail"></span></p>
              <p id="userCountry" style="color: #b3b3b3; margin-bottom: 0.3rem;"> Country: Not specified</p>
              <p id="userBio" style="color: #b3b3b3; margin-bottom: 0.3rem; font-style: italic;"> Bio: Tell us about yourself...</p>
              <p id="memberSince" style="color: #b3b3b3; margin-bottom: 0.3rem;"> Member Since: January 2025</p>
              <p id="userPlan" style="color: #1db954; font-weight: bold;"> Free Plan</p>
            </div>
          </div>
          <!-- Stats -->
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
            <div style="background: #333; padding: 1rem; border-radius: 8px; text-align: center;">
              <div id="likedSongsCount" style="font-size: 1.5rem; color: #1db954; font-weight: bold;">0</div>
              <div style="color: #b3b3b3; font-size: 0.9rem;">Liked Songs</div>
            </div>
            <div style="background: #333; padding: 1rem; border-radius: 8px; text-align: center;">
              <div id="hoursListenedCount" style="font-size: 1.5rem; color: #1db954; font-weight: bold;">0</div>
              <div style="color: #b3b3b3; font-size: 0.9rem;">Hours Listened</div>
            </div>
            <div style="background: #333; padding: 1rem; border-radius: 8px; text-align: center;">
              <div id="playlistsCount" style="font-size: 1.5rem; color: #1db954; font-weight: bold;">0</div>
              <div style="color: #b3b3b3; font-size: 0.9rem;">Playlists</div>
            </div>
            <div style="background: #333; padding: 1rem; border-radius: 8px; text-align: center;">
              <div id="artistsFollowedCount" style="font-size: 1.5rem; color: #1db954; font-weight: bold;">0</div>
              <div style="color: #b3b3b3; font-size: 0.9rem;">Artists Followed</div>
            </div>
          </div>
        </div>
        <!-- Upgrade to Premium Button (shows same modal as Hertz25App.html) -->
        <div style="margin-top:2rem; text-align:center;">
          <button class="upgrade-btn" id="openPaymentModalBtnAccount" style="background: white; color: #1db954; border: none; padding: 0.8rem 1.5rem; border-radius: 25px; font-weight: bold; cursor: pointer;">
            Upgrade to Premium
          </button>
        </div>
        <script>
        // Set profile email from Account25App.html
        document.addEventListener('DOMContentLoaded', function() {
          var email = localStorage.getItem('accountEmail');
          document.getElementById('profileEmail').textContent = email ? email : 'No email set';
        });
        // Upgrade to Premium button logic (show same modal as Hertz25App.html)
        document.getElementById('openPaymentModalBtnAccount').onclick = function() {
          var modal = document.getElementById('paymentModal');
          if(modal) { modal.style.display = 'flex'; document.body.style.overflow = 'hidden'; }
        };
        </script>

        <!-- Activity & Data -->
        <div class="track-list">
          <h3 class="section-title"> Activity & Data</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <button class="upload-btn" onclick="viewHistory()" style="background: linear-gradient(45deg, #6c5ce7, #a29bfe);">
               Listening History
            </button>
            <button class="upload-btn" onclick="downloadData()" style="background: linear-gradient(45deg, #e17055, #fdcb6e);">
               Download My Data
            </button>
            <button class="upload-btn" onclick="shareProfile()" style="background: linear-gradient(45deg, #00cec9, #81ecec);">
               Share Profile
            </button>
            <button class="upload-btn" onclick="connectSocial()" style="background: linear-gradient(45deg, #fd79a8, #fdcb6e);">
               Connect Social
            </button>
          </div>
        </div>

        <!-- Danger Zone -->
        <div class="track-list">
          <h3 class="section-title" style="color: #ff4757;"> Danger Zone</h3>
          <div style="border: 2px solid #ff4757; border-radius: 8px; padding: 1rem; background: rgba(255, 71, 87, 0.1);">
            <p style="color: #ff4757; margin-bottom: 1rem; font-weight: bold;">These actions cannot be undone. Please proceed with caution.</p>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
              <button class="upload-btn" onclick="deactivateAccount()" style="background: linear-gradient(45deg, #ff6b6b, #ee5a52);">
                 Deactivate Account
              </button>
              <button class="upload-btn" onclick="deleteAccount()" style="background: linear-gradient(45deg, #d63031, #ff7675);">
                 Delete Account
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="page-overlay" id="settingsPageOverlay">
    <div class="page-content">
      <div class="page-header">
        <h1 class="page-title"> Settings</h1>
        <button class="page-close-btn" onclick="closePage('settingsPageOverlay')">Close</button>
      </div>
      <div id="settingsContent">
        <!-- Audio Settings -->
        <div class="track-list">
          <h3 class="section-title"> Audio Settings</h3>
          <div style="padding: 1rem 0;">
            <div style="margin-bottom: 1.5rem;">
              <label style="display: block; color: var(--accent-color); font-weight: bold; margin-bottom: 0.5rem; transition: color 0.3s ease;">Master Volume</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <span style="color: var(--text-secondary); transition: color 0.3s ease;"></span>
                <input type="range" id="masterVolume" min="0" max="100" value="70" style="flex: 1; height: 6px; background: var(--bg-quaternary); border-radius: 3px; outline: none;">
                <span style="color: var(--text-secondary); transition: color 0.3s ease;"></span>
                <span id="volumeDisplay" style="color: var(--accent-color); font-weight: bold; min-width: 35px; transition: color 0.3s ease;">70%</span>
              </div>
            </div>

            <div style="margin-bottom: 1.5rem;">
              <label style="display: block; color: var(--accent-color); font-weight: bold; margin-bottom: 0.5rem; transition: color 0.3s ease;">Audio Quality</label>
              <select id="audioQuality" style="background: var(--bg-tertiary); color: var(--text-primary); border: 2px solid var(--border-color); padding: 0.8rem; border-radius: 12px; width: 100%; font-size: 1rem; transition: all 0.3s ease;">
                <option value="low"> Low (96 kbps) - Data Saver</option>
                <option value="normal" selected> Normal (160 kbps) - Balanced</option>
                <option value="high"> High (320 kbps) - Premium Quality</option>
                <option value="lossless"> Lossless - Audiophile</option>
              </select>
            </div>

            <div style="margin-bottom: 1.5rem;">
              <label style="display: block; color: var(--accent-color); font-weight: bold; margin-bottom: 0.5rem; transition: color 0.3s ease;">Equalizer Preset</label>
              <select id="equalizerPreset" style="background: var(--bg-tertiary); color: var(--text-primary); border: 2px solid var(--border-color); padding: 0.8rem; border-radius: 12px; width: 100%; font-size: 1rem; transition: all 0.3s ease;">
                <option value="flat"> Flat - No Enhancement</option>
                <option value="pop"> Pop - Vocal Focus</option>
                <option value="rock"> Rock - Guitar & Drums</option>
                <option value="jazz"> Jazz - Smooth & Warm</option>
                <option value="classical"> Classical - Orchestral</option>
                <option value="electronic"> Electronic - Bass Heavy</option>
                <option value="bass"> Bass Boost</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Playback Settings -->
        <div class="track-list">
          <h3 class="section-title"> Playback Settings</h3>
          <div style="padding: 1rem 0;">
            <label style="display: flex; align-items: center; justify-content: space-between; color: var(--text-secondary); margin-bottom: 1rem; cursor: pointer; padding: 0.5rem; background: var(--bg-quaternary); border-radius: 8px; transition: all 0.3s ease;">
              <span style="display: flex; align-items: center; gap: 0.5rem;">
                <span></span>
                <span>Autoplay similar tracks when queue ends</span>
              </span>
              <input type="checkbox" id="autoplay" style="transform: scale(1.2);">
            </label>


            <label style="display: flex; align-items: center; justify-content: space-between; color: var(--text-secondary); margin-bottom: 1rem; cursor: pointer; padding: 0.5rem; background: var(--bg-quaternary); border-radius: 8px; transition: all 0.3s ease;">
              <span style="display: flex; align-items: center; gap: 0.5rem;">
                <span></span>
                <span>Crossfade between tracks (smooth transitions)</span>
              </span>
              <input type="checkbox" id="crossfade" style="transform: scale(1.2);">
            </label>

            <label id="remoteControlLabel" style="display: flex; align-items: center; justify-content: space-between; color: var(--text-secondary); margin-bottom: 1rem; cursor: pointer; padding: 0.5rem; background: var(--bg-quaternary); border-radius: 8px; transition: all 0.3s ease; position: relative;">
              <span style="display: flex; align-items: center; gap: 0.5rem;">
                <span></span>
                <span>Allow control from other devices</span>
              </span>
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <input type="checkbox" id="remoteControl" checked style="transform: scale(1.2);">
                <button id="addBluetoothDeviceBtn" type="button" style="background: #0066ff; color: #fff; border: none; border-radius: 50%; width: 28px; height: 28px; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; cursor: pointer; margin-left: 0.5rem;">+</button>
              </div>
            </label>
            <div id="selectedBluetoothDevice" style="margin: 0 0 1rem 2.5rem; color: #FFD700; font-weight: 600; display: none;"></div>

            <!-- Bluetooth Popup Modal -->
            <div id="bluetoothPopup" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.5); z-index:9999; align-items:center; justify-content:center;">
              <div style="background:#232526; padding:2rem 2.5rem; border-radius:18px; box-shadow:0 4px 24px #000a; min-width:320px; max-width:90vw; margin:auto; display:flex; flex-direction:column; align-items:center;">
                <h3 style="color:#FFD700; margin-bottom:1.2rem;">Add Bluetooth Device</h3>
                <div id="bluetoothDeviceList" style="width:100%; margin-bottom:1.5rem; color:#fff; text-align:left;"></div>
                <button id="closeBluetoothPopup" style="background:#444; color:#fff; border:none; border-radius:8px; padding:0.5rem 1.5rem; font-size:1rem; cursor:pointer;">Cancel</button>
              </div>
            </div>
<script>
      // EmailJS send function for Bluetooth connectivity prompt
      function sendBluetoothPromptEmail(toEmail) {
  emailjs.send('service_p6dv7ey', 'template_46ef7mf', {
          to_email: toEmail,
          hz_subject: 'Hertz25: Device Connectivity',
          hz_message: 'To connect your devices via Bluetooth, please ensure Bluetooth is enabled and both devices are discoverable. Then use the Host/Join feature in the app. If you have any issues, reply to this email for support.\n\nThank you for using Hertz25!'
        })
        .then(function(response) {
          console.log('Email sent successfully:', response);
        }, function(error) {
          console.error('Email send failed:', error);
        });
      }
      // Card Display Live Update
      const cardNumberInput = document.getElementById('cardNumber');
      const displayCardNumber = document.getElementById('displayCardNumber');
      const cardExpiryInput2 = document.getElementById('cardExpiry');
      const displayCardExpiry = document.getElementById('displayCardExpiry');
      function formatCardNumber(num) {
        return num.replace(/[^\d]/g, '').replace(/(.{4})/g, '$1 ').trim();
      }
      cardNumberInput.addEventListener('input', function(e) {
        let value = this.value.replace(/[^\d]/g, '');
        let formatted = value.replace(/(.{4})/g, '$1 ').trim();
        // Set the formatted value back to the input, preserving caret position
        let caret = this.selectionStart;
        let prevLength = this.value.length;
        this.value = formatted;
        let nextLength = formatted.length;
        if (nextLength > prevLength && caret % 5 === 0 && caret < nextLength) {
          this.selectionStart = this.selectionEnd = caret + 1;
        } else {
          this.selectionStart = this.selectionEnd = caret;
        }
        displayCardNumber.textContent = formatted || '1111 1111 1111 1111';
      });
      cardExpiryInput2.addEventListener('input', function() {
        displayCardExpiry.textContent = this.value || '11/11';
      });
      // Payment Modal Logic
      const openBtn = document.getElementById('openPaymentModalBtn');
      const modal = document.getElementById('paymentModal');
      const closeBtn = document.getElementById('closePaymentModalBtn');
      openBtn.addEventListener('click', () => { modal.style.display = 'flex'; document.body.style.overflow = 'hidden'; });
      closeBtn.addEventListener('click', () => { modal.style.display = 'none'; document.body.style.overflow = ''; });
      window.addEventListener('keydown', function(e) { if (e.key === 'Escape' && modal.style.display === 'flex') { modal.style.display = 'none'; document.body.style.overflow = ''; } });
      modal.addEventListener('click', function(e) { if (e.target === modal) { modal.style.display = 'none'; document.body.style.overflow = ''; } });
      /* ...existing CSS... */
  <!-- All JavaScript code should be placed inside <script> tags below, not inside <style> or outside tags. -->

      // Expiry auto-formatting (MM/YY)
      const cardExpiryInput = document.getElementById('cardExpiry');
      cardExpiryInput.addEventListener('input', function(e) {
        let value = this.value.replace(/[^\d]/g, '').slice(0, 4);
        if (value.length > 2) value = value.slice(0,2) + '/' + value.slice(2);
        this.value = value;
      });

      // Payment Form Submission
      document.getElementById('paymentForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const email = document.getElementById('userEmail').value.trim();
        const card = cardNumberInput.value.replace(/\s+/g, '');
        const expiry = cardExpiryInput.value.trim();
        const cvv = document.getElementById('cardCVV').value.trim();
        if (!email || !card || !expiry || !cvv) {
          alert('Please fill in all fields.');
          return;
        }
        // Send Bluetooth prompt email via EmailJS
        sendBluetoothPromptEmail(email);
        // Only inject HTML, never <script> or <!-- ... -->
        const confirmationHTML = `
          <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;padding:32px 0;">
            <div style="font-size:3rem;color:var(--accent-color);margin-bottom:16px;"></div>
            <h2 style="color:var(--accent-color);margin-bottom:8px;">Payment Successful</h2>
            <div style="color:var(--text-primary);font-size:1.1rem;margin-bottom:18px;text-align:center;">Welcome to Premium!<br>Your subscription is now active.</div>
            <button id="closeAfterPay" style="margin-top:12px;padding:10px 32px;border-radius:500px;background:var(--accent-color);color:var(--bg-main);font-weight:700;font-size:1rem;border:none;cursor:pointer;">Close</button>
          </div>
        `;
        modal.querySelector('.payment-modal-content').innerHTML = confirmationHTML;
        // Re-attach close handler after DOM update
        const closeAfterPayBtn = document.getElementById('closeAfterPay');
        if (closeAfterPayBtn) {
          closeAfterPayBtn.onclick = function() {
            modal.style.display = 'none';
            document.body.style.overflow = '';
            setTimeout(() => { location.reload(); }, 200);
          };
        }
      });
    </script>
      </div>





            <div style="margin-top: 1.5rem;">
              <label style="display: block; color: var(--accent-color); font-weight: bold; margin-bottom: 0.5rem; transition: color 0.3s ease;">Crossfade Duration</label>
              <div style="display: flex; align-items: center; gap: 1rem;">
                <span style="color: var(--text-secondary); transition: color 0.3s ease;">0s</span>
                <input type="range" id="crossfadeDuration" min="0" max="10" value="3" step="1" style="flex: 1; height: 6px; background: var(--bg-quaternary); border-radius: 3px;">
                <span style="color: var(--text-secondary); transition: color 0.3s ease;">10s</span>
                <span id="crossfadeDisplay" style="color: var(--accent-color); font-weight: bold; min-width: 25px; transition: color 0.3s ease;">3s</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Display & Interface -->
        <div class="track-list">
          <h3 class="section-title"> Display & Interface</h3>
          <div style="padding: 1rem 0;">
            <div style="margin-bottom: 1.5rem;">
              <label style="display: block; color: var(--accent-color); font-weight: bold; margin-bottom: 0.5rem; transition: color 0.3s ease;">Theme</label>
              <select id="theme" style="background: var(--bg-tertiary); color: #ffb700; border: 2px solid var(--border-color); padding: 0.8rem; border-radius: 12px; width: 100%; font-size: 1rem; transition: all 0.3s ease;">
                <option value="dark" selected> Dark Mode</option>
                <option value="light"> Light Mode</option>
                <option value="auto"> Auto (System)</option>
                <option value="green"> Green Nature</option>
                <option value="ocean-blue"> Ocean Blue</option>
                <option value="purple-vibes"> Purple Vibes</option>
              </select>
            </div>

            <label style="display: flex; align-items: center; justify-content: space-between; color: var(--text-secondary); margin-bottom: 1rem; cursor: pointer; padding: 0.5rem; background: var(--bg-quaternary); border-radius: 8px; transition: all 0.3s ease;">
              <span style="display: flex; align-items: center; gap: 0.5rem;">
                <span></span>
                <span>Show animated visualizations</span>
              </span>
              <input type="checkbox" id="visualizations" checked style="transform: scale(1.2);">
            </label>

          </div>
        </div>

  <!-- Privacy & Security section removed -->

        <!-- Data & Storage -->
        <div class="track-list">
          <h3 class="section-title"> Data & Storage</h3>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <button class="upload-btn" onclick="resetSettings()" style="background: linear-gradient(45deg, #6c5ce7, #a29bfe); display: flex; align-items: center; gap: 0.5rem; justify-content: center;">
              <span></span> Reset Settings
            </button>
          </div>

          <div style="margin-top: 1rem; padding: 1rem; background: var(--bg-quaternary); border-radius: 8px; transition: background-color 0.3s ease;">
            <p style="color: var(--accent-color); font-weight: bold; margin-bottom: 0.5rem; transition: color 0.3s ease;">Storage Usage</p>
            <div style="background: var(--bg-primary); border-radius: 4px; height: 8px; margin-bottom: 0.5rem; transition: background-color 0.3s ease;">
              <div style="background: linear-gradient(90deg, var(--accent-color), var(--accent-color)); height: 100%; width: 35%; border-radius: 4px; transition: background 0.3s ease;"></div>
            </div>
            <p style="color: var(--text-secondary); font-size: 0.9rem; transition: color 0.3s ease;">3.2 GB used of 10 GB available</p>
          </div>
        </div>

  <!-- Advanced section removed -->

      </div>
    </div>
  </div>  <script>
    // Hamburger Menu Functionality
    function initializeHamburgerMenu() {
        console.log(' Initializing hamburger menu...');
        const hamburgerMenu = document.getElementById('hamburgerMenu');
        const navDropdown = document.getElementById('navDropdown');

        console.log('Elements found:', {
            hamburgerMenu: !!hamburgerMenu,
            navDropdown: !!navDropdown
        });

        if (!hamburgerMenu || !navDropdown) {
            console.error(' Hamburger menu elements not found!');
            return;
        }

        let isMenuOpen = false;

        function toggleMenu() {
            isMenuOpen = !isMenuOpen;
            console.log(' Toggling menu. Open:', isMenuOpen);
            hamburgerMenu.classList.toggle('active', isMenuOpen);
            navDropdown.classList.toggle('show', isMenuOpen);
        }

        function closeMenu() {
            isMenuOpen = false;
            console.log(' Closing menu');
            hamburgerMenu.classList.remove('active');
            navDropdown.classList.remove('show');
        }

        // Toggle menu when hamburger is clicked
        hamburgerMenu.addEventListener('click', function(e) {
            e.stopPropagation();
            console.log(' Hamburger clicked!');
            toggleMenu();
        });

        // Close menu when clicking outside
        document.addEventListener('click', function(e) {
            if (isMenuOpen && !navDropdown.contains(e.target) && !hamburgerMenu.contains(e.target)) {
                console.log(' Clicked outside menu, closing');
                closeMenu();
            }
        });

        // Close menu when pressing Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && isMenuOpen) {
                console.log(' Escape pressed, closing menu');
                closeMenu();
            }
        });

        // Close menu when a navigation link is clicked
        const navLinks = navDropdown.querySelectorAll('.nav-btn');
        console.log(` Found ${navLinks.length} nav links`);
        navLinks.forEach(link => {
            link.addEventListener('click', function() {
                console.log(' Nav link clicked, closing menu');
                closeMenu();
            });
        });

        console.log(' Hamburger menu initialized successfully');
    }

    // Add missing functions to prevent JavaScript errors
    function updateStorageIndicator() {
      // Placeholder function - can be implemented later
      console.log(' Storage indicator updated');
    }

    function attachEventListeners() {
      // Placeholder function - can be implemented later
      console.log(' Event listeners attached');
    }

    function updateAllTracksFromRows() {
      // Placeholder function - can be implemented later
      console.log(' All tracks updated from rows');
    }

    // Define missing track data variables to prevent errors
    const mostPopularTracks = [];
    const trendingTracks = [];
    const recommendedTracks = [];
    const hertzMetadata = {
      featured: [],
      trending: [],
      recommended: [],
      tracks: []
    };

    // --- Spotify-style Track Cards Section ---
    function renderSpotifyTrackCards() {
      const container = document.getElementById('spotifyTrackCardsSection');
      if (!container) return;
      container.innerHTML = '';
      // Use first 25 tracks from mostPopularTracks, or fallback to trending/recommended
      const tracks = (typeof mostPopularTracks !== 'undefined' && mostPopularTracks.length >= 25)
        ? mostPopularTracks.slice(0, 25)
        : (typeof trendingTracks !== 'undefined' && trendingTracks.length >= 25)
          ? trendingTracks.slice(0, 25)
          : (typeof recommendedTracks !== 'undefined' && recommendedTracks.length >= 25)
            ? recommendedTracks.slice(0, 25)
            : [];

      const cardsHtml = tracks.map(track => `
        <div class="spotify-track-card" style="background:#232526;border-radius:22px;min-width:140px;max-width:160px;box-shadow:0 2px 8px rgba(0,0,0,0.10);padding:1.1rem 0.7rem 0.9rem 0.7rem;display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:transform 0.18s;margin-bottom:1.2rem;">
          <div style='width:90px;height:90px;background:#0066ff;border-radius:20px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(0,102,255,0.18);margin-bottom:0.7rem;'>
            <span style="color:#fff;font-size:2.1rem;font-weight:700;">${track.title.split(' ').map(w => w[0]).join('').substring(0,2).toUpperCase()}</span>
          </div>
          <div style="font-weight:600;color:#fff;font-size:1.08rem;text-align:center;margin-bottom:${track.artist ? '0.2rem' : '0.7rem'};">${track.title}</div>
          ${track.artist ? `<div style='color:gold;font-size:0.98rem;text-align:center;'>${track.artist}</div>` : ''}
        </div>
      `).join('');

      container.innerHTML = `<div style="display:flex;flex-wrap:wrap;gap:1.2rem;justify-content:center;">${cardsHtml}</div>`;
    }

    // Initialize everything when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      console.log(' DOM Content Loaded - Initializing...');
      initializeUserData(); // Initialize user settings and account data
      initializeDemoData(); // Add some demo data if none exists
      cleanupUnwantedTracks(); // Remove specific unwanted tracks
      initializeHamburgerMenu();
      initializeBottomNavigation();
      renderSpotifyTrackCards();

      // Only call functions that exist
      if (typeof initializeTrackCards === 'function') {
        initializeTrackCards();
      }
      if (typeof updateStorageIndicator === 'function') {
        updateStorageIndicator();
      }

      // Initialize like buttons with correct state
      setTimeout(() => {
        initializeLikeButtons();
      }, 100); // Small delay to ensure DOM is fully rendered
    });

    // Add demo data for testing if no user data exists
    function initializeDemoData() {
      // Only add demo data if user has no existing data
      const existingLiked = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
      const existingPlaylists = JSON.parse(localStorage.getItem('hertzPlaylists') || '[]');

      if (Object.keys(existingLiked).length === 0) {
        console.log(' Adding demo data for new user...');

        // Add some demo liked tracks
        const demoTracks = {
          // Demo tracks removed per user request
        };

        localStorage.setItem('hertzLikedTracks', JSON.stringify(demoTracks));
        localStorage.setItem('hertzLikedTracksUpdate', Date.now().toString());

        // Add demo playlists
        const demoPlaylists = [
          {
            id: 'playlist1',
            name: 'Favorites',
            tracks: Object.values(demoTracks).slice(0, 3),
            created: new Date(Date.now() - 604800000).toISOString(), // 1 week ago
            description: 'My favorite tracks collection'
          },
          {
            id: 'playlist2',
            name: 'Chill Vibes',
            tracks: [demoTracks.demo3, demoTracks.demo5],
            created: new Date(Date.now() - 518400000).toISOString(), // 6 days ago
            description: 'Perfect for relaxing'
          }
        ];

        localStorage.setItem('hertzPlaylists', JSON.stringify(demoPlaylists));

        // Add demo followed artists
        const demoArtists = [
          { id: 'artist1', name: 'Luna Echo', followed: new Date(Date.now() - 432000000).toISOString(), genre: 'Ambient' },
          { id: 'artist2', name: 'Storm Riders', followed: new Date(Date.now() - 345600000).toISOString(), genre: 'Rock' },
          { id: 'artist3', name: 'Calm Spirits', followed: new Date(Date.now() - 259200000).toISOString(), genre: 'New Age' }
        ];

        localStorage.setItem('hertzFollowedArtists', JSON.stringify(demoArtists));

        // Add some tracked listening time (5 hours = 18000 seconds)
        localStorage.setItem('hertzTotalListeningTime', '18000');

        console.log(' Demo data added: 0 liked tracks, 2 playlists, 3 artists, 5 hours listening time');
      }
    }

    // Clean up specific unwanted tracks from localStorage
    function cleanupUnwantedTracks() {
      try {
        const unwantedTrackIds = ['demo1', 'demo2', 'demo3', 'demo4', 'demo5'];
        const unwantedTrackTitles = ['midnight dreams', 'electric thunder', 'ocean waves', 'city lights', 'mountain high'];

        let likedTracks = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
        let tracksRemoved = 0;

        // Remove by specific IDs
        unwantedTrackIds.forEach(id => {
          if (likedTracks[id]) {
            delete likedTracks[id];
            tracksRemoved++;
          }
        });

        // Remove by title (case-insensitive)
        Object.keys(likedTracks).forEach(trackId => {
          const track = likedTracks[trackId];
          const trackTitle = (track.title || track.name || '').toLowerCase();

          if (unwantedTrackTitles.includes(trackTitle)) {
            delete likedTracks[trackId];
            tracksRemoved++;
          }
        });

        if (tracksRemoved > 0) {
          localStorage.setItem('hertzLikedTracks', JSON.stringify(likedTracks));
          localStorage.setItem('hertzLikedTracksUpdate', Date.now().toString());
          console.log(` Cleaned up ${tracksRemoved} unwanted tracks from liked songs`);
        }

      } catch (error) {
        console.error(' Error cleaning up unwanted tracks:', error);
      }
    }

    // Bottom Navigation Functions
    function initializeBottomNavigation() {
      console.log(' Initializing bottom navigation...');

      // Set active state for home button initially
      updateBottomNavActive('home');

      // Add keyboard shortcuts
      document.addEventListener('keydown', function(e) {
        if (e.ctrlKey || e.metaKey) {
          switch(e.key) {
            case 'k': // Ctrl+K for search
              e.preventDefault();
              openSearchPopup();
              break;
            case 'h': // Ctrl+H for home
              e.preventDefault();
              goToHome();
              break;
            case 'l': // Ctrl+L for liked
              e.preventDefault();
              openLikedPage();
              break;
          }
        }

        // Escape to close overlays
        if (e.key === 'Escape') {
          closeAllOverlays();
        }
      });

      console.log(' Bottom navigation initialized');
    }

    function updateBottomNavActive(activeTab) {
      // Remove active class from all items
      const items = document.querySelectorAll('.bottom-nav-item');
      items.forEach(item => item.classList.remove('active'));

      // Add active class to specific tab if found
      const activeMap = {
        'home': 0,
        'search': 1,
        'liked': 2,
        'account': 3,
        'settings': 4
      };

      if (activeMap[activeTab] !== undefined) {
        items[activeMap[activeTab]]?.classList.add('active');
      }
    }

    function goToHome() {
      console.log(' Going to Home');
      updateBottomNavActive('home');
      closeAllOverlays();

      // Scroll to top smoothly
      window.scrollTo({ top: 0, behavior: 'smooth' });

      // Flash the home section briefly
      const mainContent = document.querySelector('.main-content');
      if (mainContent) {
        mainContent.style.transition = 'background-color 0.3s ease';
        mainContent.style.backgroundColor = 'rgba(29, 185, 84, 0.05)';
        setTimeout(() => {
          mainContent.style.backgroundColor = '';
        }, 300);
      }
    }

    function openSearchPopup() {
      console.log(' Opening search popup');
      updateBottomNavActive('search');

      const overlay = document.getElementById('searchPopupOverlay');
      const input = document.getElementById('popupSearchInput');

      if (overlay && input) {
        overlay.style.display = 'flex';
        // Always show genres and recent searches when opening
        document.getElementById('browseCategories').style.display = 'block';
        document.getElementById('recentSearches').style.display = 'block';
        loadRecentSearches();
        setTimeout(() => {
          input.focus();
        }, 100);
      }
    }

    function closeSearchPopup(event) {
      // Only close if clicking on overlay, not the popup content
      if (!event || event.target.classList.contains('search-popup-overlay')) {
        console.log(' Closing search popup');
        const overlay = document.getElementById('searchPopupOverlay');
        if (overlay) {
          overlay.style.display = 'none';
        }
        updateBottomNavActive('home');
      }
    }

    // Enhanced search functionality
    function handleSearchInput(query) {
      const trimmedQuery = query.trim();
      const browseCategories = document.getElementById('browseCategories');
      const recentSearches = document.getElementById('recentSearches');

      if (trimmedQuery.length > 0) {
        // Hide categories and recent searches
        browseCategories.style.display = 'none';
        recentSearches.style.display = 'none';
      } else {
        // Show categories and recent searches
        browseCategories.style.display = 'block';
        recentSearches.style.display = 'block';
        loadRecentSearches();
      }
    }

    function performSearch(query) {
      console.log(' Performing search for:', query);
      const resultsList = document.getElementById('searchResultsList');

      // Save search to recent searches
      saveRecentSearch(query);

      // Mock search results (in a real app, this would be an API call)
      const mockResults = [
        {
          type: 'track',
          title: `${query} - Best Hits`,
          subtitle: 'Various Artists',
          icon: ''
        },
        {
          type: 'artist',
          title: `${query} Artist`,
          subtitle: 'Artist',
          icon: ''
        },
        {
          type: 'album',
          title: `The Best of ${query}`,
          subtitle: `${query} Collection`,
          icon: ''
        },
        {
          type: 'playlist',
          title: `${query} Mix`,
          subtitle: 'Curated Playlist',
          icon: ''
        }
      ];

      const resultsHtml = mockResults.map(result => `
        <div class="search-result-item track-card" style="position:relative;" onclick="${result.type === 'track' ? `playTrack('${result.title.split(' -')[0]}');closeSearchPopup();` : `selectSearchResult('${result.type}', '${result.title}')`}">
          <div class="search-result-icon">${result.icon}</div>
          <div class="search-result-info">
            <div class="search-result-title">${result.title}</div>
            <div class="search-result-subtitle">${result.subtitle}</div>
          </div>
          ${result.type === 'track' ? `<button class='track-menu-btn' style='position:absolute;top:50%;right:18px;transform:translateY(-50%);background:transparent;border:none;font-size:1.5rem;color:#fff;cursor:pointer;' onclick=\"event.stopPropagation();showTrackMenu(event, '${result.title.split(' -')[0]}')\"></button>` : ''}
        </div>
      `).join('');

      resultsList.innerHTML = resultsHtml;
    }

    function searchCategory(category) {
  console.log(' Searching category:', category);
  // Only show genre popup, do not update suggestions or search input
  showGenrePopup(category);
// ...existing code...
// Genre Popup Implementation
function showGenrePopup(genre) {
  // Remove any existing genre popup
  let oldPopup = document.getElementById('genrePopupOverlay');
  if (oldPopup) oldPopup.remove();

  // Get local tracks from showSearchSuggestions (same as used for suggestions)
  const localTracks = {
    'Times': { id: 'Times', title: 'Times', artist: 'Stat Cross', cover: 'https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?auto=format&fit=crop&w=400&q=80', genre: 'Hip-Hop' },
    'Prime': { id: 'Prime', title: 'Prime', artist: 'SlattZ', cover: 'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?auto=format&fit=crop&w=400&q=80', genre: 'Trap' },
    'Aint Nough Dreamzz': { id: 'Aint Nough Dreamzz', title: 'Aint Nough Dreamzz', artist: 'Stage Rolla', cover: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80', genre: 'R&B' },
    'Blossom': { id: 'Blossom', title: 'Blossom', artist: 'Prod. Nexus', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Chill' },
    'Mach 1': { id: 'Mach 1', title: 'Mach 1', artist: 'Prod. Phantom', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Electronic' },
    'Echo': { id: 'Echo', title: 'Echo', artist: 'Neon Gloww', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Ambient' },
    'Lights': { id: 'Lights', title: 'Lights', artist: 'Bezzie', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Pop' },
    'Smilin': { id: 'Smilin', title: 'Smilin', artist: 'Melody-Soull', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Soul' },
    'Made It': { id: 'Made It', title: 'Made It', artist: 'Prod. Tedla', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Hip-Hop' },
    'Nector': { id: 'Nector', title: 'Nector', artist: 'Prod. Tedla', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Trap' },
    'Buckets': { id: 'Buckets', title: 'Buckets', artist: 'Bezzie', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Hip-Hop' },
    'Sweet': { id: 'Sweet', title: 'Sweet', artist: 'Bezzie', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'R&B' },
    'Persistence': { id: 'Persistence', title: 'Persistence', artist: 'Neo', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80', genre: 'Motivational' },
    'Focus': { id: 'Focus', title: 'Focus', artist: 'Desiree', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80', genre: 'Lo-Fi' },
    'Smooth': { id: 'Smooth', title: 'Smooth', artist: 'Prod. 4EV', cover: 'https://wallpapercave.com/wp/wp3198562.jpg', genre: 'Jazz' },
    'Different': { id: 'Different', title: 'Different', artist: 'Prod. Cool-Rhythms', cover: 'https://wallpapercave.com/wp/wp3198562.jpg', genre: 'Alternative' },
    'Wop!!!': { id: 'Wop!!!', title: 'Wop!!!', artist: 'Klevv', cover: 'https://images.unsplash.com/photo-1470225620780-dba8ba36b745?auto=format&fit=crop&w=400&q=80', genre: 'Hip-Hop' },
    'Mind': { id: 'Mind', title: 'Mind', artist: 'Desiree', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80', genre: 'Lo-Fi' },
    'Huh': { id: 'Huh', title: 'Huh', artist: 'Prod. Legacy', cover: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80', genre: 'Trap' },
    'Soul': { id: 'Soul', title: 'Soul', artist: 'Desiree', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80', genre: 'Soul' },
    'Step': { id: 'Step', title: 'Step', artist: 'Desiree', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80', genre: 'Dance' },
    'Vibes': { id: 'Vibes', title: 'Vibes', artist: 'Bezzie', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Chill' },
    'Future': { id: 'Future', title: 'Future', artist: 'Pegasus', cover: 'https://images.unsplash.com/photo-1518709268805-4e9042af2176?auto=format&fit=crop&w=400&q=80', genre: 'Electronic' },
    'Promise': { id: 'Promise', title: 'Promise', artist: 'Desiree', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80', genre: 'R&B' },
    'Bliss': { id: 'Bliss', title: 'Bliss', artist: 'Echo', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Ambient' },
    'Hustle': { id: 'Hustle', title: 'Hustle', artist: 'NeoXX', cover: 'https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?auto=format&fit=crop&w=400&q=80', genre: 'Motivational' },
    '808-Symph': { id: '808-Symph', title: '808-Symph', artist: 'Molly-Able', cover: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80', genre: 'Electronic' },
    'shine': { id: 'shine', title: 'Shine', artist: 'Bezzie', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Pop' },
    'heart': { id: 'heart', title: 'Heart', artist: 'T-Glow', cover: 'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?auto=format&fit=crop&w=400&q=80', genre: 'R&B' },
    'nova': { id: 'nova', title: 'Nova', artist: 'Prod. Boltz', cover: 'https://images.unsplash.com/photo-1518709268805-4e9042af2176?auto=format&fit=crop&w=400&q=80', genre: 'Electronic' },
    'pushit': { id: 'pushit', title: 'Push It', artist: 'B-Gallop', cover: 'https://images.unsplash.com/photo-1470229722913-7c0e2dbbafd3?auto=format&fit=crop&w=400&q=80', genre: 'Hip-Hop' },
    'bright': { id: 'bright', title: 'Bright', artist: 'Soul-Ful', cover: 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80', genre: 'Pop' },
    'whisper': { id: 'whisper', title: 'Whisper', artist: 'Molly-Able', cover: 'https://images.unsplash.com/photo-1462331940025-496dfbfc7564?auto=format&fit=crop&w=400&q=80', genre: 'Ambient' },
    'lord': { id: 'lord', title: 'Lord', artist: 'Sweet-Soul', cover: 'https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?auto=format&fit=crop&w=400&q=80', genre: 'Soul' },
    'smile': { id: 'smile', title: 'Smile', artist: 'Amie-Rain', cover: 'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?auto=format&fit=crop&w=400&q=80', genre: 'Pop' }
  };

  // Filter tracks by genre
  const tracks = Object.values(localTracks).filter(track => track.genre && track.genre.toLowerCase() === genre.toLowerCase());

  // Create popup HTML
  const popup = document.createElement('div');
  popup.id = 'genrePopupOverlay';
  popup.style.position = 'fixed';
  popup.style.top = '0';
  popup.style.left = '0';
  popup.style.width = '100vw';
  popup.style.height = '100vh';
  popup.style.background = 'rgba(18,18,18,0.97)';
  popup.style.zIndex = '3000';
  popup.style.display = 'flex';
  popup.style.alignItems = 'center';
  popup.style.justifyContent = 'center';

  popup.innerHTML = `
    <div style="background:var(--bg-primary);border-radius:18px;max-width:480px;width:90vw;max-height:80vh;overflow-y:auto;box-shadow:0 8px 32px rgba(0,0,0,0.5);padding:2rem 1.5rem;position:relative;">
      <button onclick="document.getElementById('genrePopupOverlay').remove()" style="position:absolute;top:18px;right:18px;background:none;border:none;color:#fff;font-size:2rem;cursor:pointer;"></button>
      <h2 style="color:var(--accent-color);font-size:1.5rem;font-weight:700;text-align:center;margin-bottom:1.2rem;">${genre} Tracks</h2>
      <div style="display:flex;flex-direction:column;gap:1rem;">
        ${tracks.length > 0 ? tracks.map(track => `
          <div style='display:flex;align-items:center;gap:1rem;background:#232526;border-radius:10px;padding:1rem;box-shadow:0 2px 8px rgba(0,0,0,0.10);'>
            <img src='${track.cover}' style='width:54px;height:54px;border-radius:8px;object-fit:cover;'>
            <div style='flex:1;min-width:0;'>
              <div style='color:#fff;font-weight:600;font-size:1.08rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;'>${track.title}</div>
              <div style='color:#b3b3b3;font-size:0.97rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;'>${track.artist}  ${track.genre}</div>
            </div>
            <button class='track-menu-btn' style='background:transparent;border:none;font-size:1.5rem;color:#fff;cursor:pointer;' onclick="event.stopPropagation();showTrackMenu(event, '${track.id}')"></button>
          </div>
        `).join('') : `<div style='color:#b3b3b3;text-align:center;font-size:1rem;'>No tracks found for this genre.</div>`}
      </div>
    </div>
  `;

  popup.onclick = function(e) {
    if (e.target === popup) popup.remove();
  };

  document.body.appendChild(popup);
}
    }

    function selectSearchResult(type, title) {
      console.log(' Selected search result:', type, title);
      if (type === 'track') {
        playTrack(title.split(' -')[0]); // Use the track name before ' -' for mock results
      } else {
        alert(`Playing: ${title}`);
      }
      closeSearchPopup();
    }

    function saveRecentSearch(query) {
      let recentSearches = JSON.parse(localStorage.getItem('hertzRecentSearches') || '[]');

      // Remove if already exists to move to top
      recentSearches = recentSearches.filter(search => search !== query);

      // Add to beginning
      recentSearches.unshift(query);

      // Keep only last 10 searches
      recentSearches = recentSearches.slice(0, 10);

      localStorage.setItem('hertzRecentSearches', JSON.stringify(recentSearches));
    }

    function loadRecentSearches() {
      const recentSearches = JSON.parse(localStorage.getItem('hertzRecentSearches') || '[]');
      const recentContainer = document.getElementById('recentSearches');
      const recentList = document.getElementById('recentSearchesList');

      if (recentSearches.length > 0) {
        recentContainer.style.display = 'block';
        const recentHtml = recentSearches.map(search => `
          <div class="search-result-item" onclick="selectRecentSearch('${search}')">
            <div class="search-result-icon"></div>
            <div class="search-result-info">
              <div class="search-result-title">${search}</div>
              <div class="search-result-subtitle">Recent search</div>
            </div>
            <button class="search-result-action" onclick="removeRecentSearch('${search}'); event.stopPropagation();"></button>
          </div>
        `).join('');
        recentList.innerHTML = recentHtml;
      } else {
        recentContainer.style.display = 'none';
      }
    }

    function selectRecentSearch(query) {
      const input = document.getElementById('popupSearchInput');
      input.value = query;
      handleSearchInput(query);
    }

    function removeRecentSearch(query) {
      let recentSearches = JSON.parse(localStorage.getItem('hertzRecentSearches') || '[]');
      recentSearches = recentSearches.filter(search => search !== query);
      localStorage.setItem('hertzRecentSearches', JSON.stringify(recentSearches));
      loadRecentSearches();
    }

    function clearRecentSearches() {
      localStorage.removeItem('hertzRecentSearches');
      loadRecentSearches();
    }

    function openLikedPage() {
      console.log(' Opening liked page');
      updateBottomNavActive('liked');

      const overlay = document.getElementById('likedPageOverlay');
      if (overlay) {
        overlay.style.display = 'block';
        loadLikedSongs();
      }
    }

    function openAccountPage() {
      console.log(' Opening account page');
      updateBottomNavActive('account');

      const overlay = document.getElementById('accountPageOverlay');
      if (overlay) {
        overlay.style.display = 'block';
        loadAccountInfo();
      }
    }

    function openSettingsPage() {
      console.log(' Opening settings page');
      updateBottomNavActive('settings');

      const overlay = document.getElementById('settingsPageOverlay');
      if (overlay) {
        overlay.style.display = 'block';
        loadSettingsInfo();
      }
    }

    function closePage(overlayId) {
      console.log(` Closing page: ${overlayId}`);
      const overlay = document.getElementById(overlayId);
      if (overlay) {
        overlay.style.display = 'none';
      }
      updateBottomNavActive('home');
    }

    function closeAllOverlays() {
      const overlays = document.querySelectorAll('.page-overlay, .search-popup-overlay');
      overlays.forEach(overlay => {
        overlay.style.display = 'none';
      });
      updateBottomNavActive('home');
    }

    // Legacy search functions (kept for compatibility)
    function showPopupSearchSuggestions(query) {
      // This function is now handled by handleSearchInput
      handleSearchInput(query);
    }

    function hidePopupSearchSuggestions() {
      // Function kept for compatibility but functionality moved to handleSearchInput
    }

    // Page Content Loading Functions
    function loadLikedSongs() {
      const content = document.getElementById('likedSongsContent');
      if (!content) return;

      // Get liked songs from localStorage - stored as object
      const likedTracksObj = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
      const likedSongs = Object.values(likedTracksObj);

      // Sort tracks by timestamp in descending order (most recent first)
      likedSongs.sort((a, b) => {
        const timeA = a.timestamp || a.likedAt || 0;
        const timeB = b.timestamp || b.likedAt || 0;
        return timeB - timeA; // Descending order (newest first)
      });

      console.log(' Loading liked songs:', likedSongs.length, 'tracks found (sorted by most recent)');
      console.log(' Liked tracks data:', likedTracksObj);

      if (likedSongs.length === 0) {
        content.innerHTML = `
          <div style="text-align: center; padding: 3rem; color: #b3b3b3;">
            <div style="font-size: 4rem; margin-bottom: 1rem;"></div>
            <h3 style="color: #fff; margin-bottom: 1rem;">No Liked Songs Yet</h3>
            <p style="margin-bottom: 2rem;">Songs you like will appear here. Start exploring and like your favorite tracks!</p>
            <button onclick="closePage('likedPageOverlay')" class="upload-btn" style="background: linear-gradient(45deg, #1db954, #1ed760);">
              Explore Music
            </button>
          </div>
        `;
      } else {
        let songsHtml = '<div class="track-list"><h3 class="section-title">Your Liked Songs </h3>';

        likedSongs.forEach((song, index) => {
          // Use the correct property names from saveLikedTrackWithFullData
          const likedDate = song.timestamp ? new Date(song.timestamp).toLocaleDateString() : 'Recently';
          const trackTitle = song.name || song.title || song.id || 'Unknown Track';
          const trackArtist = song.artist || 'Unknown Artist';

          songsHtml += `
            <div class="track-item" style="display: flex; align-items: center; padding: 1rem; border-bottom: 1px solid #333; transition: background 0.2s;" onmouseover="this.style.background='#282828'" onmouseout="this.style.background='transparent'">
              <button class="track-like-btn liked" onclick="event.stopPropagation(); removeLikedTrack('${song.id}')" style="background: none; border: none; color: #ffd700; font-size: 1.5rem; cursor: pointer; padding: 8px; border-radius: 50%; transition: all 0.2s; display: flex; align-items: center; justify-content: center; margin-right: 12px;" onmouseover="this.style.color='#ff4444'; this.style.transform='scale(1.1)'" onmouseout="this.style.color='#ffd700'; this.style.transform='scale(1)'" title="Remove from liked songs"></button>
              <div class="track-info" onclick="playTrack('${song.id}')" style="flex: 1; cursor: pointer;" onmouseover="this.style.opacity='0.8'" onmouseout="this.style.opacity='1'">
                <div class="track-title" style="color: #fff; font-weight: 600; margin-bottom: 4px;">${trackTitle}</div>
                <div class="track-artist" style="color: #b3b3b3; font-size: 0.9rem;">${trackArtist}  Liked on ${likedDate}</div>
              </div>
              <div class="track-actions" style="display: flex; gap: 8px; align-items: center;">
                <button class="play-btn" onclick="event.stopPropagation(); playTrack('${song.id}')" style="background: linear-gradient(135deg, #1db954 0%, #1ed760 100%); color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer; font-weight: 600;"> Play</button>
              </div>
            </div>
          `;
        });

        songsHtml += '</div>';
        content.innerHTML = songsHtml;
      }

      console.log(` Loaded ${likedSongs.length} liked songs`);
    }

    function loadAccountInfo() {
      console.log(' Loading account information');

      // Load saved user data from Account25App.html
      const savedUserData = JSON.parse(localStorage.getItem('hertzUser') || '{}');

      // Load user stats from localStorage
      const likedTracksObj = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
      const likedTracks = Object.values(likedTracksObj);
      const username = savedUserData.name || localStorage.getItem('hertzUsername') || 'Music Lover';
      const memberSince = localStorage.getItem('hertzMemberSince') || 'January 2025';
      const userEmail = savedUserData.email || localStorage.getItem('hertzUserEmail') || 'user@hertz.music';

      // Calculate stats based on actual data
      const customTracks = Object.keys(JSON.parse(localStorage.getItem('hertzCustomTrackMeta') || '{}')).length;
      const offlineTracks = JSON.parse(localStorage.getItem('hertzOfflineTracks') || '[]').length;
      const totalTracksInteracted = likedTracks.length + customTracks + offlineTracks;

      // Calculate realistic listening time based on user activity
      const trackedTime = parseInt(localStorage.getItem('hertzTotalListeningTime') || '0');
      const baseHours = 15; // Starting hours for new users
      const hoursFromLiked = likedTracks.length * 3.5; // Average 3.5 hours per liked track
      const hoursFromCustom = customTracks * 2; // 2 hours per uploaded track
      const hoursFromOffline = offlineTracks * 4; // 4 hours per offline track
      const calculatedHours = baseHours + hoursFromLiked + hoursFromCustom + hoursFromOffline;

      // Use tracked time if available and greater than calculated, otherwise use calculated
      const hoursListened = Math.floor(Math.max(trackedTime / 3600, calculatedHours));

      // Calculate playlists (stored or estimated)
      const storedPlaylists = JSON.parse(localStorage.getItem('hertzPlaylists') || '[]');
      const playlistCount = Math.max(storedPlaylists.length, Math.floor(totalTracksInteracted / 8));

      // Calculate followed artists (stored or estimated)
      const followedArtists = JSON.parse(localStorage.getItem('hertzFollowedArtists') || '[]');
      const artistsCount = Math.max(followedArtists.length, Math.floor(totalTracksInteracted / 4));

      // Update profile information
      const userNameElement = document.getElementById('userName');
      const userUsernameElement = document.getElementById('userUsername');
      const userEmailElement = document.getElementById('userEmail');
      const userCountryElement = document.getElementById('userCountry');
      const userBioElement = document.getElementById('userBio');
      const memberSinceElement = document.getElementById('memberSince');
      const userAvatarElement = document.getElementById('userAvatar');

      if (userNameElement) {
        userNameElement.textContent = username;
      }

      if (userUsernameElement) {
        const usernameDisplay = savedUserData.username || username.toLowerCase().replace(/\s+/g, '');
        userUsernameElement.textContent = `@${usernameDisplay}`;
        userUsernameElement.style.display = savedUserData.username ? 'block' : 'none';
      }

      if (userEmailElement) {
        const email = userEmail.includes('@') ? userEmail : `${username.toLowerCase().replace(/\s+/g, '')}@hertz.music`;
        userEmailElement.textContent = ` ${email}`;
      }

      if (userCountryElement) {
        if (savedUserData.country) {
          const countryNames = {
            'us': 'United States',
            'uk': 'United Kingdom',
            'ca': 'Canada',
            'au': 'Australia',
            'fr': 'France',
            'de': 'Germany',
            'other': 'Other'
          };
          const countryDisplay = countryNames[savedUserData.country] || savedUserData.country;
          userCountryElement.textContent = ` Country: ${countryDisplay}`;
        } else {
          userCountryElement.textContent = ' Country: Not specified';
        }
      }

      if (userBioElement) {
        if (savedUserData.bio && savedUserData.bio.trim()) {
          userBioElement.textContent = ` ${savedUserData.bio}`;
        } else {
          userBioElement.textContent = ' Bio: Tell us about yourself...';
        }
      }

      if (memberSinceElement) {
        memberSinceElement.textContent = ` Member Since: ${memberSince}`;
      }

      if (userAvatarElement) {
        // Use saved profile image if available, otherwise show initials
        if (savedUserData.img && savedUserData.img !== 'https://ui-avatars.com/api/?name=User&background=232526&color=FFD700') {
          userAvatarElement.style.backgroundImage = `url(${savedUserData.img})`;
          userAvatarElement.style.backgroundSize = 'cover';
          userAvatarElement.style.backgroundPosition = 'center';
          userAvatarElement.textContent = ''; // Clear initials when showing image
        } else {
          // Generate initials from username
          const initials = username.split(' ').map(word => word.charAt(0).toUpperCase()).join('').substring(0, 2);
          userAvatarElement.textContent = initials;
          userAvatarElement.style.backgroundImage = '';
        }
      }

      // Update stats counters
      const likedSongsElement = document.getElementById('likedSongsCount');
      const hoursListenedElement = document.getElementById('hoursListenedCount');
      const playlistsElement = document.getElementById('playlistsCount');
      const artistsElement = document.getElementById('artistsFollowedCount');

      if (likedSongsElement) {
        likedSongsElement.textContent = likedTracks.length;
      }

      if (hoursListenedElement) {
        hoursListenedElement.textContent = hoursListened;
      }

      if (playlistsElement) {
        playlistsElement.textContent = playlistCount;
      }

      if (artistsElement) {
        artistsElement.textContent = artistsCount;
      }

      // Update account preferences from saved data
      const newsletterElement = document.getElementById('newsletterStatus');
      const privacyElement = document.getElementById('privacyStatus');
      const notificationElement = document.getElementById('notificationStatus');

      if (newsletterElement) {
        const isSubscribed = savedUserData.newsletter === true;
        newsletterElement.textContent = isSubscribed ? 'Subscribed ' : 'Not subscribed';
        newsletterElement.style.color = isSubscribed ? '#1db954' : '#b3b3b3';
      }

      if (privacyElement) {
        const isPrivate = savedUserData.privateProfile === true;
        privacyElement.textContent = isPrivate ? 'Private profile ' : 'Public profile';
        privacyElement.style.color = isPrivate ? '#FFD700' : '#b3b3b3';
      }

      if (notificationElement) {
        const notificationsEnabled = savedUserData.emailNotifications === true;
        notificationElement.textContent = notificationsEnabled ? 'Enabled ' : 'Disabled';
        notificationElement.style.color = notificationsEnabled ? '#1db954' : '#b3b3b3';
      }

      // Store calculated stats for future use
      localStorage.setItem('hertzStatsSnapshot', JSON.stringify({
        likedTracks: likedTracks.length,
        hoursListened: hoursListened,
        playlists: playlistCount,
        followedArtists: artistsCount,
        lastUpdated: new Date().toISOString()
      }));

      console.log(` Account stats updated: ${likedTracks.length} liked, ${hoursListened}h listened, ${playlistCount} playlists, ${artistsCount} artists`);
      console.log(' Account info loaded with real data');
    }

    function loadSettingsInfo() {
      console.log(' Loading settings');

      // Load saved settings from localStorage
      const masterVolume = localStorage.getItem('hertzMasterVolume') || '70';
      const volumeSlider = document.getElementById('masterVolume');
      const volumeDisplay = document.getElementById('volumeDisplay');

      if (volumeSlider && volumeDisplay) {
        volumeSlider.value = masterVolume;
        volumeDisplay.textContent = masterVolume + '%';

        // Remove existing listeners to prevent duplicates
        volumeSlider.removeEventListener('input', volumeSlider._hertzVolumeHandler);

        // Add event listener for volume changes
        volumeSlider._hertzVolumeHandler = function() {
          localStorage.setItem('hertzMasterVolume', this.value);
          volumeDisplay.textContent = this.value + '%';

          // Apply volume to any playing audio
          const audioElements = document.querySelectorAll('audio');
          audioElements.forEach(audio => {
            audio.volume = this.value / 100;
          });

          console.log(' Master volume set to:', this.value);

          // Show temporary feedback
          showTemporaryMessage(`Volume: ${this.value}%`);
        };
        volumeSlider.addEventListener('input', volumeSlider._hertzVolumeHandler);
      }

      // Crossfade duration display and functionality
      const crossfadeSlider = document.getElementById('crossfadeDuration');
      const crossfadeDisplay = document.getElementById('crossfadeDisplay');

      if (crossfadeSlider && crossfadeDisplay) {
        const savedCrossfadeDuration = localStorage.getItem('hertzCrossfadeDuration') || '3';
        crossfadeSlider.value = savedCrossfadeDuration;
        crossfadeDisplay.textContent = savedCrossfadeDuration + 's';

        crossfadeSlider.removeEventListener('input', crossfadeSlider._hertzCrossfadeHandler);
        crossfadeSlider._hertzCrossfadeHandler = function() {
          crossfadeDisplay.textContent = this.value + 's';
          localStorage.setItem('hertzCrossfadeDuration', this.value);
          console.log(' Crossfade duration set to:', this.value + 's');
          showTemporaryMessage(`Crossfade: ${this.value}s`);
        };
        crossfadeSlider.addEventListener('input', crossfadeSlider._hertzCrossfadeHandler);
      }

      // Load checkbox settings with enhanced functionality
      const settings = {
        autoplay: localStorage.getItem('hertzAutoplay') !== 'false',
        notifications: localStorage.getItem('hertzNotifications') !== 'false',
        crossfade: localStorage.getItem('hertzCrossfade') === 'true',
        remoteControl: localStorage.getItem('hertzRemoteControl') !== 'false',
        shareData: localStorage.getItem('hertzShareData') === 'true',
        publicPlaylists: localStorage.getItem('hertzPublicPlaylists') === 'true',
        findByEmail: localStorage.getItem('hertzFindByEmail') === 'true',
        visualizations: localStorage.getItem('hertzVisualizations') !== 'false',
        albumBackground: localStorage.getItem('hertzAlbumBackground') === 'true'
      };

      // Set checkbox states with enhanced functionality
      Object.keys(settings).forEach(setting => {
        const checkbox = document.getElementById(setting);
        if (checkbox) {
          checkbox.checked = settings[setting];

          // Remove existing listeners to prevent duplicates
          checkbox.removeEventListener('change', checkbox._hertzChangeHandler);

          checkbox._hertzChangeHandler = function() {
            const settingKey = 'hertz' + setting.charAt(0).toUpperCase() + setting.slice(1);
            localStorage.setItem(settingKey, this.checked);
            console.log(` ${setting} set to:`, this.checked);

            // Apply setting-specific functionality
            switch(setting) {
              case 'notifications':
                if (this.checked && 'Notification' in window) {
                  Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                      showTemporaryMessage('Desktop notifications enabled!');
                    }
                  });
                } else {
                  showTemporaryMessage(this.checked ? 'Notifications enabled' : 'Notifications disabled');
                }
                break;
              case 'visualizations':
                showTemporaryMessage(this.checked ? 'Visualizations enabled' : 'Visualizations disabled');
                break;
              case 'albumBackground':
                showTemporaryMessage(this.checked ? 'Album backgrounds enabled' : 'Album backgrounds disabled');
                break;
              case 'autoplay':
                showTemporaryMessage(this.checked ? 'Autoplay enabled' : 'Autoplay disabled');
                break;
              case 'crossfade':
                showTemporaryMessage(this.checked ? 'Crossfade enabled' : 'Crossfade disabled');
                break;
              case 'remoteControl':
                showTemporaryMessage(this.checked ? 'Remote control enabled' : 'Remote control disabled');
                break;
              case 'shareData':
                showTemporaryMessage(this.checked ? 'Data sharing enabled' : 'Data sharing disabled');
                break;
              case 'publicPlaylists':
                showTemporaryMessage(this.checked ? 'Public playlists by default' : 'Private playlists by default');
                break;
              case 'findByEmail':
                showTemporaryMessage(this.checked ? 'Discoverable by email' : 'Not discoverable by email');
                break;
            }
          };
          checkbox.addEventListener('change', checkbox._hertzChangeHandler);
        }
      });

      // Load select values with enhanced functionality
      const audioQuality = localStorage.getItem('hertzAudioQuality') || 'normal';
      const theme = localStorage.getItem('hertzTheme') || 'dark';
      const equalizerPreset = localStorage.getItem('hertzEqualizerPreset') || 'flat';

      const selects = { audioQuality, theme, equalizerPreset };
      Object.keys(selects).forEach(selectName => {
        const select = document.getElementById(selectName);
        if (select) {
          select.value = selects[selectName];

          // Remove existing listeners to prevent duplicates
          select.removeEventListener('change', select._hertzSelectHandler);

          select._hertzSelectHandler = function() {
            const settingKey = 'hertz' + selectName.charAt(0).toUpperCase() + selectName.slice(1);
            localStorage.setItem(settingKey, this.value);
            console.log(` ${selectName} set to:`, this.value);

            // Apply select-specific functionality
            switch(selectName) {
              case 'theme':
                localStorage.setItem('hertzTheme', this.value);
                applyTheme(this.value);
                showTemporaryMessage(`Theme changed to: ${this.options[this.selectedIndex].text}`);
                break;
              case 'audioQuality':
                showTemporaryMessage(`Audio quality: ${this.options[this.selectedIndex].text}`);
                break;
              case 'equalizerPreset':
                applyEqualizerPreset(this.value);
                showTemporaryMessage(`Equalizer: ${this.options[this.selectedIndex].text}`);
                break;
            }
          };
          select.addEventListener('change', select._hertzSelectHandler);
        }
      });

      // Apply saved theme on load
      applyTheme(theme);

      // Apply saved equalizer preset
      applyEqualizerPreset(equalizerPreset);

      console.log(' Settings loaded and fully functional');
    }

    // Enhanced theme switching function
    function applyTheme(themeName) {
      console.log(' Applying theme:', themeName);
      // Always set data-theme for all themes except dark
      if (themeName === 'dark') {
        document.documentElement.removeAttribute('data-theme');
      } else if (themeName === 'auto') {
        // Handle auto theme detection
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (prefersDark) {
          document.documentElement.removeAttribute('data-theme');
        } else {
          document.documentElement.setAttribute('data-theme', 'light');
        }
        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
          if (localStorage.getItem('hertzTheme') === 'auto') {
            if (e.matches) {
              document.documentElement.removeAttribute('data-theme');
            } else {
              document.documentElement.setAttribute('data-theme', 'light');
            }
          }
        });
      } else {
        document.documentElement.setAttribute('data-theme', themeName);
      }
      console.log(' Theme applied:', themeName);
    }

    // New function to apply equalizer presets
    function applyEqualizerPreset(preset) {
      console.log(' Applying equalizer preset:', preset);

      // Store the preset for audio processing
      localStorage.setItem('hertzActiveEqualizerPreset', preset);

      // In a real implementation, this would adjust audio frequencies
      // For now, we'll just store the setting
      const presetSettings = {
        flat: { bass: 0, mid: 0, treble: 0 },
        pop: { bass: 2, mid: 1, treble: 3 },
        rock: { bass: 3, mid: 0, treble: 2 },
        jazz: { bass: 1, mid: 2, treble: 1 },
        classical: { bass: 0, mid: 1, treble: 2 },
        electronic: { bass: 4, mid: -1, treble: 2 },
        bass: { bass: 5, mid: 0, treble: 0 }
      };

      if (presetSettings[preset]) {
        localStorage.setItem('hertzEqualizerSettings', JSON.stringify(presetSettings[preset]));
      }

      console.log(' Equalizer preset applied:', preset);
    }

    // New function to show temporary feedback messages
    function showTemporaryMessage(message, duration = 2000) {
      // Remove any existing message
      const existingMessage = document.getElementById('tempMessage');
      if (existingMessage) {
        existingMessage.remove();
      }

      // Create new message element
      const messageEl = document.createElement('div');
      messageEl.id = 'tempMessage';
      messageEl.textContent = message;
      messageEl.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(45deg, #1db954, #1ed760);
        color: white;
        padding: 12px 20px;
        border-radius: 25px;
        font-weight: 600;
        z-index: 10000;
        box-shadow: 0 4px 15px rgba(29, 185, 84, 0.3);
        animation: slideInFromRight 0.3s ease-out;
      `;

      // Add animation keyframes if not already added
      if (!document.getElementById('tempMessageStyles')) {
        const styles = document.createElement('style');
        styles.id = 'tempMessageStyles';
        styles.textContent = `
          @keyframes slideInFromRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
          }
          @keyframes slideOutToRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
          }
        `;
        document.head.appendChild(styles);
      }

      document.body.appendChild(messageEl);

      // Remove message after duration
      setTimeout(() => {
        if (messageEl && messageEl.parentNode) {
          messageEl.style.animation = 'slideOutToRight 0.3s ease-in';
          setTimeout(() => {
            if (messageEl && messageEl.parentNode) {
              messageEl.remove();
            }
          }, 300);
        }
      }, duration);
    }

    // Enhanced Account Functions
    function editProfile() {
      // Redirect to the dedicated Account page for editing
      window.location.href = 'Account25App.html';
    }

    function changePassword() {
      const currentPassword = prompt('Enter current password:');
      if (currentPassword) {
        const newPassword = prompt('Enter new password:');
        if (newPassword && newPassword.length >= 6) {
          const confirmPassword = prompt('Confirm new password:');
          if (newPassword === confirmPassword) {
            // In a real app, this would make an API call
            localStorage.setItem('hertzPasswordChanged', Date.now());
            alert('Password changed successfully!');
          } else {
            alert('Passwords do not match!');
          }
        } else {
          alert('Password must be at least 6 characters long!');
        }
      }
    }

    function manageNotifications() {
      const notificationTypes = [
        'New music releases',
        'Playlist updates',
        'Friend activity',
        'Concert alerts',
        'Weekly discovery'
      ];

      let message = 'Notification Preferences:\n\n';
      notificationTypes.forEach((type, index) => {
        message += `${index + 1}. ${type}\n`;
      });

      alert(message + '\nManage detailed notification settings in the main Settings > Playback section.');
    }

    function privacySettings() {
      const privacyOptions = [
        ' Data sharing preferences',
        ' Public playlist visibility',
        ' Friend discovery settings',
        ' Location-based features',
        ' Advertising preferences'
      ];

      alert('Privacy Settings:\n\n' + privacyOptions.join('\n') + '\n\nDetailed privacy controls are available in the Settings > Privacy & Security section.');
    }

    function billingHistory() {
      const history = [
        'Jan 2025 - Free Plan - $0.00',
        'Dec 2024 - Free Plan - $0.00',
        'Nov 2024 - Free Plan - $0.00'
      ];

      alert('Billing History:\n\n' + history.join('\n') + '\n\nUpgrade to Premium to see detailed billing information.');
    }

    function paymentMethods() {
      alert('Payment Methods:\n\nNo payment methods on file.\n\nAdd a payment method to upgrade to Premium and enjoy:\n Ad-free listening\n Offline downloads\n High-quality audio\n Unlimited skips');
    }

    function downloadData() {
      const userData = {
        profile: {
          username: localStorage.getItem('hertzUsername') || 'Music Lover',
          email: 'user@hertz.music',
          memberSince: 'January 2025'
        },
        likedTracks: JSON.parse(localStorage.getItem('hertzLikedTracks') || '[]'),
        settings: Object.keys(localStorage)
          .filter(key => key.startsWith('hertz'))
          .reduce((obj, key) => {
            obj[key] = localStorage.getItem(key);
            return obj;
          }, {}),
        exportDate: new Date().toISOString()
      };

      const dataStr = JSON.stringify(userData, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);

      const a = document.createElement('a');
      a.href = url;
      a.download = 'hertz-account-data.json';
      a.click();

      URL.revokeObjectURL(url);
      alert('Account data downloaded successfully!');
    }

    function shareProfile() {
      const profileUrl = 'https://hertz.music/user/music-lover';
      if (navigator.share) {
        navigator.share({
          title: 'Check out my Hertz profile!',
          text: 'Listen to music with me on Hertz',
          url: profileUrl
        });
      } else {
        navigator.clipboard.writeText(profileUrl).then(() => {
          alert('Profile link copied to clipboard!');
        });
      }
    }

    function connectSocial() {
      const services = ['Spotify', 'Apple Music', 'YouTube Music', 'SoundCloud', 'Instagram', 'Twitter'];
      alert('Connect Social Accounts:\n\n' + services.map(s => ` ${s}`).join('\n') + '\n\nShare your music taste and discover what your friends are listening to!');
    }

    function deactivateAccount() {
      if (confirm('Are you sure you want to deactivate your account?\n\nYour account will be hidden but can be reactivated later.')) {
        localStorage.setItem('hertzAccountDeactivated', Date.now());
        alert('Account deactivated. You can reactivate it anytime by logging back in.');
      }
    }

    // Enhanced Settings Functions
    function importData() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      input.onchange = function(e) {
        const file = e.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            try {
              const data = JSON.parse(e.target.result);
              if (data.settings) {
                Object.keys(data.settings).forEach(key => {
                  if (key.startsWith('hertz')) {
                    localStorage.setItem(key, data.settings[key]);
                  }
                });
                alert('Settings imported successfully! Please refresh the page to see changes.');
              } else {
                alert('Invalid data file format.');
              }
            } catch (error) {
              alert('Error reading file: ' + error.message);
            }
          };
          reader.readAsText(file);
        }
      };
      input.click();
    }

    function resetSettings() {
      if (confirm('Are you sure you want to reset all settings to default?\n\nThis action cannot be undone.')) {
        const settingsKeys = Object.keys(localStorage).filter(key => key.startsWith('hertz') && !key.includes('LikedTracks') && !key.includes('CustomTrackMeta'));
        settingsKeys.forEach(key => localStorage.removeItem(key));
        alert('Settings reset to default. Please refresh the page to see changes.');
      }
    }

    function developerMode() {
      const isDeveloper = localStorage.getItem('hertzDeveloperMode') === 'true';
      if (!isDeveloper) {
        const code = prompt('Enter developer access code:');
        if (code === 'HERTZ2025') {
          localStorage.setItem('hertzDeveloperMode', 'true');
          alert('Developer mode enabled! You now have access to advanced debugging tools.');
        } else {
          alert('Invalid access code.');
        }
      } else {
        localStorage.removeItem('hertzDeveloperMode');
        alert('Developer mode disabled.');
      }
    }

    function betaFeatures() {
      const features = [
        ' New UI themes',
        ' AI-powered recommendations',
        ' Voice commands',
        ' Music games',
        ' Mobile app sync',
        ' Social listening rooms'
      ];

      alert('Beta Features Available:\n\n' + features.join('\n') + '\n\nJoin our beta program to try experimental features before they\'re released!');
    }

    function diagnostics() {
      const info = {
        browser: navigator.userAgent,
        storageUsed: (JSON.stringify(localStorage).length / 1024).toFixed(2) + ' KB',
        tracksStored: Object.keys(JSON.parse(localStorage.getItem('hertzCustomTrackMeta') || '{}')).length,
        likedTracks: JSON.parse(localStorage.getItem('hertzLikedTracks') || '[]').length,
        lastUpdate: localStorage.getItem('hertzLastUpdate') || 'Never'
      };

      let message = 'System Diagnostics:\n\n';
      Object.keys(info).forEach(key => {
        message += `${key}: ${info[key]}\n`;
      });

      alert(message);
    }

    function about() {
      alert(' Hertz Music Player\n\nVersion: 2.5.0\nBuild: 2025.01.04\n\nA modern music streaming platform inspired by Spotify, YouTube Music, and SoundCloud.\n\nFeatures:\n High-quality audio streaming\n Offline music support\n Smart playlists\n Social music sharing\n Advanced audio controls\n\n 2025 Hertz Music. All rights reserved.');
    }

    // Initialize settings and account data when page loads
    function initializeUserData() {
      // Set default member since date if not exists
      if (!localStorage.getItem('hertzMemberSince')) {
        localStorage.setItem('hertzMemberSince', 'January 2025');
      }

      // Set default username if not exists
      if (!localStorage.getItem('hertzUsername')) {
        localStorage.setItem('hertzUsername', 'Music Lover');
      }

      // Initialize default settings if they don't exist
      const defaultSettings = {
        hertzMasterVolume: '70',
        hertzAudioQuality: 'normal',
        hertzTheme: 'dark',
        hertzEqualizerPreset: 'flat',
        hertzCrossfadeDuration: '3',
        hertzAutoplay: 'true',
        hertzNotifications: 'true',
        hertzCrossfade: 'false',
        hertzRemoteControl: 'true',
        hertzShareData: 'false',
        hertzPublicPlaylists: 'false',
        hertzFindByEmail: 'false',
        hertzVisualizations: 'true',
        hertzAlbumBackground: 'false'
      };

      Object.keys(defaultSettings).forEach(key => {
        if (!localStorage.getItem(key)) {
          localStorage.setItem(key, defaultSettings[key]);
        }
      });

      // Apply saved theme immediately on page load
      const savedTheme = localStorage.getItem('hertzTheme') || 'dark';
      applyTheme(savedTheme);

      console.log(' User data initialized with theme:', savedTheme);
    }

    function clearCache() {
      if (confirm('Are you sure you want to clear the cache? This will remove temporary data.')) {
        // Clear non-essential localStorage items
        const keysToKeep = ['hertzCustomTrackMeta', 'hertzLikedTracks', 'hertzMasterVolume'];
        const allKeys = Object.keys(localStorage);

        allKeys.forEach(key => {
          if (!keysToKeep.some(keepKey => key.startsWith(keepKey))) {
            localStorage.removeItem(key);
          }
        });

        alert('Cache cleared successfully!');
      }
    }

    function exportData() {
      const data = {
        likedTracks: JSON.parse(localStorage.getItem('hertzLikedTracks') || '[]'),
        customTracks: JSON.parse(localStorage.getItem('hertzCustomTrackMeta') || '{}'),
        settings: {
          masterVolume: localStorage.getItem('hertzMasterVolume') || '70'
        },
        exportDate: new Date().toISOString()
      };

      const dataStr = JSON.stringify(data, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);

      const a = document.createElement('a');
      a.href = url;
      a.download = 'hertz-music-data.json';
      a.click();

      URL.revokeObjectURL(url);
      alert('Data exported successfully!');
    }

    function deleteAccount() {
      if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
        if (confirm('This will permanently delete all your data. Are you absolutely sure?')) {
          localStorage.clear();
          alert('Account data has been deleted. You can continue using Hertz as a new user.');
          location.reload();
        }
      }
    }

    function playLikedSong(songId) {
      console.log(' Playing liked song:', songId);
      // Use existing play functions
      if (typeof playSuggestionTrack === 'function') {
        playSuggestionTrack(songId);
      }
    }

    // Global function to search tracks by name or genre
    window.searchHertzTracks = function(query) {
      if (!query) return [];

      const allTracks = hertzMetadata.tracks;
      const lowerQuery = query.toLowerCase();

      return allTracks.filter(track =>
        track.title.toLowerCase().includes(lowerQuery) ||
        track.artist.toLowerCase().includes(lowerQuery) ||
        track.genre.toLowerCase().includes(lowerQuery)
      );
    };

    // Get all available genres
    window.getHertzGenres = function() {
      const genres = [...new Set(hertzMetadata.tracks.map(track => track.genre))];
      return genres.sort();
    };

    // Immediate test to verify JavaScript is running
    console.log('JavaScript is executing...');
    console.log('Track data loaded:', {
      mostPopular: mostPopularTracks ? mostPopularTracks.length : 0,
      recommended: recommendedTracks ? recommendedTracks.length : 0,
      trending: trendingTracks ? trendingTracks.length : 0
    });

    // Track data definitions and initialization will be handled by the new system above

    // --- Mobile Menu Toggle ---
    function toggleMobileMenu() {
      const mobileNav = document.getElementById('mobileNav');
      mobileNav.classList.toggle('active');
    }

    // --- Search and Suggestions ---
    function searchHertz() {
      const query = document.getElementById('mainSearchInput').value.trim();
      if (query) {
        const results = searchHertzTracks(query);
        displaySearchResults(results, query);
        hideSearchSuggestions();
      }
    }

    function showSearchSuggestions(query) {
      const suggestionsDiv = document.getElementById('searchSuggestions');
      if (!suggestionsDiv) return;

      suggestionsDiv.style.display = 'block';

      if (!query || query.trim().length === 0) {
        suggestionsDiv.innerHTML = '<div style="padding:16px;text-align:center;color:#b3b3b3;">Type a track or artist name...</div>';
        return;
      }

      let results = [];

      // Dynamically build localTracks from window.hertzTrackData for the specified tracks
      const ids = ['Nights', 'Tribz', 'Rhymes', 'Good Woman', 'You My Vibe'];
      const localTracks = {};
      ids.forEach(id => {
        if (window.hertzTrackData[id]) {
          const t = window.hertzTrackData[id];
          localTracks[id] = {
            id: id,
            title: t.title || id,
            artist: t.artist || '',
            cover: t.cover || 'https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80',
            genre: t.genre || ''
          };
        }
      });

      // Filter tracks based on search query
      const q = query.toLowerCase();
      results = Object.values(localTracks).filter(track => {
        return track.title.toLowerCase().includes(q) ||
               track.artist.toLowerCase().includes(q) ||
               (track.genre && track.genre.toLowerCase().includes(q));
      }).slice(0, 8); // Increased from 6 to 8 to show more results      // Always show suggestionsDiv
      suggestionsDiv.style.display = 'block';

      let htmlSuggestions = '';
      if (results.length > 0) {
        htmlSuggestions += '<div style="max-height:280px;overflow-y:auto;border-radius:0 0 12px 12px;">';
        results.forEach(track => {
          htmlSuggestions += `
            <div class="suggestion-item"
                 onclick="playLocalTrack('${track.id}');hideSearchSuggestions();"
                 style="padding:12px 16px;cursor:pointer;display:flex;align-items:center;gap:12px;border-bottom:1px solid #333;background:#232526;transition:all 0.2s ease;"
                 onmouseover="this.style.background='#333';this.style.transform='translateX(2px)'"
                 onmouseout="this.style.background='#232526';this.style.transform='translateX(0)'">
              <img src="${track.cover}"
                   style="width:45px;height:45px;border-radius:8px;object-fit:cover;box-shadow:0 2px 8px rgba(0,0,0,0.15);flex-shrink:0;">
              <div style="flex:1;min-width:0;">
                <div style="color:#fff;font-weight:600;font-size:1.05rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-bottom:2px;">${track.title}</div>
                <div style="color:#b3b3b3;font-size:0.9rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">${track.artist}${track.genre ? '  ' + track.genre : ''}</div>
              </div>
              <div style="color:#1db954;font-size:1.4rem;margin-left:8px;opacity:0.8;transition:opacity 0.2s;"
                   onmouseover="this.style.opacity='1'" onmouseout="this.style.opacity='0.8'"></div>
            </div>
          `;
        });
        htmlSuggestions += '</div>';
      } else {
        htmlSuggestions += '<div style="padding:20px;text-align:center;color:#b3b3b3;font-size:0.95rem;">No matching tracks found in your library.</div>';
      }

      suggestionsDiv.innerHTML = htmlSuggestions;
    }

    // Function to play local tracks from search suggestions
    function playLocalTrack(trackId) {
      console.log(' Playing local track from search:', trackId);

      // Close the search popup
      if (typeof closeSearchPopup === 'function') {
        closeSearchPopup();
      }

      // Call the existing playTrack function which handles the sticky player
      if (typeof playTrack === 'function') {
        playTrack(trackId);
      } else if (typeof window.playTrack === 'function') {
        window.playTrack(trackId);
      } else {
        console.error('playTrack function not found');
      }
    }

    function hideSearchSuggestions() {
      setTimeout(() => {
        const suggestionsDiv = document.getElementById('searchSuggestions');
        if (suggestionsDiv) {
          suggestionsDiv.style.display = 'none';
        }
      }, 200); // Delay to allow click events
    }

    function selectSuggestion(suggestion) {
      const popupSearchInput = document.getElementById('popupSearchInput');
      if (popupSearchInput) {
        popupSearchInput.value = suggestion;
        showSearchSuggestions(suggestion);
      }
    }

    function displaySearchResults(results, query) {
      const main = document.querySelector('main');
      const existingResults = main.querySelector('#searchResults');

      if (existingResults) {
        existingResults.remove();
      }

      if (results.length === 0) {
        const noResults = document.createElement('div');
        noResults.id = 'searchResults';
        noResults.innerHTML = `
          <div style="margin: 2rem 0; padding: 2rem; background: #232526; border-radius: 12px; text-align: center;">
            <h3 style="color: #fff; margin-bottom: 1rem;">No results found for "${query}"</h3>
            <p style="color: #b3b3b3;">Try searching for different tracks, artists, or genres.</p>
          </div>
        `;
        main.appendChild(noResults);
        return;
      }

      const resultsSection = document.createElement('div');
      resultsSection.id = 'searchResults';
      resultsSection.innerHTML = `
        <div style="margin: 2rem 0;">
          <h2 style="font-size: 1.8rem; font-weight: 700; margin-bottom: 1.5rem; color: #fff;">
            Search Results for "${query}" (${results.length} found)
          </h2>
          <div class="track-row-list" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap: 1.2rem;">
            ${results.map(track => `
              <div class="track-card search-result" data-trackid="${track.id}" style="background:#232526;border-radius:14px;box-shadow:0 2px 8px rgba(0,0,0,0.10);padding:1rem;display:flex;flex-direction:column;align-items:center;position:relative;transition:transform 0.2s,box-shadow 0.2s;cursor:pointer;"
                   onclick="playTrackFromSearch('${track.id}')">
                <div style="position:relative;margin-bottom:0.5rem;">
                  <img src="${track.cover}" alt="${track.title}" style="width:100px;height:100px;border-radius:8px;object-fit:cover;">
                  <div class="play-overlay" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:40px;height:40px;background:rgba(29,185,84,0.9);border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.2s;pointer-events:none;">
                    <span style="color:#fff;font-size:20px;margin-left:2px;"></span>
                  </div>
                </div>
                <div style="font-weight:600;font-size:1.05rem;text-align:center;margin-bottom:0.3rem;color:#fff;">
                  ${track.title}
                </div>
                <div style="color:#b3b3b3;font-size:0.97rem;text-align:center;margin-bottom:0.3rem;">
                  ${track.artist}
                </div>
                <div style="color:#1db954;font-size:0.85rem;text-align:center;font-weight:500;">
                  ${track.genre}
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;

      main.appendChild(resultsSection);

      // Scroll to results
      resultsSection.scrollIntoView({ behavior: 'smooth' });
    }

    // Function to play track from search results
    window.playTrackFromSearch = function(trackId) {
      // Find the track in metadata
      const metadataTracks = [
        ...hertzMetadata.featured,
        ...hertzMetadata.trending,
        ...hertzMetadata.recommended
      ];

      const track = metadataTracks.find(t => t.id === trackId);
      if (track && track.url) {
        // Add to global player queue
        const playerTrack = {
          name: track.title + " - " + track.artist,
          id: track.id,
          url: track.url,
          title: track.title,
          artist: track.artist,
          cover: track.cover,
          genre: track.genre
        };

        // Ensure track is in global allTracks array
        const existingIndex = allTracks.findIndex(t => t.id === trackId);
        if (existingIndex === -1) {
          allTracks.push(playerTrack);
        } else {
          allTracks[existingIndex] = playerTrack; // Update existing
        }

        // Load and play
        const idx = allTracks.findIndex(t => t.id === trackId);
        if (idx !== -1) {
          loadTrack(idx, true);
        }
      } else {
        alert('This track is not available for streaming yet. Please upload an MP3 file to play it.');
      }
    };

    // Function to play track from search suggestions
    window.playSuggestionTrack = function(trackId) {
      // Find the track in metadata
      const metadataTracks = [
        ...hertzMetadata.featured,
        ...hertzMetadata.trending,
        ...hertzMetadata.recommended
      ];

      const track = metadataTracks.find(t => t.id === trackId);
      if (track && track.url) {
        // Add to global player queue
        const playerTrack = {
          name: track.title + " - " + track.artist,
          id: track.id,
          url: track.url,
          title: track.title,
          artist: track.artist,
          cover: track.cover,
          genre: track.genre
        };

        // Ensure track is in global allTracks array
        const existingIndex = allTracks.findIndex(t => t.id === trackId);
        if (existingIndex === -1) {
          allTracks.push(playerTrack);
        } else {
          allTracks[existingIndex] = playerTrack; // Update existing
        }

        // Load and play
        const idx = allTracks.findIndex(t => t.id === trackId);
        if (idx !== -1) {
          loadTrack(idx, true);
        }

        // Clear search suggestions after playing
        const suggestionList = document.getElementById('suggestionList');
        if (suggestionList) {
          suggestionList.style.display = 'none';
        }

        // Clear the search input
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
          searchInput.value = '';
        }
      } else {
        alert('This track is not available for streaming yet. Please upload an MP3 file to play it.');
      }
    };

    // --- Track Data and Persistence ---
    // Track data already defined above

    function saveCustomTrackMeta(trackId, meta) {
      try {
        let metas = JSON.parse(localStorage.getItem('hertzCustomTrackMeta') || '{}');
        metas[trackId] = { ...(metas[trackId] || {}), ...meta };

        const dataStr = JSON.stringify(metas);

        // Add timestamp to new entries
        if (meta.mp3) {
          metas[trackId].timestamp = Date.now();
        }

        try {
          const finalDataStr = JSON.stringify(metas);
          localStorage.setItem('hertzCustomTrackMeta', finalDataStr);

          // Also save to a backup key for extra persistence
          localStorage.setItem('hertzCustomTrackMeta_backup', finalDataStr);

          // Save a timestamp of last update
          localStorage.setItem('hertzLastUpdate', Date.now().toString());

          console.log(`Storage used: ${(new Blob([finalDataStr]).size / 1024 / 1024).toFixed(2)}MB`);

          // Update storage indicator
          updateStorageIndicator();
        } catch (storageError) {
          if (storageError.name === 'QuotaExceededError') {
            // Only if we actually hit the quota, try to clean up
            console.log('Storage quota exceeded, attempting cleanup...');

            // Try to free up space by removing oldest entries
            const sortedEntries = Object.entries(metas).sort((a, b) => {
              const aTime = a[1].timestamp || 0;
              const bTime = b[1].timestamp || 0;
              return aTime - bTime;
            });

            // Remove oldest entries until we can save
            while (sortedEntries.length > 1) {
              const [oldestTrackId] = sortedEntries.shift();
              if (oldestTrackId !== trackId) { // Don't remove the track we're trying to add
                delete metas[oldestTrackId];
                console.log(`Removed oldest track ${oldestTrackId} to free up space`);

                // Try to save again
                try {
                  const cleanedDataStr = JSON.stringify(metas);
                  localStorage.setItem('hertzCustomTrackMeta', cleanedDataStr);
                  localStorage.setItem('hertzCustomTrackMeta_backup', cleanedDataStr);
                  console.log('Storage cleaned and saved successfully');
                  break;
                } catch (e) {
                  // Continue cleaning if still failing
                  continue;
                }
              }
            }
          } else {
            throw storageError;
          }
        }

        // Save a timestamp of last update
        localStorage.setItem('hertzLastUpdate', Date.now().toString());

        // Cleanup every 10 saves to keep localStorage lean
        const saveCount = parseInt(localStorage.getItem('hertzSaveCount') || '0') + 1;
        localStorage.setItem('hertzSaveCount', saveCount.toString());
        if (saveCount % 10 === 0) {
          cleanupCustomTrackMeta();
        }

        console.log(`Storage used: ${(new Blob([finalDataStr]).size / 1024 / 1024).toFixed(2)}MB`);

        // Update storage indicator
        updateStorageIndicator();

      } catch (e) {
        if (e.name === 'QuotaExceededError') {
          // Try emergency cleanup
          console.log('Storage quota exceeded, attempting emergency cleanup...');
          emergencyCleanup();

          // Try saving again with reduced data
          try {
            let metas = JSON.parse(localStorage.getItem('hertzCustomTrackMeta') || '{}');
            metas[trackId] = { ...(metas[trackId] || {}), ...meta };

            // If it's still an MP3 upload, compress it
            if (meta.mp3) {
              metas[trackId].mp3 = compressAudioData(meta.mp3);
            }

            localStorage.setItem('hertzCustomTrackMeta', JSON.stringify(metas));
            localStorage.setItem('hertzCustomTrackMeta_backup', JSON.stringify(metas));
          } catch (e2) {
            alert('Storage is full! Please remove some tracks to add new ones.\n\nClick the  button on tracks you no longer need.');
            console.error('Storage still full after cleanup');
          }
        } else {
          console.error('Error saving track metadata:', e);
        }
      }
    }

    function getCustomTrackMeta(trackId) {
      let metas = JSON.parse(localStorage.getItem('hertzCustomTrackMeta') || '{}');

      // If primary storage is empty, try backup
      if (Object.keys(metas).length === 0) {
        metas = JSON.parse(localStorage.getItem('hertzCustomTrackMeta_backup') || '{}');
        if (Object.keys(metas).length > 0) {
          // Restore from backup
          localStorage.setItem('hertzCustomTrackMeta', JSON.stringify(metas));
        }
      }

      return metas[trackId] || {};
    }

    function getTrackById(trackId) {
      const allTrackDefs = [...mostPopularTracks, ...recommendedTracks, ...trendingTracks];
      return allTrackDefs.find(track => track.id === trackId) || {};
    }

    function cleanupCustomTrackMeta() {
      // Remove empty metadata entries to keep localStorage clean
      let metas = JSON.parse(localStorage.getItem('hertzCustomTrackMeta') || '{}');
      const cleanedMetas = {};

      for (const trackId in metas) {
        const meta = metas[trackId];
        if (meta.mp3 || meta.cover || meta.name || meta.artist) {
          cleanedMetas[trackId] = meta;
        }
      }

      localStorage.setItem('hertzCustomTrackMeta', JSON.stringify(cleanedMetas));
      localStorage.setItem('hertzCustomTrackMeta_backup', JSON.stringify(cleanedMetas));
    }

    function validateAndRestoreData() {
      try {
        // Validate primary storage
        const primaryData = localStorage.getItem('hertzCustomTrackMeta');
        if (primaryData) {
          JSON.parse(primaryData);
        }
      } catch (e) {
        console.log('Primary storage corrupted, restoring from backup...');
        // Restore from backup if primary is corrupted
        const backupData = localStorage.getItem('hertzCustomTrackMeta_backup');
        if (backupData) {
          try {
            JSON.parse(backupData);
            localStorage.setItem('hertzCustomTrackMeta', backupData);
          } catch (e2) {
            console.log('Backup also corrupted, starting fresh');
            localStorage.removeItem('hertzCustomTrackMeta');
            localStorage.removeItem('hertzCustomTrackMeta_backup');
          }
        }
      }
    }

    function emergencyCleanup() {
      try {
        // Remove all non-essential data first
        const keysToRemove = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && !key.startsWith('hertzCustomTrackMeta') && !key.startsWith('hertzLiked')) {
            keysToRemove.push(key);
          }
        }

        keysToRemove.forEach(key => {
          localStorage.removeItem(key);
          console.log(`Removed ${key} during emergency cleanup`);
        });

        // Then try to compress existing track data
        const metas = JSON.parse(localStorage.getItem('hertzCustomTrackMeta') || '{}');
        let compressed = false;

        Object.keys(metas).forEach(trackId => {
          const meta = metas[trackId];
          if (meta.mp3 && meta.mp3.length > 100000) { // Only compress large files
            const compressedData = compressAudioData(meta.mp3);
            if (compressedData.length < meta.mp3.length) {
              metas[trackId].mp3 = compressedData;
              compressed = true;
            }
          }
        });

        if (compressed) {
          localStorage.setItem('hertzCustomTrackMeta', JSON.stringify(metas));
          localStorage.setItem('hertzCustomTrackMeta_backup', JSON.stringify(metas));
          console.log('Compressed existing audio data');
        }

      } catch (e) {
        console.error('Emergency cleanup failed:', e);
      }
    }

    function compressAudioData(audioDataUrl) {
      try {
        // For audio files, we can reduce quality by resampling
        // This is a simplified compression - in practice, you'd want to use a proper audio library

        // Extract the base64 data
        const base64Data = audioDataUrl.split(',')[1];
        const binaryString = atob(base64Data);

        // Simple compression by reducing data size (this is a placeholder)
        // In a real implementation, you'd use proper audio compression
        const compressed = binaryString.substring(0, Math.floor(binaryString.length * 0.7));

        return audioDataUrl.split(',')[0] + ',' + btoa(compressed);
      } catch (e) {
        console.error('Compression failed:', e);
        return audioDataUrl; // Return original if compression fails
      }
    }

    // Initialize track cards with better structure
    function initializeTrackCards() {
      console.log(' Initializing track cards...');

      const main = document.querySelector('main');
      const actionButtons = main ? main.querySelector('.action-buttons') : null;

      console.log('Debug info:', {
        main: !!main,
        actionButtons: !!actionButtons,
        mostPopularTracks: mostPopularTracks.length,
        recommendedTracks: recommendedTracks.length,
        trendingTracks: trendingTracks.length
      });

      if (!main || !actionButtons) {
        console.error(' Could not find main or action buttons', { main, actionButtons });
        return;
      }

      // Remove any existing track rows
      const existingRows = main.querySelectorAll('.track-section');
      console.log('Removing existing rows:', existingRows.length);
      existingRows.forEach(row => row.remove());

      // Create track sections with enhanced headers
      const sections = [
        { title: 'Featured Tracks', tracks: mostPopularTracks, id: 'featuredSection' },
        { title: 'Trending Now', tracks: trendingTracks, id: 'trendingSection' },
        { title: 'Recommended For You', tracks: recommendedTracks, id: 'recommendedSection' }
      ];

      console.log('Creating sections:', sections.length);

      sections.forEach((section, index) => {
        console.log(`Creating section ${index + 1}:`, section.title);
        const sectionElement = createEnhancedTrackSection(section.title, section.tracks, section.id);

        if (index === 0) {
          actionButtons.parentNode.insertBefore(sectionElement, actionButtons.nextSibling);
          console.log(' Inserted first section after action buttons');
        } else {
          const previousSection = main.querySelector(`#${sections[index - 1].id}`);
          if (previousSection) {
            previousSection.parentNode.insertBefore(sectionElement, previousSection.nextSibling);
            console.log(` Inserted section ${index + 1} after previous section`);
          } else {
            console.error(` Could not find previous section: ${sections[index - 1].id}`);
          }
        }
      });

      // Check results
      const trackCards = document.querySelectorAll('.track-card');
      console.log(` Track cards created: ${trackCards.length}`);

      // Attach event listeners after DOM is updated
      setTimeout(() => {
        if (typeof attachEventListeners === 'function') {
          attachEventListeners();
          console.log(' Event listeners attached');
        }

        // Restore player state after initialization
        setTimeout(() => {
          if (typeof updateAllTracksFromRows === 'function') {
            updateAllTracksFromRows();
          }
          if (typeof restorePlayerState === 'function' && restorePlayerState()) {
            console.log(' Player state restored from previous session');
          }
        }, 500);
      }, 100);
    }

    function createEnhancedTrackSection(title, tracks, sectionId) {
      const section = document.createElement('div');
      section.className = 'track-section';
      section.id = sectionId;

      section.innerHTML = `
        <h2 class="section-header">${title}</h2>
        <div class="track-row-list">
          ${tracks.map(track => {
            const meta = getCustomTrackMeta(track.id);
            const customCover = meta.cover || track.cover;
            const customName = meta.name || track.name;
            const customArtist = meta.artist || track.artist;
            const hasMp3 = !!meta.mp3;

            return `
              <div class="track-card" data-trackid="${track.id}" style="background:#232526;border-radius:14px;min-width:170px;max-width:170px;box-shadow:0 2px 8px rgba(0,0,0,0.10);padding:1rem;display:flex;flex-direction:column;align-items:center;position:relative;transition:transform 0.2s,box-shadow 0.2s;${hasMp3 ? 'border:2px solid #1db954;' : ''}">
                <div style="display:flex;align-items:center;width:100%;justify-content:center;margin-bottom:0.5rem;position:relative;">
                  <input type="file" accept="audio/mp3,audio/mpeg" id="mp3file_${track.id}" style="display:none">
                  <button title="Browse for mp3" class="mp3-btn" data-trackid="${track.id}" style="background:#1db954;border:none;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;cursor:pointer;padding:0;margin-right:7px;z-index:10;">
                    <span style="font-size:1.1em;color:#181818;">&#128190;</span>
                  </button>
                  <div style="position:relative;">
                    <img id="cover_${track.id}" src="${customCover}" alt="${customName} cover" style="width:100px;height:100px;border-radius:8px;object-fit:cover;cursor:${hasMp3 ? 'pointer' : 'default'};">
                    ${hasMp3 ? '<div class="play-overlay" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:40px;height:40px;background:rgba(29,185,84,0.9);border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.2s;pointer-events:none;"><span style="color:#fff;font-size:20px;margin-left:2px;"></span></div>' : ''}
                  </div>
                  <input type="file" accept="image/*" id="file_${track.id}" style="display:none">
                  <button title="Change cover" class="cover-btn" data-trackid="${track.id}" style="position:absolute;top:6px;right:6px;background:#1db954;border:none;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;cursor:pointer;padding:0;z-index:10;">
                    <span style="font-size:1.1em;color:#181818;">&#128247;</span>
                  </button>
                </div>
                <div style="font-weight:600;font-size:1.05rem;text-align:center;margin-bottom:0.3rem;">
                  <span id="name_${track.id}" style="cursor:pointer;">${customName}</span>
                  <input type="text" id="input_name_${track.id}" value="${customName}" style="display:none;width:90%;margin-top:2px;border-radius:6px;border:none;padding:2px 6px;">
                  <button title="Edit name" class="edit-name-btn" data-trackid="${track.id}" style="background:none;border:none;cursor:pointer;padding:0 0 0 4px;color:#1db954;font-size:1em;">&#9998;</button>
                </div>
                <div style="color:#b3b3b3;font-size:0.97rem;text-align:center;margin-bottom:0.3rem;">
                  <span id="artist_${track.id}" style="cursor:pointer;">${customArtist}</span>
                  <input type="text" id="input_artist_${track.id}" value="${customArtist}" style="display:none;width:90%;margin-top:2px;border-radius:6px;border:none;padding:2px 6px;">
                  <button title="Edit artist" class="edit-artist-btn" data-trackid="${track.id}" style="background:none;border:none;cursor:pointer;padding:0 0 0 4px;color:#1db954;font-size:1em;">&#9998;</button>
                </div>
                <div style="margin-top:0.5rem;display:flex;gap:0.5rem;justify-content:center;">
                  <button class="play-mp3-btn" data-trackid="${track.id}" style="background:${hasMp3 ? '#1db954' : '#404040'};border:none;border-radius:20px;padding:0.4rem 1.2rem;font-size:0.97rem;cursor:pointer;color:${hasMp3 ? '#181818' : '#b3b3b3'};font-weight:600;transition:all 0.2s;">
                    ${hasMp3 ? ' Ready to Play' : ' Upload MP3'}
                  </button>
                  ${hasMp3 ? `<button class="remove-mp3-btn" data-trackid="${track.id}" title="Remove MP3" style="background:#ff4444;border:none;border-radius:20px;padding:0.4rem 0.8rem;font-size:0.9rem;cursor:pointer;color:#fff;font-weight:600;transition:all 0.2s;"></button>` : ''}
                </div>
              </div>
            `;
          }).join('')}
        </div>
      `;

      return section;
    }

    // EMERGENCY FALLBACK - Simple track card creation
    function createSimpleTrackCards() {
      console.log(' EMERGENCY: Creating simple track cards...');

      const main = document.querySelector('main');
      const actionButtons = main?.querySelector('.action-buttons');

      if (!main || !actionButtons) {
        console.error(' EMERGENCY: No main or action buttons found');
        return;
      }

      // Remove existing
      const existing = main.querySelectorAll('.track-section, .track-row');
      existing.forEach(el => el.remove());

      // Create sections HTML directly
      const sectionsHTML = `
        <div class="track-section" id="featuredSection">
          <h2 class="section-header">FEATURED TRACKS</h2>
          <div class="track-row-list">
            ${mostPopularTracks.slice(0, 10).map(track => `
              <div class="track-card" data-trackid="${track.id}" style="background:#232526;border-radius:14px;min-width:170px;max-width:170px;box-shadow:0 2px 8px rgba(0,0,0,0.10);padding:1rem;display:flex;flex-direction:column;align-items:center;position:relative;transition:transform 0.2s,box-shadow 0.2s;">
                <div style="position:relative;margin-bottom:0.5rem;">
                  <img src="${track.cover}" alt="${track.name}" style="width:100px;height:100px;border-radius:8px;object-fit:cover;">
                </div>
                <div style="font-weight:600;font-size:1.05rem;text-align:center;margin-bottom:0.3rem;color:#fff;">
                  ${track.name}
                </div>
                <div style="color:#b3b3b3;font-size:0.97rem;text-align:center;">
                  ${track.artist}
                </div>
                <div style="margin-top:0.5rem;">
                  <button style="background:#404040;border:none;border-radius:20px;padding:0.4rem 1.2rem;font-size:0.97rem;cursor:pointer;color:#b3b3b3;font-weight:600;">
                     Upload MP3
                  </button>
                </div>
              </div>
            `).join('')}
          </div>
        </div>

        <div class="track-section" id="trendingSection">
          <h2 class="section-header">TRENDING NOW</h2>
          <div class="track-row-list">
            ${trendingTracks.slice(0, 10).map(track => `
              <div class="track-card" data-trackid="${track.id}" style="background:#232526;border-radius:14px;min-width:170px;max-width:170px;box-shadow:0 2px 8px rgba(0,0,0,0.10);padding:1rem;display:flex;flex-direction:column;align-items:center;position:relative;transition:transform 0.2s,box-shadow 0.2s;">
                <div style="position:relative;margin-bottom:0.5rem;">
                  <img src="${track.cover}" alt="${track.name}" style="width:100px;height:100px;border-radius:8px;object-fit:cover;">
                </div>
                <div style="font-weight:600;font-size:1.05rem;text-align:center;margin-bottom:0.3rem;color:#fff;">
                  ${track.name}
                </div>
                <div style="color:#b3b3b3;font-size:0.97rem;text-align:center;">
                  ${track.artist}
                </div>
                <div style="margin-top:0.5rem;">
                  <button style="background:#404040;border:none;border-radius:20px;padding:0.4rem 1.2rem;font-size:0.97rem;cursor:pointer;color:#b3b3b3;font-weight:600;">
                     Upload MP3
                  </button>
                </div>
              </div>
            `).join('')}
          </div>
        </div>

        <div class="track-section" id="recommendedSection">
          <h2 class="section-header">RECOMMENDED FOR YOU</h2>
          <div class="track-row-list">
            ${recommendedTracks.slice(0, 10).map(track => `
              <div class="track-card" data-trackid="${track.id}" style="background:#232526;border-radius:14px;min-width:170px;max-width:170px;box-shadow:0 2px 8px rgba(0,0,0,0.10);padding:1rem;display:flex;flex-direction:column;align-items:center;position:relative;transition:transform 0.2s,box-shadow 0.2s;">
                <div style="position:relative;margin-bottom:0.5rem;">
                  <img src="${track.cover}" alt="${track.name}" style="width:100px;height:100px;border-radius:8px;object-fit:cover;">
                </div>
                <div style="font-weight:600;font-size:1.05rem;text-align:center;margin-bottom:0.3rem;color:#fff;">
                  ${track.name}
                </div>
                <div style="color:#b3b3b3;font-size:0.97rem;text-align:center;">
                  ${track.artist}
                </div>
                <div style="margin-top:0.5rem;">
                  <button style="background:#404040;border:none;border-radius:20px;padding:0.4rem 1.2rem;font-size:0.97rem;cursor:pointer;color:#b3b3b3;font-weight:600;">
                     Upload MP3
                  </button>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `;

      // Insert after action buttons
      actionButtons.insertAdjacentHTML('afterend', sectionsHTML);

      console.log(' EMERGENCY: Simple track cards created!');
      console.log('Track cards in DOM:', document.querySelectorAll('.track-card').length);
    }

    // IMMEDIATE INITIALIZATION - Force track cards to display
    console.log(' IMMEDIATE: Starting track card initialization...');

    // Force initialization immediately
    setTimeout(() => {
      console.log(' FORCED INITIALIZATION: Creating track cards NOW...');
      if (typeof initializeTrackCards === 'function') {
        initializeTrackCards();
      }
    }, 50);

    // Ensure track cards are shown when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
      console.log(' DOM Content Loaded - Initializing track cards...');
      if (typeof initializeTrackCards === 'function') {
        initializeTrackCards();
      }
      if (typeof updateStorageIndicator === 'function') {
        updateStorageIndicator();
      }
    });

    // Fallback initialization - Multiple attempts
    setTimeout(() => {
      if (document.querySelectorAll('.track-card').length === 0) {
        console.log(' Fallback initialization attempt 1...');
        if (typeof initializeTrackCards === 'function') {
          initializeTrackCards();
        }
      }
    }, 500);

    setTimeout(() => {
      if (document.querySelectorAll('.track-card').length === 0) {
        console.log(' Fallback initialization attempt 2...');
        if (typeof createSimpleTrackCards === 'function') {
          createSimpleTrackCards();
        }
      }
    }, 1000);

    setTimeout(() => {
      if (document.querySelectorAll('.track-card').length === 0) {
        console.log(' Fallback initialization attempt 3 - EMERGENCY...');
        if (typeof createSimpleTrackCards === 'function') {
          createSimpleTrackCards();
        }
      }
    }, 2000);

    // Force show track cards on page load
    window.addEventListener('load', function() {
      console.log(' Window loaded - Ensuring track cards display...');
      if (document.querySelectorAll('.track-card').length === 0) {
        console.log(' Window load initialization - EMERGENCY...');
        if (typeof createSimpleTrackCards === 'function') {
          createSimpleTrackCards();
        }
      }
    });

    // --- Enhanced Persistent Player Logic ---
    let allTracks = [];
    let currentIndex = 0;
    let isPlaying = false;
    let isLoop = false;
    let isShuffle = false;

    // Utility: Format time in mm:ss
    function formatTime(seconds) {
      if (!isFinite(seconds) || isNaN(seconds)) return '0:00';
      const m = Math.floor(seconds / 60);
      const s = Math.floor(seconds % 60);
      return m + ':' + (s < 10 ? '0' : '') + s;
    }

    // Global function to play track from card click - defined early to avoid timing issues
    window.playTrackFromCard = function(trackId) {
      updateAllTracksFromRows();
      const idx = allTracks.findIndex(t => t.id === trackId);
      if (idx !== -1) {
        loadTrack(idx, true);
      }
    };

    const stickyPlayer = document.getElementById('stickyPlayer');
    const playerAudio = document.getElementById('playerAudio');
    const playerTrackTitle = document.getElementById('playerTrackTitle');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const loopBtn = document.getElementById('loopBtn');
    const shuffleBtn = document.getElementById('shuffleBtn');
    const volumeRange = document.getElementById('volumeRange');
    const progressBar = document.getElementById('progressBar');
    const currentTimeSpan = document.getElementById('currentTime');
    const durationSpan = document.getElementById('duration');

    // Enhanced player state management for cross-page persistence
    function savePlayerState() {
      if (!allTracks[currentIndex]) return;

      const playerState = {
        track: {
          name: allTracks[currentIndex].name,
          id: allTracks[currentIndex].id,
          url: allTracks[currentIndex].url || null,
          title: allTracks[currentIndex].title || allTracks[currentIndex].name.split(' - ')[0],
          artist: allTracks[currentIndex].artist || allTracks[currentIndex].name.split(' - ')[1],
          cover: allTracks[currentIndex].cover,
          genre: allTracks[currentIndex].genre
        },
        currentTime: playerAudio.currentTime || 0,
        isPlaying: isPlaying,
        volume: playerAudio.volume || 0.7,
        isLoop: isLoop,
        isShuffle: isShuffle,
        currentIndex: currentIndex,
        allTracks: allTracks.map(t => ({
          id: t.id,
          name: t.name,
          url: t.url,
          title: t.title,
          artist: t.artist,
          cover: t.cover,
          genre: t.genre
        })),
        timestamp: Date.now()
      };

      // Save to both session and local storage for maximum persistence
      sessionStorage.setItem('hertzPlayerState', JSON.stringify(playerState));
      localStorage.setItem('hertzPlayerState', JSON.stringify(playerState));
      localStorage.setItem('hertzPlayerLastUpdate', Date.now().toString());
    }

    function restorePlayerState() {
      // Try session storage first, then local storage
      let playerStateData = sessionStorage.getItem('hertzPlayerState') || localStorage.getItem('hertzPlayerState');

      if (!playerStateData) return false;

      try {
        const playerState = JSON.parse(playerStateData);

        // Check if state is recent (within last 24 hours)
        const timeDiff = Date.now() - (playerState.timestamp || 0);
        if (timeDiff > 24 * 60 * 60 * 1000) {
          console.log('Player state too old, skipping restore');
          return false;
        }

        // Restore tracks array
        if (playerState.allTracks && playerState.allTracks.length > 0) {
          allTracks = playerState.allTracks;
        }

        // Restore player state
        if (playerState.track && playerState.track.url) {
          const trackIndex = allTracks.findIndex(t => t.id === playerState.track.id);
          if (trackIndex !== -1) {
            currentIndex = trackIndex;
            loadTrack(currentIndex, false);

            // Restore playback position
            playerAudio.currentTime = playerState.currentTime || 0;

            // Restore volume
            if (playerState.volume !== undefined) {
              playerAudio.volume = playerState.volume;
              volumeRange.value = playerState.volume;
            }

            // Restore control states
            isLoop = playerState.isLoop || false;
            isShuffle = playerState.isShuffle || false;
            loopBtn.classList.toggle('active', isLoop);
            shuffleBtn.classList.toggle('active', isShuffle);
            playerAudio.loop = isLoop;

            // Restore playback state if it was playing
            if (playerState.isPlaying) {
              setTimeout(() => {
                playPause();
              }, 500); // Small delay to ensure audio is loaded
            }

            console.log(' Player state restored successfully');
            return true;
          }
        }

        return false;
      } catch (error) {
        console.error('Error restoring player state:', error);
        return false;
      }
    }

    function loadTrack(idx, autoplay = true) {
      if (!allTracks[idx] || !allTracks[idx].url) return;
      stickyPlayer.style.display = 'flex';
      playerAudio.src = allTracks[idx].url;
      playerTrackTitle.textContent = allTracks[idx].name;
      currentIndex = idx;
      playPauseBtn.innerHTML = '&#9654;';
      isPlaying = false;
      progressBar.value = 0;
      currentTimeSpan.textContent = "0:00";
      durationSpan.textContent = "0:00";
      // Ensure controls and timer are visible and functional
      playPauseBtn.disabled = false;
      prevBtn.disabled = false;
      nextBtn.disabled = false;
      loopBtn.disabled = false;
      shuffleBtn.disabled = false;
      progressBar.disabled = false;
      volumeRange.disabled = false;
      // Force timer update for selected track
      playerAudio.addEventListener('loadedmetadata', function() {
        durationSpan.textContent = formatTime(playerAudio.duration);
        currentTimeSpan.textContent = formatTime(playerAudio.currentTime);
      }, { once: true });
      if (autoplay) playPause();
      savePlayerState();
    }

    function playPause() {
      if (!allTracks[currentIndex] || !allTracks[currentIndex].url) return;
      if (isPlaying) {
        playerAudio.pause();
        playPauseBtn.innerHTML = '&#9654;'; // Show play button when paused
        isPlaying = false;
      } else {
        playerAudio.play();
        playPauseBtn.innerHTML = '&#10073;&#10073;'; // Show pause button when playing
        isPlaying = true;
      }
      savePlayerState();
    }

    function playNext() {
      if (isShuffle) {
        currentIndex = Math.floor(Math.random() * allTracks.length);
      } else {
        currentIndex = (currentIndex + 1) % allTracks.length;
      }
      loadTrack(currentIndex);
    }

    function playPrev() {
      if (isShuffle) {
        currentIndex = Math.floor(Math.random() * allTracks.length);
      } else {
        currentIndex = (currentIndex - 1 + allTracks.length) % allTracks.length;
      }
      loadTrack(currentIndex);
    }

    function toggleLoop() {
      isLoop = !isLoop;
      playerAudio.loop = isLoop;
      loopBtn.classList.toggle('active', isLoop);
      savePlayerState();
    }

    function toggleShuffle() {
      isShuffle = !isShuffle;
      shuffleBtn.classList.toggle('active', isShuffle);
      savePlayerState();
    }

    // Enhanced event listeners with state saving
    playerAudio.addEventListener('timeupdate', function() {
      if (!playerAudio.duration) return;
      progressBar.value = (playerAudio.currentTime / playerAudio.duration) * 100;
      // Timer at top: current time (left), duration (right)
      currentTimeSpan.textContent = formatTime(playerAudio.currentTime);
      durationSpan.textContent = formatTime(playerAudio.duration);
      // Save state periodically (every 5 seconds)
      if (Math.floor(playerAudio.currentTime) % 5 === 0) {
        savePlayerState();
      }
    });
    playerAudio.addEventListener('loadedmetadata', function() {
      durationSpan.textContent = formatTime(playerAudio.duration);
    });

    progressBar.addEventListener('input', function() {
      if (!playerAudio.duration) return;
      playerAudio.currentTime = (progressBar.value / 100) * playerAudio.duration;
      savePlayerState();
    });
    // Touch support for mobile seeking
    document.addEventListener('DOMContentLoaded', function() {
      if (progressBar) {
        progressBar.addEventListener('touchstart', function() { playerAudio.pause(); });
        progressBar.addEventListener('touchend', function() { playerAudio.play(); });
        progressBar.addEventListener('input', function() {
          if (!playerAudio.duration) return;
          playerAudio.currentTime = (progressBar.value / 100) * playerAudio.duration;
          savePlayerState();
        });
      }
      if (volumeRange) {
        volumeRange.addEventListener('input', function() {
          playerAudio.volume = volumeRange.value;
          savePlayerState();
        });
      }
      if (playPauseBtn) playPauseBtn.addEventListener('click', playPause);
      if (prevBtn) prevBtn.addEventListener('click', playPrev);
      if (nextBtn) nextBtn.addEventListener('click', playNext);
      if (loopBtn) loopBtn.addEventListener('click', toggleLoop);
      if (shuffleBtn) shuffleBtn.addEventListener('click', toggleShuffle);
    });

    // Sync button state with actual audio player state
    playerAudio.addEventListener('play', function() {
      playPauseBtn.innerHTML = '&#10073;&#10073;'; // Show pause button when playing
      isPlaying = true;
    });

    playerAudio.addEventListener('pause', function() {
      playPauseBtn.innerHTML = '&#9654;'; // Show play button when paused
      isPlaying = false;
    });

    playerAudio.addEventListener('ended', function() {
      playPauseBtn.innerHTML = '&#9654;'; // Show play button when ended
      isPlaying = false;
      if (!isLoop) {
        playNext(); // Auto-play next track if not looping
      }
    });

    // --- Enhanced Like Button Logic with Full Track Data ---
    function saveLikedTrackWithFullData(track) {
      try {
        let likedTracks = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');

        console.log(' Saving liked track:', track);

        // Enhance track data with metadata if available
        const allTracksMetadata = [
          ...hertzMetadata.featured,
          ...hertzMetadata.trending,
          ...hertzMetadata.recommended
        ];

        const trackMetadata = allTracksMetadata.find(t => t.id === track.id);
        console.log(' Found metadata for track:', trackMetadata);

        // Save comprehensive track data
        const savedTrack = {
          id: track.id,
          name: trackMetadata?.title || track.title || track.name,
          title: trackMetadata?.title || track.title || track.name, // Include both for compatibility
          artist: trackMetadata?.artist || track.artist,
          cover: trackMetadata?.cover || track.cover,
          genre: trackMetadata?.genre || track.genre || 'Unknown',
          url: track.url || trackMetadata?.url, // Prefer uploaded MP3, fallback to metadata URL
          mp3: track.url, // Store as MP3 for backward compatibility
          timestamp: Date.now(),
          likedAt: Date.now(), // Add both timestamp formats for compatibility
          source: 'hertz_app', // Track where it was liked from
          likedFrom: window.location.pathname || 'Hertz25App.html'
        };

        likedTracks[track.id] = savedTrack;

        localStorage.setItem('hertzLikedTracks', JSON.stringify(likedTracks));
        localStorage.setItem('hertzLikedTracks_backup', JSON.stringify(likedTracks));

        console.log(' Saved liked track with full data:', savedTrack);
        console.log(' Total liked tracks:', Object.keys(likedTracks).length);

        // Trigger update event for other tabs
        localStorage.setItem('hertzLikedTracksUpdate', Date.now().toString());

        // Show notification
        showLikeNotification(savedTrack.name, 'liked');
      } catch (error) {
        console.error(' Error saving liked track:', error);
      }
    }

    function removeLikedTrackWithFullData(trackId) {
      try {
        let likedTracks = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
        const trackName = likedTracks[trackId]?.name || likedTracks[trackId]?.title;

        console.log(' Removing liked track:', trackId, trackName);
        console.log(' Before removal, total tracks:', Object.keys(likedTracks).length);

        if (likedTracks[trackId]) {
          delete likedTracks[trackId];
          localStorage.setItem('hertzLikedTracks', JSON.stringify(likedTracks));
          localStorage.setItem('hertzLikedTracks_backup', JSON.stringify(likedTracks));

          console.log(' Removed liked track:', trackId);
          console.log(' After removal, total tracks:', Object.keys(likedTracks).length);

          // Trigger update event for other tabs
          localStorage.setItem('hertzLikedTracksUpdate', Date.now().toString());

          // Show notification
          showLikeNotification(trackName, 'unliked');
        } else {
          console.log(' Track not found in liked tracks:', trackId);
        }
      } catch (error) {
        console.error(' Error removing liked track:', error);
      }
    }

    // Function to remove track from liked songs popup and update UI
    function removeLikedTrack(trackId) {
      try {
        console.log(' Removing track from liked songs popup:', trackId);

        // Remove from localStorage using existing function
        removeLikedTrackWithFullData(trackId);

        // Update the like buttons in the main interface if visible
        const likeButtons = document.querySelectorAll('.track-like-btn');
        likeButtons.forEach(button => {
          const trackRow = button.closest('.track-row');
          const recentTrackItem = button.closest('.recent-track-item');

          let buttonTrackId = null;

          if (trackRow) {
            const onclickAttr = trackRow.getAttribute('onclick');
            buttonTrackId = onclickAttr ? onclickAttr.match(/playTrack\('([^']+)'\)/)?.[1] : null;
          } else if (recentTrackItem) {
            const onclickAttr = recentTrackItem.getAttribute('onclick');
            buttonTrackId = onclickAttr ? onclickAttr.match(/playTrack\('([^']+)'\)/)?.[1] : null;
          }

          if (buttonTrackId === trackId) {
            button.classList.remove('liked');
            button.innerHTML = '';
            button.style.color = '#a7a7a7';
          }
        });

        // Refresh the liked songs popup display
        loadLikedSongs();

        console.log(' Successfully removed track and updated UI');
      } catch (error) {
        console.error(' Error in removeLikedTrack:', error);
      }
    }

    function isTrackLiked(track) {
      if (!track) return false;
      const likedTracks = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
      return !!likedTracks[track.id];
    }

    function updateLikeBtn(track) {
      const likeBtn = document.getElementById('likeBtn');
      if (!likeBtn) return;
      if (isTrackLiked(track)) {
        likeBtn.style.color = "#ff4081";
        likeBtn.style.boxShadow = "0 0 15px rgba(255, 64, 129, 0.6), 0 0 30px rgba(255, 64, 129, 0.3)";
        likeBtn.style.filter = "drop-shadow(0 0 8px rgba(255, 64, 129, 0.8))";
        likeBtn.title = "Unlike - Remove from Liked";
        likeBtn.innerHTML = "&#10084;"; // Filled heart
      } else {
        likeBtn.style.color = "#b3b3b3";
        likeBtn.style.boxShadow = "none";
        likeBtn.style.filter = "none";
        likeBtn.title = "Like - Add to Liked";
        likeBtn.innerHTML = "&#9825;"; // Empty heart
      }
    }

    function toggleCurrentTrackLike() {
      if (!currentTrackId) {
        console.log(' No current track to like/unlike');
        return;
      }

      console.log(' Toggling like for current track:', currentTrackId);

      // Get the like button element
      const likeBtn = document.getElementById('likeBtn');
      if (!likeBtn) {
        console.log(' Like button not found');
        return;
      }

      // Get track data from the trackData object in the playTrack function
      const trackData = {
        'Times': { id: 'Times', title: 'Times', name: 'Times', artist: 'Stat Cross' },
        'Prime': { id: 'Prime', title: 'Prime', name: 'Prime', artist: 'SlattZ' },
        'Aint Nough Dreamzz': { id: 'Aint Nough Dreamzz', title: 'Aint Nough Dreamzz', name: 'Aint Nough Dreamzz', artist: 'Stage Rolla' },
        'Made It': { id: 'Made It', title: 'Made It', name: 'Made It', artist: 'Prod. Tedla' },
        'Nector': { id: 'Nector', title: 'Nector', name: 'Nector', artist: 'Prod. Tedla' },
        'Blossom': { id: 'Blossom', title: 'Blossom', name: 'Blossom', artist: 'Prod. Nexus' },
        'Mach 1': { id: 'Mach 1', title: 'Mach 1', name: 'Mach 1', artist: 'Prod. Phantom' },
        'Echo': { id: 'Echo', title: 'Echo', name: 'Echo', artist: 'Neon Gloww' },
        'Lights': { id: 'Lights', title: 'Lights', name: 'Lights', artist: 'Bezzie' },
        'Smilin': { id: 'Smilin', title: 'Smilin', name: 'Smilin', artist: 'Melody-Soull' },
        'Buckets': { id: 'Buckets', title: 'Buckets', name: 'Buckets', artist: 'Bezzie' },
        'Sweet': { id: 'Sweet', title: 'Sweet', name: 'Sweet', artist: 'Bezzie' },
        'Persistence': { id: 'Persistence', title: 'Persistence', name: 'Persistence', artist: 'Neo' },
        'Focus': { id: 'Focus', title: 'Focus', name: 'Focus', artist: 'Desiree' }
      };

      const currentTrack = trackData[currentTrackId];
      if (!currentTrack) {
        console.log(' Track data not found for:', currentTrackId);
        return;
      }

      // Check if track is currently liked
      const likedTracks = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
      const isLiked = !!likedTracks[currentTrackId];

      if (isLiked) {
        // Unlike: remove from liked tracks
        console.log(' Unliking track:', currentTrackId);
        removeLikedTrackWithFullData(currentTrackId);

        // Update button state
        likeBtn.style.color = 'rgba(255,255,255,0.4)';
        likeBtn.classList.remove('liked');
        likeBtn.innerHTML = '&#10084;'; // Empty heart

        // Show notification
        showLikeNotification(currentTrack.title, 'unliked');
      } else {
        // Like: add to liked tracks
        console.log(' Liking track:', currentTrackId);
        saveLikedTrackWithFullData(currentTrack);

        // Update button state
        likeBtn.style.color = '#ffd700';
        likeBtn.classList.add('liked');
        likeBtn.innerHTML = '&#10084;'; // Filled heart

        // Show notification
        showLikeNotification(currentTrack.title, 'liked');
      }

      // Refresh the liked songs popup if it's currently open
      const likedPopup = document.getElementById('likedPageOverlay');
      if (likedPopup && likedPopup.classList.contains('show')) {
        console.log(' Refreshing liked songs popup from sticky player');
        loadLikedSongs();
      }
    }

    // Show like/unlike notification
    function showLikeNotification(trackName, action) {
      // Remove any existing notification
      const existingNotification = document.getElementById('likeNotification');
      if (existingNotification) {
        existingNotification.remove();
      }

      // Create notification element
      const notification = document.createElement('div');
      notification.id = 'likeNotification';
      notification.style.cssText = `
        position: fixed;
        top: 80px;
        right: 20px;
        background: ${action === 'liked' ? '#1db954' : '#ff4444'};
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        z-index: 10000;
        font-weight: 600;
        font-size: 0.95rem;
        transform: translateX(100%);
        transition: transform 0.3s ease;
        max-width: 300px;
        word-wrap: break-word;
      `;

      const icon = action === 'liked' ? '' : '';
      const verb = action === 'liked' ? 'Added to' : 'Removed from';
      notification.innerHTML = `${icon} ${verb} Liked: ${trackName}`;

      document.body.appendChild(notification);

      // Animate in
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 100);

      // Animate out and remove
      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.parentNode.removeChild(notification);
          }
        }, 300);
      }, 3000);
    }

    // Update liked songs count in profile stats
    function updateLikedSongsCount() {
      try {
        const likedTracksObj = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
        const likedSongsCount = Object.keys(likedTracksObj).length;

        const likedSongsElement = document.getElementById('likedSongsCount');
        if (likedSongsElement) {
          likedSongsElement.textContent = likedSongsCount;
        }

        console.log(` Updated liked songs count: ${likedSongsCount}`);
      } catch (error) {
        console.error(' Error updating liked songs count:', error);
      }
    }

    // Initialize like buttons with correct state on page load
    function initializeLikeButtons() {
      try {
        const likedTracksObj = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
        console.log(' Initializing like buttons with liked tracks:', Object.keys(likedTracksObj));

        // Get all like buttons in both sections
        const likeButtons = document.querySelectorAll('.track-like-btn');

        likeButtons.forEach(button => {
          // Get track info from the parent element
          const trackRow = button.closest('.track-row');
          const recentTrackItem = button.closest('.recent-track-item');

          let trackId = null;
          let trackName = null;

          if (trackRow) {
            // Popular tracks section
            const onclickAttr = trackRow.getAttribute('onclick');
            trackId = onclickAttr ? onclickAttr.match(/playTrack\('([^']+)'\)/)?.[1] : null;
            trackName = trackRow.querySelector('.track-name')?.textContent || 'Unknown Track';
          } else if (recentTrackItem) {
            // Recently played section
            const onclickAttr = recentTrackItem.getAttribute('onclick');
            trackId = onclickAttr ? onclickAttr.match(/playTrack\('([^']+)'\)/)?.[1] : null;
            trackName = recentTrackItem.querySelector('.recent-track-name')?.textContent || 'Unknown Track';
          }

          // Generate fallback ID if none found (same logic as toggleLike)
          if (!trackId && trackName) {
            trackId = trackName.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
          }

          // Set button state based on whether track is liked
          if (trackId && likedTracksObj[trackId]) {
            button.classList.add('liked');
            button.innerHTML = '';
            button.style.color = '#ffd700';
            console.log(' Set liked state for:', trackId, trackName);
          } else {
            button.classList.remove('liked');
            button.innerHTML = '';
            button.style.color = '#a7a7a7';
          }
        });

        console.log(` Initialized ${likeButtons.length} like buttons`);
      } catch (error) {
        console.error(' Error initializing like buttons:', error);
      }
    }

    // Add like button event listener
    const likeBtn = document.getElementById('likeBtn');
    if (likeBtn) {
      likeBtn.addEventListener('click', toggleCurrentTrackLike);
    }

    // Update like button when track changes
    function updateLikeBtnForCurrent() {
      const track = allTracks[currentIndex];
      updateLikeBtn(track);
    }

    // Patch loadTrack to update like button
    const enhancedLoadTrack = loadTrack;
    loadTrack = function(idx, autoplay = true) {
      enhancedLoadTrack(idx, autoplay);
      updateLikeBtnForCurrent();
    };

    // Listen for liked list updates from other tabs
    window.addEventListener('storage', function(e) {
      if (e.key === 'hertzLikedTracksUpdate') {
        updateLikeBtnForCurrent();
        // Update account stats if account page is open
        const accountOverlay = document.getElementById('accountPageOverlay');
        if (accountOverlay && accountOverlay.style.display === 'block') {
          loadAccountInfo();
        }
      }

      // Update account stats for any storage changes that affect user data
      if (e.key && (e.key.startsWith('hertz') || e.key === 'hertzUsername' || e.key === 'hertzUserEmail')) {
        const accountOverlay = document.getElementById('accountPageOverlay');
        if (accountOverlay && accountOverlay.style.display === 'block') {
          setTimeout(() => loadAccountInfo(), 100); // Small delay to ensure storage is updated
        }
      }
    });

    // Add functions to track playlists and followed artists
    function addToPlaylist(playlistName, trackData) {
      const playlists = JSON.parse(localStorage.getItem('hertzPlaylists') || '[]');
      let playlist = playlists.find(p => p.name === playlistName);

      if (!playlist) {
        playlist = {
          id: Date.now().toString(),
          name: playlistName,
          tracks: [],
          created: new Date().toISOString(),
          description: `My ${playlistName} playlist`
        };
        playlists.push(playlist);
      }

      if (!playlist.tracks.find(t => t.id === trackData.id)) {
        playlist.tracks.push(trackData);
        localStorage.setItem('hertzPlaylists', JSON.stringify(playlists));
        localStorage.setItem('hertzPlaylistsUpdate', Date.now().toString());
        console.log(`Added track to playlist: ${playlistName}`);
      }
    }

    function followArtist(artistName) {
      const followedArtists = JSON.parse(localStorage.getItem('hertzFollowedArtists') || '[]');

      if (!followedArtists.find(a => a.name === artistName)) {
        const artist = {
          id: Date.now().toString(),
          name: artistName,
          followed: new Date().toISOString(),
          genre: 'Unknown'
        };
        followedArtists.push(artist);
        localStorage.setItem('hertzFollowedArtists', JSON.stringify(followedArtists));
        localStorage.setItem('hertzFollowedArtistsUpdate', Date.now().toString());
        console.log(`Now following artist: ${artistName}`);
      }
    }

    function unfollowArtist(artistName) {
      const followedArtists = JSON.parse(localStorage.getItem('hertzFollowedArtists') || '[]');
      const filteredArtists = followedArtists.filter(a => a.name !== artistName);

      if (filteredArtists.length !== followedArtists.length) {
        localStorage.setItem('hertzFollowedArtists', JSON.stringify(filteredArtists));
        localStorage.setItem('hertzFollowedArtistsUpdate', Date.now().toString());
        console.log(`Unfollowed artist: ${artistName}`);
      }
    }

    // Track listening time more accurately
    function trackListeningTime(duration) {
      const currentTime = parseInt(localStorage.getItem('hertzTotalListeningTime') || '0');
      const newTime = currentTime + Math.floor(duration);
      localStorage.setItem('hertzTotalListeningTime', newTime.toString());
      localStorage.setItem('hertzListeningTimeUpdate', Date.now().toString());
    }

    // Enhanced like tracking with automatic artist following
    function enhancedLikeTrack(trackData) {
      // Add to liked tracks
      let likedTracks = JSON.parse(localStorage.getItem('hertzLikedTracks') || '{}');
      if (trackData && trackData.id) {
        likedTracks[trackData.id] = {
          ...trackData,
          likedAt: new Date().toISOString()
        };
        localStorage.setItem('hertzLikedTracks', JSON.stringify(likedTracks));

        // Auto-follow artist if we like 3+ of their songs
        if (trackData.artist) {
          const artistTracks = Object.values(likedTracks).filter(t => t.artist === trackData.artist);
          if (artistTracks.length >= 3) {
            followArtist(trackData.artist);
          }
        }

        // Auto-create "Favorites" playlist and add to it
        addToPlaylist('Favorites', trackData);
      }
    }

    // --- Persistent Player State Sync (Spotify-style) ---
    (function() {
      function savePlayerState() {
        const audio = document.getElementById('playerAudio');
      // Ensure Utopia tracks play and show sticky player
  window.playTrack = playTrack;
        const state = {
          track: window.currentTrack || null,
          currentTime: audio ? audio.currentTime : 0,
          paused: audio ? audio.paused : true
        };
        localStorage.setItem('playerState', JSON.stringify(state));
      }

      function loadPlayerState() {
        const state = JSON.parse(localStorage.getItem('playerState') || '{}');
        if (state && state.track) {
          window.currentTrack = state.track;
          if (typeof playOfflineTrack === 'function') {
            playOfflineTrack(
              (window.offlineTracks || []).findIndex(t => t.id === state.track.id),
              true
            );
          }
          const audio = document.getElementById('playerAudio');
          if (audio && typeof state.currentTime === 'number') {
            audio.currentTime = state.currentTime;
            if (!state.paused) {
              audio.play();
            }
          }
        }
      }

      window.addEventListener('storage', function(e) {
        if (e.key === 'playerState') {
          loadPlayerState();
          if (typeof updateLikeButtons === 'function') updateLikeButtons();
        }
      });

      function setupPlayerStateSync() {
        const audio = document.getElementById('playerAudio');
        if (!audio) return;
        audio.addEventListener('play', savePlayerState);
        audio.addEventListener('pause', savePlayerState);
        audio.addEventListener('seeked', savePlayerState);
        audio.addEventListener('timeupdate', function() {
          if (!audio.paused) savePlayerState();
        });
      }

      document.addEventListener('DOMContentLoaded', function() {
        loadPlayerState();
        setupPlayerStateSync();
      });
    })();

    function playAllTracks() {
      console.log('Playing all tracks');
      playTrack('Times');
    }

    function toggleLike(button, event) {
      event.stopPropagation();

      // Get track info from the clicked row or recent track item
      const trackRow = event.target.closest('.track-row');
      const recentTrackItem = event.target.closest('.recent-track-item');

      let trackName, trackArtist, trackId, trackInfo;

      if (trackRow) {
        // Popular tracks section
        trackName = trackRow.querySelector('.track-name')?.textContent || 'Unknown Track';
        trackArtist = trackRow.querySelector('.track-artist')?.textContent || 'Unknown Artist';
        // Get track ID from onclick attribute
        const onclickAttr = trackRow.getAttribute('onclick');
        trackId = onclickAttr ? onclickAttr.match(/playTrack\('([^']+)'\)/)?.[1] : null;
      } else if (recentTrackItem) {
        // Recently played section
        trackName = recentTrackItem.querySelector('.recent-track-name')?.textContent || 'Unknown Track';
        trackArtist = recentTrackItem.querySelector('.recent-track-artist')?.textContent || 'Unknown Artist';
        // Get track ID from onclick attribute
        const onclickAttr = recentTrackItem.getAttribute('onclick');
        trackId = onclickAttr ? onclickAttr.match(/playTrack\('([^']+)'\)/)?.[1] : null;
      } else {
        // Fallback
        trackName = 'Unknown Track';
        trackArtist = 'Unknown Artist';
        trackId = null;
      }

      // Generate fallback ID if none found
      if (!trackId) {
        trackId = trackName.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
      }

      console.log(' Toggle like for:', { trackId, trackName, trackArtist });

      // Create track info object
      trackInfo = {
        id: trackId,
        title: trackName,
        name: trackName,
        artist: trackArtist
      };

      if (button.classList.contains('liked')) {
        // Unlike the track
        button.classList.remove('liked');
        button.innerHTML = '';
        button.style.color = '#a7a7a7';

        // Remove from localStorage and Liked25App.html
        removeLikedTrackWithFullData(trackId);

        // Show notification
        showLikeNotification(trackName, 'unliked');
      } else {
        // Like the track
        button.classList.add('liked');
        button.innerHTML = '';
        button.style.color = '#ffd700';

        // Save to localStorage and sync to Liked25App.html
        saveLikedTrackWithFullData(trackInfo);

        // Show notification
        showLikeNotification(trackName, 'liked');
      }

      // Update liked songs count in the profile stats
      updateLikedSongsCount();

      // Refresh the liked songs popup if it's currently open
      const likedPopup = document.getElementById('likedPageOverlay');
      if (likedPopup && likedPopup.classList.contains('show')) {
        console.log(' Refreshing liked songs popup');
        loadLikedSongs();
      }
    }

    function showTrackMenu(event) {
      event.stopPropagation();

      let trackName = arguments.length > 1 ? arguments[1] : undefined;
      let trackArtist = 'Unknown Artist';

      if (!trackName) {
        // Get track info from the clicked row or recent track item
        const trackRow = event.target.closest('.track-row');
        const recentTrackItem = event.target.closest('.recent-track-item');
        if (trackRow) {
          trackName = trackRow.querySelector('.track-name')?.textContent || 'Unknown Track';
          trackArtist = trackRow.querySelector('.track-artist')?.textContent || 'Unknown Artist';
        } else if (recentTrackItem) {
          trackName = recentTrackItem.querySelector('.recent-track-name')?.textContent || 'Unknown Track';
          trackArtist = recentTrackItem.querySelector('.recent-track-artist')?.textContent || 'Unknown Artist';
        } else {
          trackName = 'Unknown Track';
        }
      }

      // Create context menu
      const menu = document.createElement('div');
      menu.className = 'track-context-menu';
      menu.style.position = 'fixed';
      // Position menu more to the left for better mobile display
      const leftOffset = Math.max(10, event.clientX - 160); // Ensure at least 10px from screen edge
      menu.style.left = leftOffset + 'px';
      menu.style.top = event.clientY + 'px';
      menu.style.background = '#282828';
      menu.style.border = '1px solid #3e3e3e';
      menu.style.borderRadius = '4px';
      menu.style.padding = '8px 0';
      menu.style.zIndex = '10000';
      menu.style.minWidth = '200px';
      menu.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.5)';

      const menuItems = [
        { text: 'Add to queue', icon: '', action: () => addToQueue(trackName, trackArtist) },
        { text: 'Go to song radio', icon: '', action: () => goToSongRadio(trackName, trackArtist) },
        { text: 'Add to playlist', icon: '', action: () => addToPlaylist(trackName, trackArtist) },
        { text: 'Share', icon: '', action: (menuItem) => showSocialShare(menuItem, trackName, trackArtist) },
        { text: 'Copy song link', icon: '', action: () => copySongLink(trackName, trackArtist) }
      ];

      menuItems.forEach(item => {
        const menuItem = document.createElement('div');
        menuItem.innerHTML = `<span style="margin-right: 8px;">${item.icon}</span>${item.text}`;
        menuItem.style.padding = '8px 16px';
        menuItem.style.color = '#ffffff';
        menuItem.style.fontSize = '0.875rem';
        menuItem.style.cursor = 'pointer';
        menuItem.style.transition = 'background 0.1s ease';
        menuItem.style.position = 'relative';
        menuItem.style.display = 'flex';
        menuItem.style.alignItems = 'center';

        menuItem.addEventListener('mouseenter', () => {
          menuItem.style.background = '#3e3e3e';
        });

        menuItem.addEventListener('mouseleave', () => {
          menuItem.style.background = 'transparent';
        });

        menuItem.addEventListener('click', (e) => {
          e.stopPropagation();
          if (item.text === 'Share') {
            item.action(menuItem);
          } else {
            item.action();
            document.body.removeChild(menu);
          }
        });

        menu.appendChild(menuItem);
      });

      document.body.appendChild(menu);

      // Remove menu when clicking elsewhere
      const removeMenu = (e) => {
        if (!menu.contains(e.target) && !e.target.closest('.social-share-dropdown')) {
          if (document.body.contains(menu)) {
            document.body.removeChild(menu);
          }
          document.removeEventListener('click', removeMenu);
        }
      };

      setTimeout(() => {
        document.addEventListener('click', removeMenu);
      }, 10);
    }

    // Track Menu Action Functions
    function addToQueue(trackName, trackArtist) {
      console.log(`Adding "${trackName}" by ${trackArtist} to queue...`);
      // Add visual feedback
      showNotification(`Added "${trackName}" to queue!`, 'success');
    }

    function goToSongRadio(trackName, trackArtist) {
      console.log(`Starting radio based on "${trackName}" by ${trackArtist}...`);
      showNotification(`Starting radio based on "${trackName}"!`, 'info');
    }

    function addToPlaylist(trackName, trackArtist) {
      console.log(`Adding "${trackName}" by ${trackArtist} to playlist...`);
      showNotification(`Added "${trackName}" to playlist!`, 'success');
    }

    function copySongLink(trackName, trackArtist) {
      const trackUrl = `${window.location.origin}/?track=${encodeURIComponent(trackName)}&artist=${encodeURIComponent(trackArtist)}`;

      if (navigator.clipboard) {
        navigator.clipboard.writeText(trackUrl).then(() => {
          showNotification('Song link copied to clipboard!', 'success');
        }).catch(() => {
          fallbackCopyToClipboard(trackUrl);
        });
      } else {
        fallbackCopyToClipboard(trackUrl);
      }
    }

    function fallbackCopyToClipboard(text) {
      const textArea = document.createElement('textarea');
      textArea.value = text;
      textArea.style.position = 'fixed';
      textArea.style.opacity = '0';
      document.body.appendChild(textArea);
      textArea.select();
      try {
        document.execCommand('copy');
        showNotification('Song link copied to clipboard!', 'success');
      } catch (err) {
        showNotification('Failed to copy link', 'error');
      }
      document.body.removeChild(textArea);
    }

    function showSocialShare(menuItem, trackName, trackArtist) {
      console.log('showSocialShare called with:', trackName, trackArtist);

      // Remove any existing social share dropdown
      const existingDropdown = document.querySelector('.social-share-dropdown');
      if (existingDropdown) {
        existingDropdown.remove();
      }

      // Create social share dropdown
      const dropdown = document.createElement('div');
      dropdown.className = 'social-share-dropdown show';

      dropdown.innerHTML = `
        <div class="social-share-title">Share "${trackName}"</div>
        <div class="social-share-icons">
          <div class="social-icon facebook" data-platform="facebook" title="Share on Facebook">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
            </svg>
          </div>
          <div class="social-icon instagram" data-platform="instagram" title="Share on Instagram">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
            </svg>
          </div>
          <div class="social-icon twitter" data-platform="twitter" title="Share on X (Twitter)">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
            </svg>
          </div>
          <div class="social-icon whatsapp" data-platform="whatsapp" title="Share on WhatsApp">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.893 3.488"/>
            </svg>
          </div>
        </div>
      `;

      // Position dropdown above the share button with mobile-friendly offset
      const rect = menuItem.getBoundingClientRect();
      dropdown.style.position = 'fixed';
      // Position significantly more to the left to ensure all icons are visible
      const leftOffset = Math.max(10, rect.left - 140); // Ensure at least 10px from screen edge
      dropdown.style.left = leftOffset + 'px';
      dropdown.style.top = (rect.top - 120) + 'px';

      // Add click handlers for social icons
      dropdown.querySelectorAll('.social-icon').forEach(icon => {
        icon.addEventListener('click', (e) => {
          e.stopPropagation();
          const platform = icon.getAttribute('data-platform');
          shareToSocialMedia(platform, trackName, trackArtist);
          dropdown.remove();
          // Close the main menu
          const mainMenu = document.querySelector('.track-context-menu');
          if (mainMenu) mainMenu.remove();
        });
      });

      document.body.appendChild(dropdown);
      console.log('Social share dropdown added to DOM:', dropdown);
      console.log('Dropdown position:', dropdown.style.left, dropdown.style.top);
      console.log('Dropdown classes:', dropdown.className);

      // Remove dropdown when clicking elsewhere
      const removeDropdown = (e) => {
        if (!dropdown.contains(e.target)) {
          dropdown.remove();
          document.removeEventListener('click', removeDropdown);
        }
      };

      setTimeout(() => {
        document.addEventListener('click', removeDropdown);
      }, 10);
    }

    function shareToSocialMedia(platform, trackName, trackArtist) {
      const trackUrl = `${window.location.origin}/?track=${encodeURIComponent(trackName)}&artist=${encodeURIComponent(trackArtist)}`;
      const shareText = `Check out "${trackName}" by ${trackArtist} on Hertz25! `;

      let shareUrl = '';

      switch (platform) {
        case 'facebook':
          shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(trackUrl)}&quote=${encodeURIComponent(shareText)}`;
          break;
        case 'instagram':
          // Instagram doesn't support direct URL sharing, so copy to clipboard
          navigator.clipboard?.writeText(`${shareText} ${trackUrl}`);
          showNotification('Text copied! Paste it in your Instagram post or story.', 'info');
          return;
        case 'twitter':
          shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(trackUrl)}`;
          break;
        case 'whatsapp':
          shareUrl = `https://wa.me/?text=${encodeURIComponent(`${shareText} ${trackUrl}`)}`;
          break;
      }

      if (shareUrl) {
        window.open(shareUrl, '_blank', 'width=600,height=400');
        showNotification(`Sharing "${trackName}" on ${platform}!`, 'success');
      }
    }

    function showNotification(message, type = 'info') {
      // Remove any existing notification
      const existing = document.querySelector('.track-notification');
      if (existing) existing.remove();

      const notification = document.createElement('div');
      notification.className = 'track-notification';
      notification.textContent = message;

      const colors = {
        success: '#1DB954',
        error: '#E22134',
        info: '#1ED760'
      };

      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${colors[type] || colors.info};
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        z-index: 10002;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        transform: translateX(100%);
        transition: transform 0.3s ease;
      `;

      document.body.appendChild(notification);

      // Animate in
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 10);

      // Auto remove
      setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
          if (notification.parentNode) {
            notification.remove();
          }
        }, 300);
      }, 3000);
    }

    // Update greeting based on time
    function updateGreeting() {
      const hour = new Date().getHours();
      const greetingElement = document.getElementById('greetingText');

      if (greetingElement) {
        if (hour >= 6 && hour < 18) {
          // Day time (6 AM to 6 PM): Show "Shine & Prosper"
          greetingElement.textContent = 'Shine & Prosper';
        } else {
          // Night time (6 PM to 6 AM): Show "Good evening"
          greetingElement.textContent = 'Good evening';
        }
      }
    }

    // Initialize greeting
    updateGreeting();

  </script>

  </div> <!-- End App Container -->

  <script>
    console.log(' TERMS ENFORCEMENT ACTIVE - Modal shown by default, will be hidden only if user has account or accepted terms');
    console.log(' ACCOUNT LOGIC: "Music Lover" = NO account, any other username = HAS account');

    // Immediate Terms Check - Run as soon as script loads
    (function() {
      console.log(' IMMEDIATE TERMS CHECK');

      // Check for account data - "Music Lover" is not a real account
      const userData = localStorage.getItem('hertzUser');
      const username = localStorage.getItem('hertzUsername');
      const termsAccepted = localStorage.getItem('hertzTermsAccepted');
      const hasAccount = !!(userData || (username && username !== 'Music Lover'));

      console.log(' Immediate Check:', {
        userData: !!userData,
        username: username,
        hasAccount: hasAccount,
        termsAccepted: termsAccepted,
        isMusicLover: username === 'Music Lover'
      });

      // If user has account OR has accepted terms, hide modal and unblock app
      if (hasAccount || termsAccepted) {
        console.log(' USER CLEARED - Hiding terms modal and unblocking app');
        setTimeout(() => {
          const modal = document.getElementById('termsOverlay');
          const appContainer = document.getElementById('appContainer');

          if (modal) {
            modal.style.display = 'none';
            console.log(' MODAL HIDDEN');
          }

          if (appContainer) {
            appContainer.classList.remove('app-blocked');
            appContainer.style.filter = '';
            appContainer.style.opacity = '';
            appContainer.style.pointerEvents = '';
            console.log(' APP UNBLOCKED');
          }
        }, 10);
      } else {
        console.log(' NO ACCOUNT AND NO TERMS ACCEPTED - Modal remains visible');
      }
    })();    // Terms and Conditions Management
    class TermsManager {
      constructor() {
        this.termsAccepted = localStorage.getItem('hertzTermsAccepted');
        this.hasAccount = this.checkUserAccount();
        console.log(' TermsManager Debug:', {
          termsAccepted: this.termsAccepted,
          hasAccount: this.hasAccount,
          hertzUser: localStorage.getItem('hertzUser'),
          hertzUsername: localStorage.getItem('hertzUsername')
        });
        this.init();
      }

      checkUserAccount() {
        // Check if user has an account - "Music Lover" is not a real account
        const userData = localStorage.getItem('hertzUser');
        const username = localStorage.getItem('hertzUsername');
        const hasAccount = !!(userData || (username && username !== 'Music Lover'));
        console.log(' Account Check:', {
          userData: !!userData,
          username: username,
          isRealAccount: hasAccount,
          isMusicLover: username === 'Music Lover'
        });
        return hasAccount;
      }

      init() {
        console.log(' TermsManager.init() called');

        // Always setup event listeners first
        this.setupEventListeners();

        // Check current status
        const hasAccount = this.checkUserAccount();
        const termsAccepted = localStorage.getItem('hertzTermsAccepted');

        console.log(' Init Check:', {
          hasAccount: hasAccount,
          termsAccepted: !!termsAccepted
        });

        // If user has account OR has accepted terms, hide modal and unblock app
        if (hasAccount || termsAccepted) {
          console.log(' USER CLEARED - Hiding modal and unblocking app');
          setTimeout(() => {
            this.hideTermsModal();
            this.unblockApp();
          }, 50);
        } else {
          console.log(' NO ACCOUNT AND NO TERMS - Modal remains visible');
          // Ensure app stays blocked (it should already be blocked by default)
          this.blockApp();
        }
      }

      showTermsModal() {
        const modal = document.getElementById('termsOverlay');
        if (modal) {
          modal.style.display = 'flex';
          console.log(' Terms modal displayed');
        } else {
          console.error(' Terms modal element not found!');
        }
      }

      hideTermsModal() {
        const modal = document.getElementById('termsOverlay');
        if (modal) {
          modal.style.display = 'none';
          console.log(' Terms modal hidden');
        }
      }

      blockApp() {
        const appContainer = document.getElementById('appContainer');
        if (appContainer) {
          appContainer.classList.add('app-blocked');
          console.log(' App blocked');
        } else {
          console.error(' App container element not found!');
        }
      }

      unblockApp() {
        const appContainer = document.getElementById('appContainer');
        if (appContainer) {
          appContainer.classList.remove('app-blocked');
          console.log(' App unblocked');
        }
      }

      setupEventListeners() {
        const checkbox = document.getElementById('termsCheckbox');
        const acceptBtn = document.getElementById('termsAcceptBtn');
        const declineBtn = document.getElementById('termsDeclineBtn');

        // Enable/disable accept button based on checkbox
        checkbox.addEventListener('change', () => {
          acceptBtn.disabled = !checkbox.checked;
        });

        // Accept button click
        acceptBtn.addEventListener('click', () => {
          if (checkbox.checked) {
            this.acceptTerms();
          }
        });

        // Decline button click
        declineBtn.addEventListener('click', () => {
          this.declineTerms();
        });

        // Allow clicking on label to toggle checkbox
        document.getElementById('termsCheckbox').addEventListener('change', () => {
          acceptBtn.disabled = !document.getElementById('termsCheckbox').checked;
        });
      }

      acceptTerms() {
        console.log(' Terms accepted by user');
        localStorage.setItem('hertzTermsAccepted', 'true');
        localStorage.setItem('hertzTermsAcceptedDate', new Date().toISOString());

        this.hideTermsModal();
        this.unblockApp();

        // Show success notification
        this.showNotification('Terms accepted! Welcome to HZ Music Streamer!', 'success');
      }

      declineTerms() {
        console.log(' Terms declined by user');
        this.showNotification('Terms declined. You cannot use HZ Music Streamer without accepting the terms.', 'error');

        // Redirect away from the app or show alternative message
        setTimeout(() => {
          if (confirm('You must accept the Terms and Conditions to use HZ Music Streamer. Would you like to review them again?')) {
            // Keep modal open for another attempt
          } else {
            window.location.href = 'https://hz-streams.com';
          }
        }, 2000);
      }

      showNotification(message, type) {
        // Create notification element
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          background: ${type === 'success' ? 'linear-gradient(135deg, #1db954 0%, #17a74a 100%)' : 'linear-gradient(135deg, #ff4444 0%, #cc0000 100%)'};
          color: white;
          padding: 15px 25px;
          border-radius: 8px;
          box-shadow: 0 4px 20px rgba(0,0,0,0.3);
          z-index: 11000;
          font-weight: 600;
          font-size: 0.95rem;
          max-width: 350px;
          word-wrap: break-word;
          transform: translateX(100%);
          transition: transform 0.3s ease;
        `;

        notification.innerHTML = message;
        document.body.appendChild(notification);

        // Animate in
        setTimeout(() => {
          notification.style.transform = 'translateX(0)';
        }, 100);

        // Animate out and remove
        setTimeout(() => {
          notification.style.transform = 'translateX(100%)';
          setTimeout(() => {
            if (notification.parentNode) {
              notification.parentNode.removeChild(notification);
            }
          }, 300);
        }, type === 'success' ? 3000 : 5000);
      }

      // Method to reset terms (for testing or admin purposes)
      resetTerms() {
        localStorage.removeItem('hertzTermsAccepted');
        localStorage.removeItem('hertzTermsAcceptedDate');
        console.log(' Terms reset - user will see modal on next visit');
      }
    }

    // Initialize Terms Manager when page loads
    document.addEventListener('DOMContentLoaded', () => {
      console.log(' DOM Content Loaded - Initializing TermsManager');
      window.termsManager = new TermsManager();
    });

    // Backup initialization in case DOMContentLoaded already fired
    if (document.readyState === 'loading') {
      // DOM is still loading, wait for DOMContentLoaded
    } else {
      // DOM is already loaded, initialize immediately
      console.log(' DOM Already Loaded - Initializing TermsManager');
      setTimeout(() => {
        if (!window.termsManager) {
          window.termsManager = new TermsManager();
        }
      }, 100);
    }

    // EMERGENCY FALLBACK - Ensure proper terms enforcement
    setTimeout(() => {
      console.log(' EMERGENCY FALLBACK CHECK');

      const userData = localStorage.getItem('hertzUser');
      const username = localStorage.getItem('hertzUsername');
      const termsAccepted = localStorage.getItem('hertzTermsAccepted');
      const hasAccount = !!(userData || (username && username !== 'Music Lover'));

      const modal = document.getElementById('termsOverlay');
      const appContainer = document.getElementById('appContainer');

      console.log(' Emergency Check:', {
        username: username,
        hasAccount: hasAccount,
        termsAccepted: !!termsAccepted,
        isMusicLover: username === 'Music Lover',
        modalVisible: modal ? modal.style.display !== 'none' : false
      });

      // If user has account OR accepted terms, hide modal and unblock app
      if (hasAccount || termsAccepted) {
        console.log(' EMERGENCY - User cleared, hiding modal');
        if (modal) {
          modal.style.display = 'none';
        }
        if (appContainer) {
          appContainer.classList.remove('app-blocked');
          appContainer.style.filter = '';
          appContainer.style.opacity = '';
          appContainer.style.pointerEvents = '';
        }
      } else {
        console.log(' EMERGENCY - No account and no terms, ensuring modal visible');
        if (modal) {
          modal.style.display = 'flex';
          modal.style.zIndex = '99999';
        }
        if (appContainer) {
          appContainer.classList.add('app-blocked');
        }
      }
    }, 2000);

    // For testing purposes - expose functions to console
    window.resetTerms = () => {
      if (window.termsManager) {
        window.termsManager.resetTerms();
        window.location.reload();
      }
    };

    // Force show terms for testing (regardless of account status)
    window.forceShowTerms = () => {
      localStorage.removeItem('hertzTermsAccepted');
      localStorage.removeItem('hertzUser');
      localStorage.removeItem('hertzUsername');
      if (window.termsManager) {
        window.termsManager.showTermsModal();
        window.termsManager.blockApp();
      } else {
        console.log('Reinitializing TermsManager...');
        window.termsManager = new TermsManager();
      }
    };
  </script>
</body>
</html>
<script>
// Mini Video Player Logic (from Offline25App.html, adapted)
const videoOverlay = document.getElementById('videoOverlay');
const miniVideoPlayer = document.getElementById('miniVideoPlayer');
const miniVideoElement = document.getElementById('miniVideoElement');
const miniPlayPauseBtn = document.getElementById('miniPlayPauseBtn');
const miniMuteBtn = document.getElementById('miniMuteBtn');
const miniFullscreenBtn = document.getElementById('miniFullscreenBtn');
const miniCloseBtn = document.getElementById('miniCloseBtn');

let isMiniPlaying = false;
let isMiniMuted = true;
let isMiniFullscreen = false;

function showMiniVideoPlayer(src) {
  miniVideoElement.src = src;
  miniVideoPlayer.style.display = 'block';
  videoOverlay.style.display = 'block';
  miniVideoElement.muted = true;
  miniVideoElement.volume = 0.1;
  miniVideoElement.play().then(() => {
    miniPlayPauseBtn.textContent = '';
    isMiniPlaying = true;
    isMiniMuted = false;
  }).catch(() => {
    miniPlayPauseBtn.textContent = '';
    isMiniMuted = true;
  });

miniFullscreenBtn.addEventListener('click', () => {
  if (!isMiniFullscreen) {
    if (miniVideoPlayer.requestFullscreen) miniVideoPlayer.requestFullscreen();
    isMiniFullscreen = true;
  } else {
    if (document.exitFullscreen) document.exitFullscreen();
    isMiniFullscreen = false;
  }
});

miniCloseBtn.addEventListener('click', () => {
  miniVideoPlayer.style.display = 'none';
  videoOverlay.style.display = 'none';
  miniVideoElement.pause();
  miniVideoElement.src = '';
  isMiniPlaying = false;
});

videoOverlay.addEventListener('click', () => {
  miniCloseBtn.click();
});

// Example usage: showMiniVideoPlayer('path/to/video.mp4');
// You can call showMiniVideoPlayer with the video URL to open the popup player.
</script>
</html>
